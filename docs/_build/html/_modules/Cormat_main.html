<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Cormat_main &mdash; CORMAT_py 0.0.13 documentation</title>
    
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.0.13',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="CORMAT_py 0.0.13 documentation" href="../index.html" />
    <link rel="up" title="Module code" href="index.html" />
   
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body role="document">  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for Cormat_main</h1><div class="highlight"><pre>
<span></span><span class="ch">#!/usr/bin/env python</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Class that runs CORMAT_py GUI</span>
<span class="sd">&quot;&quot;&quot;</span>


<span class="c1"># ----------------------------</span>
<span class="n">__author__</span> <span class="o">=</span> <span class="s2">&quot;Bruno Viola&quot;</span>
<span class="n">__Name__</span> <span class="o">=</span> <span class="s2">&quot;CORMAT_py&quot;</span>
<span class="n">__version__</span> <span class="o">=</span> <span class="s2">&quot;0.13&quot;</span>
<span class="n">__release__</span> <span class="o">=</span> <span class="s2">&quot;0&quot;</span>
<span class="n">__maintainer__</span> <span class="o">=</span> <span class="s2">&quot;Bruno Viola&quot;</span>
<span class="n">__email__</span> <span class="o">=</span> <span class="s2">&quot;bruno.viola@ukaea.uk&quot;</span>
<span class="n">__status__</span> <span class="o">=</span> <span class="s2">&quot;Testing&quot;</span>
<span class="c1"># __status__ = &quot;Production&quot;</span>


<span class="kn">import</span> <span class="nn">argparse</span>
<span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">from</span> <span class="nn">types</span> <span class="kn">import</span> <span class="n">SimpleNamespace</span>
<span class="kn">from</span> <span class="nn">logging.handlers</span> <span class="kn">import</span> <span class="n">RotatingFileHandler</span>
<span class="kn">from</span> <span class="nn">logging</span> <span class="kn">import</span> <span class="n">handlers</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">pathlib</span>
<span class="c1"># from pickle import dump,load</span>
<span class="kn">import</span> <span class="nn">pickle</span>
<span class="kn">import</span> <span class="nn">platform</span>
<span class="kn">import</span> <span class="nn">datetime</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
<span class="kn">import</span> <span class="nn">CORMAT_GUI</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">PyQt4</span> <span class="kn">import</span> <span class="n">QtCore</span><span class="p">,</span> <span class="n">QtGui</span>

<span class="kn">from</span> <span class="nn">PyQt4.QtCore</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">PyQt4.QtGui</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">areyousure_gui</span> <span class="kn">import</span> <span class="n">Ui_areyousure_window</span>
<span class="kn">from</span> <span class="nn">accept_suggestion</span> <span class="kn">import</span> <span class="n">Ui_suggestion_window</span>
<span class="kn">from</span> <span class="nn">consts</span> <span class="kn">import</span> <span class="n">Consts</span>
<span class="kn">from</span> <span class="nn">elms_data</span> <span class="kn">import</span> <span class="n">ElmsData</span>
<span class="kn">from</span> <span class="nn">find_disruption</span> <span class="kn">import</span> <span class="n">find_disruption</span>
<span class="kn">from</span> <span class="nn">hrts_data</span> <span class="kn">import</span> <span class="n">HRTSData</span>
<span class="kn">from</span> <span class="nn">kg1_ppf_data</span> <span class="kn">import</span> <span class="n">Kg1PPFData</span>
<span class="kn">from</span> <span class="nn">kg4_data</span> <span class="kn">import</span> <span class="n">Kg4Data</span>
<span class="kn">from</span> <span class="nn">library</span> <span class="kn">import</span> <span class="o">*</span> <span class="c1">#containing useful function</span>
<span class="kn">from</span> <span class="nn">lidar_data</span> <span class="kn">import</span> <span class="n">LIDARData</span>
<span class="kn">from</span> <span class="nn">mag_data</span> <span class="kn">import</span> <span class="n">MagData</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">gridspec</span>
<span class="kn">from</span> <span class="nn">matplotlib.backends.backend_qt4agg</span> <span class="kn">import</span> \
    <span class="n">NavigationToolbar2QT</span> <span class="k">as</span> <span class="n">NavigationToolbar</span>
<span class="kn">from</span> <span class="nn">matplotlib.ticker</span> <span class="kn">import</span> <span class="n">AutoMinorLocator</span>
<span class="kn">from</span> <span class="nn">nbi_data</span> <span class="kn">import</span> <span class="n">NBIData</span>
<span class="kn">from</span> <span class="nn">pellet_data</span> <span class="kn">import</span> <span class="n">PelletData</span>
<span class="kn">from</span> <span class="nn">ppf</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">ppf_write</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">signal_base</span> <span class="kn">import</span> <span class="n">SignalBase</span>
<span class="kn">from</span> <span class="nn">custom_formatters</span> <span class="kn">import</span> <span class="n">MyFormatter</span><span class="p">,</span><span class="n">QPlainTextEditLogger</span><span class="p">,</span><span class="n">HTMLFormatter</span>
<span class="kn">from</span> <span class="nn">support_classes</span> <span class="kn">import</span> <span class="n">LineEdit</span><span class="p">,</span><span class="n">Key</span><span class="p">,</span><span class="n">KeyBoard</span><span class="p">,</span><span class="n">MyLocator</span>
<span class="kn">import</span> <span class="nn">inspect</span>
<span class="kn">import</span> <span class="nn">fileinput</span>
<span class="kn">import</span> <span class="nn">cProfile</span><span class="o">,</span> <span class="nn">pstats</span><span class="o">,</span> <span class="nn">io</span>
<span class="kn">from</span> <span class="nn">pycallgraph</span> <span class="kn">import</span> <span class="n">PyCallGraph</span>
<span class="kn">from</span> <span class="nn">pycallgraph.output</span> <span class="kn">import</span> <span class="n">GraphvizOutput</span>


<span class="n">qm</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QMessageBox</span>
<span class="n">qm_permanent</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QMessageBox</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;savefig.directory&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">())</span>
<span class="n">myself</span> <span class="o">=</span> <span class="k">lambda</span><span class="p">:</span> <span class="n">inspect</span><span class="o">.</span><span class="n">stack</span><span class="p">()[</span><span class="mi">1</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span>
<span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="n">__name__</span><span class="p">)</span>
<span class="c1"># noinspection PyUnusedLocal</span>
<div class="viewcode-block" id="CORMAT_GUI"><a class="viewcode-back" href="../Cormat_main.html#Cormat_main.CORMAT_GUI">[docs]</a><span class="k">class</span> <span class="nc">CORMAT_GUI</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QMainWindow</span><span class="p">,</span> <span class="n">CORMAT_GUI</span><span class="o">.</span><span class="n">Ui_CORMAT_py</span><span class="p">,</span>
                 <span class="n">QPlainTextEditLogger</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">    Main control function for CORMATpy GUI.</span>



<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">_initialize_widget</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">widget</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        function that:</span>
<span class="sd">         - initialises every tab (widget)</span>
<span class="sd">         - add layout</span>
<span class="sd">         - add navigation toolbar and position it at the bottom of the tab</span>
<span class="sd">        :param widget: tab to initialise</span>
<span class="sd">        :return:</span>
<span class="sd">        &quot;&quot;&quot;</span>



        <span class="n">widget</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QVBoxLayout</span><span class="p">())</span>
        <span class="n">widget</span><span class="o">.</span><span class="n">layout</span><span class="p">()</span><span class="o">.</span><span class="n">setContentsMargins</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">710</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span>
                                           <span class="o">-</span><span class="mi">0</span><span class="p">)</span>  <span class="c1"># (left, top, right, bottom)</span>
        <span class="n">widget</span><span class="o">.</span><span class="n">layout</span><span class="p">()</span><span class="o">.</span><span class="n">setSpacing</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">toolbar</span> <span class="o">=</span> <span class="n">NavigationToolbar</span><span class="p">(</span><span class="n">widget</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="n">widget</span><span class="o">.</span><span class="n">layout</span><span class="p">()</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">toolbar</span><span class="p">)</span>
        <span class="c1"># widget.figure.clear()</span>
        <span class="c1"># widget.draw()</span>

    <span class="c1"># ----------------------------</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Setup the GUI, and connect the buttons to functions.</span>

<span class="sd">        Initialise widgets and canvas.</span>
<span class="sd">        Define defaults</span>
<span class="sd">        </span>
<span class="sd">        Moreover it checks if there is data in workspace and load it if pulse number is correct.</span>
<span class="sd">        </span>
<span class="sd">        </span>


<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>

            <span class="nb">super</span><span class="p">(</span><span class="n">CORMAT_GUI</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">setupUi</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">SimpleNamespace</span><span class="p">()</span> <span class="c1"># dictionary object that contains all data</span>

            <span class="c1"># -------------------------------</span>
            <span class="c1"># backup for kg1 data</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">kg1_original</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="c1"># -------------------------------</span>
            <span class="c1"># store normalised kg1?</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">kg1_norm</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="c1"># ----------------------</span>
            <span class="c1"># initialise data</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG4_data</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">MAG_data</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">PELLETS_data</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">ELM_data</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">HRTS_data</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">NBI_data</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">is_dis</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">dis_time</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">LIDAR_data</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">coord_ch1</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">coord_ch2</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">coord_ch3</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">coord_ch4</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">coord_ch5</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">coord_ch6</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">coord_ch7</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">coord_ch8</span> <span class="o">=</span> <span class="p">[]</span>




            <span class="c1">####</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">totalcorrections_den</span> <span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">([</span><span class="mi">7</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">totalcorrections_vib</span> <span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">([</span><span class="mi">7</span><span class="p">])</span>



            <span class="c1"># -------------------------------</span>
            <span class="c1">#old pulse contains information on the last pulse analysed</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">old_pulse</span> <span class="o">=</span> <span class="bp">None</span>
            <span class="c1">#pulse is the current pulse</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">pulse</span> <span class="o">=</span> <span class="bp">None</span>
            <span class="c1"># -------------------------------</span>
            <span class="c1"># initialisation of control variables</span>
            <span class="c1"># -------------------------------</span>
            <span class="c1"># set saved status to False</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">saved</span> <span class="o">=</span> <span class="bp">False</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">data_changed</span> <span class="o">=</span> <span class="bp">False</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">statusflag_changed</span> <span class="o">=</span> <span class="bp">False</span>

            <span class="n">logger</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span>
                       <span class="s2">&quot;{} - saved is {} - data changed is {} - status flags changed is {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                           <span class="n">myself</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">saved</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">data_changed</span><span class="p">,</span>
                           <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">statusflag_changed</span><span class="p">))</span>

            <span class="c1"># -------------------------------</span>
            <span class="c1">###setting up the logger to write inside a Text box in the GUI</span>
            <span class="c1"># -------------------------------</span>
            <span class="n">logTextBox</span> <span class="o">=</span> <span class="n">QPlainTextEditLogger</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
            <span class="c1"># You can format what is printed to text box</span>
            <span class="c1">#logTextBox.setFormatter(logging.Formatter(&#39;%(asctime)s - %(levelname)s - %(message)s&#39;))</span>

            <span class="c1">#logTextBox.setFormatter(logging.Formatter(&#39;%(levelname)s - %(message)s&#39;))</span>
            <span class="n">logTextBox</span><span class="o">.</span><span class="n">setFormatter</span><span class="p">(</span><span class="n">HTMLFormatter</span><span class="p">())</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">()</span><span class="o">.</span><span class="n">addHandler</span><span class="p">(</span><span class="n">logTextBox</span><span class="p">)</span>
            <span class="c1"># You can control the logging level</span>
            <span class="c1"># logging.getLogger().setLevel(logger.info)</span>

            <span class="c1"># -------------------------------</span>
            <span class="c1"># initialising new pulse checkbox to false</span>
            <span class="c1"># -------------------------------</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">checkBox_newpulse</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>




            <span class="c1"># -------------------------------</span>
            <span class="c1"># initialising tabs</span>
            <span class="c1"># -------------------------------</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_initialize_widget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">widget_LID1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_initialize_widget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">widget_LID2</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_initialize_widget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">widget_LID3</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_initialize_widget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">widget_LID4</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_initialize_widget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">widget_LID5</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_initialize_widget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">widget_LID6</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_initialize_widget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">widget_LID7</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_initialize_widget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">widget_LID8</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_initialize_widget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">widget_LID_14</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_initialize_widget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">widget_LID_58</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_initialize_widget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">widget_LID_ALL</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_initialize_widget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">widget_MIR</span><span class="p">)</span>

            <span class="c1"># set tabwidget index to 0 - lid1 is the tab shown at startup</span>
            <span class="c1"># self.tabWidget.setCurrentWidget(self.tabWidget.findChild(tabWidget, &#39;tab_LID1&#39;))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tabWidget</span><span class="o">.</span><span class="n">setCurrentIndex</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="c1"># -------------------------------</span>
            <span class="c1"># initialising folders</span>
            <span class="c1"># -------------------------------</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">Start CORMATpy&#39;</span><span class="p">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1"> {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">today</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">)))</span>
            <span class="n">cwd</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">workfold</span> <span class="o">=</span> <span class="n">cwd</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">home</span> <span class="o">=</span> <span class="n">cwd</span>
            <span class="n">parent</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">home</span><span class="p">)</span>
            <span class="k">if</span> <span class="s2">&quot;USR&quot;</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;USR in env&#39;</span><span class="p">)</span>
                <span class="c1"># self.owner = os.getenv(&#39;USR&#39;)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">owner</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getlogin</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;using getuser to authenticate&#39;</span><span class="p">)</span>
                <span class="kn">import</span> <span class="nn">getpass</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">owner</span> <span class="o">=</span> <span class="n">getpass</span><span class="o">.</span><span class="n">getuser</span><span class="p">()</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;this is your username {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">owner</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">homefold</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">sep</span><span class="p">,</span> <span class="s1">&#39;u&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">owner</span><span class="p">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;this is your homefold {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">homefold</span><span class="p">))</span>
            <span class="n">home</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">Path</span><span class="o">.</span><span class="n">home</span><span class="p">())</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">chain1</span> <span class="o">=</span> <span class="s1">&#39;/common/chain1/kg1/&#39;</span>
            <span class="n">extract_history</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">workfold</span> <span class="o">+</span> <span class="s1">&#39;/run_out.txt&#39;</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">chain1</span> <span class="o">+</span> <span class="s1">&#39;cormat_out.txt&#39;</span><span class="p">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;copying to local user profile&#39;</span><span class="p">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;we are in </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">cwd</span><span class="p">)</span>

            <span class="c1"># -------------------------------</span>
            <span class="c1"># Read  config self.data.</span>
            <span class="c1"># -------------------------------</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot; Reading in constants.&quot;</span><span class="p">)</span>
            <span class="c1"># test_logger()</span>
            <span class="c1"># raise SystemExit</span>


            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">constants</span> <span class="o">=</span> <span class="n">Consts</span><span class="p">(</span><span class="s2">&quot;consts.ini&quot;</span><span class="p">,</span> <span class="n">__version__</span><span class="p">)</span>
                <span class="c1"># constants = Kg1Consts(&quot;kg1_consts.ini&quot;, __version__)</span>
            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot; Could not read in configuration file consts.ini&quot;</span><span class="p">)</span>
                <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">65</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">poss_ne_corr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">CORR_NE</span><span class="p">]</span><span class="o">*</span><span class="mi">10</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">CORR_NE</span><span class="p">))</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">poss_vib_corr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">CORR_VIB</span><span class="p">]</span><span class="o">*</span><span class="mi">10</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">CORR_VIB</span><span class="p">))</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">poss_dcn_corr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">FJ_DCN</span><span class="p">]</span><span class="o">*</span><span class="mi">10</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">FJ_DCN</span><span class="p">))</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">poss_met_corr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">FJ_MET</span><span class="p">]</span><span class="o">*</span><span class="mi">10</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">FJ_MET</span><span class="p">))</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>

            <span class="c1"># matrix for converting DCN &amp; MET signals into density &amp; mirror movement</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">matrix_lat_channels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">MAT11</span> <span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">MAT12</span> <span class="p">],[</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">MAT21</span> <span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">MAT22</span> <span class="p">]])</span>


            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">sign_vib_corr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">poss_vib_corr</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">sign_vib_corr</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">poss_vib_corr</span> <span class="o">&lt;</span> <span class="mf">0.0</span><span class="p">)]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>

            <span class="c1"># -------------------------------</span>
            <span class="c1"># list of authorized user to write KG1 ppfs</span>
            <span class="c1"># -------------------------------</span>
            <span class="n">read_uis</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">user</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">readusers</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="n">user_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">readusers</span><span class="p">[</span><span class="n">user</span><span class="p">]</span>
                <span class="n">read_uis</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">user_name</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">exit_button</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle_exit_button</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">PathTranfile</span> <span class="o">=</span> <span class="bp">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">PathCatalog</span> <span class="o">=</span> <span class="s1">&#39;/home&#39;</span>
            <span class="c1"># -------------------------------</span>
            <span class="c1"># list of option to write ppf for current user</span>
            <span class="c1"># -------------------------------</span>
            <span class="n">write_uis</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="c1"># -------------------------------</span>
            <span class="c1"># check if owner is in list of authorised users</span>
            <span class="c1"># -------------------------------</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">owner</span> <span class="ow">in</span> <span class="n">read_uis</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
                    <span class="s1">&#39;user {} authorised to write public PPF&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">owner</span><span class="p">))</span>
                <span class="n">write_uis</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;JETPPF&#39;</span><span class="p">)</span>  <span class="c1"># jetppf first in the combobox list</span>
                <span class="n">write_uis</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">owner</span><span class="p">)</span>
                <span class="c1"># users.append(&#39;chain1&#39;)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
                    <span class="s1">&#39;user {} NOT authorised to write public PPF&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">owner</span><span class="p">))</span>
                <span class="n">write_uis</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">owner</span><span class="p">)</span>
            <span class="c1"># -------------------------------</span>
            <span class="c1"># initialise combobox</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_readuid</span><span class="o">.</span><span class="n">addItems</span><span class="p">(</span><span class="n">read_uis</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_writeuid</span><span class="o">.</span><span class="n">addItems</span><span class="p">(</span><span class="n">write_uis</span><span class="p">)</span>
            <span class="c1"># -------------------------------</span>
            <span class="c1"># set combobox index to 1 so that the default write_uid is owner</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">write_uis</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_writeuid</span><span class="o">.</span><span class="n">setCurrentIndex</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_writeuid</span><span class="o">.</span><span class="n">setCurrentIndex</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

            <span class="c1"># -------------------------------</span>
            <span class="c1"># set default pulse</span>
            <span class="c1"># initpulse = pdmsht()</span>
            <span class="c1">#initpulse = 92121</span>
            <span class="c1">#self.lineEdit_jpn.setText(str(initpulse))</span>
            <span class="c1"># -------------------------------</span>
            <span class="c1"># -------------------------------</span>
            <span class="c1"># list of the second trace signal use to be compared with KG1</span>
            <span class="c1"># -------------------------------</span>
            <span class="n">othersignallist</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;None&#39;</span><span class="p">,</span> <span class="s1">&#39;HRTS&#39;</span><span class="p">,</span> <span class="s1">&#39;Lidar&#39;</span><span class="p">,</span> <span class="s1">&#39;BremS&#39;</span><span class="p">,</span> <span class="s1">&#39;Far&#39;</span><span class="p">,</span> <span class="s1">&#39;CM&#39;</span><span class="p">,</span>
                               <span class="s1">&#39;KG1_RT&#39;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_2ndtrace</span><span class="o">.</span><span class="n">addItems</span><span class="p">(</span><span class="n">othersignallist</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_2ndtrace</span><span class="o">.</span><span class="n">activated</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plot_2nd_trace</span><span class="p">)</span>
            <span class="c1"># -------------------------------</span>
            <span class="c1"># list of markers</span>
            <span class="c1"># -------------------------------</span>
            <span class="n">markers</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;None&#39;</span><span class="p">,</span> <span class="s1">&#39;ELMs&#39;</span><span class="p">,</span> <span class="s1">&#39;NBI&#39;</span><span class="p">,</span> <span class="s1">&#39;PELLETs&#39;</span><span class="p">,</span> <span class="s1">&#39;MAGNETICs&#39;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_markers</span><span class="o">.</span><span class="n">addItems</span><span class="p">(</span><span class="n">markers</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_markers</span><span class="o">.</span><span class="n">activated</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plot_markers</span><span class="p">)</span>
            <span class="c1"># -------------------------------</span>
            <span class="c1"># disabling marker and second trace combo boxes</span>
            <span class="c1"># -------------------------------</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_markers</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_2ndtrace</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
            <span class="c1"># -------------------------------</span>
            <span class="c1"># connecting functions to buttons</span>
            <span class="c1"># -------------------------------</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">button_read_pulse</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle_readbutton_master</span><span class="p">)</span>
            <span class="c1"># self.button_read_pulse.clicked.connect(self.handle_readbutton)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">button_saveppf</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle_saveppfbutton</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">button_save</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dump_kg1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">button_normalize</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle_normalizebutton</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">button_restore</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle_button_restore</span><span class="p">)</span>
            <span class="c1"># self.pushButton_apply.clicked.connect(self.handle_applybutton)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pushButton_makeperm</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle_makepermbutton</span><span class="p">)</span>
            <span class="c1"># self.pushButton_undo.clicked.connect(self.handle_undobutton)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">checkSFbutton</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">checkStatuFlags</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">actionHelp</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle_help_menu</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">actionOpen_PDF_guide</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle_pdf_open</span><span class="p">)</span>
            <span class="c1"># -------------------------------</span>
            <span class="c1"># initialising code folders</span>
            <span class="c1"># -------------------------------</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="c1"># figure folder</span>
                <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="n">cwd</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">sep</span> <span class="o">+</span> <span class="s1">&#39;figures&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
                                                             <span class="n">exist_ok</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
                <span class="c1"># scratch folder - where you keep unsaved unfinished data</span>
                <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="n">cwd</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">sep</span> <span class="o">+</span> <span class="s1">&#39;scratch&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
                                                             <span class="n">exist_ok</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
                <span class="c1"># save foldere - where you keep saved pulse data</span>
                <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="n">cwd</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">sep</span> <span class="o">+</span> <span class="s1">&#39;saved&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
                                                           <span class="n">exist_ok</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">SystemExit</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">SystemExit</span><span class="p">(</span><span class="s1">&#39;failed to initialise folders&#39;</span><span class="p">)</span>
            <span class="c1"># -------------------------------</span>
            <span class="c1"># disable many button to avoid conflicts at startup</span>
            <span class="c1"># -------------------------------</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">button_saveppf</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">button_save</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">checkSFbutton</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">button_normalize</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
            <span class="c1"># self.pushButton_apply.setEnabled(False)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pushButton_makeperm</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pushButton_undo</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">button_restore</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
            <span class="c1"># -------------------------------</span>
            <span class="c1"># run code by default</span>
            <span class="c1"># self.button_read_pulse.click()</span>
            <span class="c1"># -------------------------------</span>
            <span class="c1"># -------------------------------</span>
            <span class="c1"># initialize to zero status flag radio buttons</span>
            <span class="c1"># -------------------------------</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">radioButton_statusflag_0</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">radioButton_statusflag_1</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">radioButton_statusflag_2</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">radioButton_statusflag_3</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">radioButton_statusflag_4</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
            <span class="c1"># -------------------------------</span>
            <span class="c1"># set status flag radio buttons to false</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">groupBox_statusflag</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
            <span class="c1"># -------------------------------</span>
            <span class="c1"># -------------------------------</span>
            <span class="c1"># set read uid combo box to disabled</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_readuid</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
            <span class="c1"># -------------------------------</span>
            <span class="c1"># to disable a tab use</span>
            <span class="c1"># self.tabWidget.setTabEnabled(3, False)</span>
            <span class="c1"># -------------------------------</span>
            <span class="c1"># setup automatic check on status flag</span>
            <span class="c1"># -------------------------------</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">checkBox_newpulse</span><span class="o">.</span><span class="n">toggled</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
                <span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">handle_check_status</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">checkBox_newpulse</span><span class="p">))</span>
            <span class="c1"># -------------------------------</span>
            <span class="c1"># #disable tab as there is nothing plotted</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tabWidget</span><span class="o">.</span><span class="n">setTabEnabled</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tabWidget</span><span class="o">.</span><span class="n">setTabEnabled</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="bp">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tabWidget</span><span class="o">.</span><span class="n">setTabEnabled</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="bp">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tabWidget</span><span class="o">.</span><span class="n">setTabEnabled</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="bp">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tabWidget</span><span class="o">.</span><span class="n">setTabEnabled</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="bp">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tabWidget</span><span class="o">.</span><span class="n">setTabEnabled</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="bp">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tabWidget</span><span class="o">.</span><span class="n">setTabEnabled</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="bp">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tabWidget</span><span class="o">.</span><span class="n">setTabEnabled</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="bp">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tabWidget</span><span class="o">.</span><span class="n">setTabEnabled</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="bp">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tabWidget</span><span class="o">.</span><span class="n">setTabEnabled</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="bp">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tabWidget</span><span class="o">.</span><span class="n">setTabEnabled</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="bp">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tabWidget</span><span class="o">.</span><span class="n">setTabEnabled</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="bp">False</span><span class="p">)</span>
            <span class="c1"># -------------------------------</span>
            <span class="c1"># making documentation</span>
            <span class="c1"># -------------------------------</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">documentation</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;yes&#39;</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;creating documentation&#39;</span><span class="p">)</span>
                <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="s1">&#39;../docs&#39;</span><span class="p">)</span>
                <span class="kn">import</span> <span class="nn">subprocess</span>
                <span class="n">subprocess</span><span class="o">.</span><span class="n">check_output</span><span class="p">(</span><span class="s1">&#39;make html&#39;</span><span class="p">,</span> <span class="n">shell</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
                <span class="n">subprocess</span><span class="o">.</span><span class="n">check_output</span><span class="p">(</span><span class="s1">&#39;make latex&#39;</span><span class="p">,</span> <span class="n">shell</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
                <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">home</span><span class="p">)</span>

            <span class="c1">#adding personalized object LineEdit to widget in GUI</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_mancorr</span> <span class="o">=</span> <span class="n">LineEdit</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">kb</span> <span class="o">=</span> <span class="n">KeyBoard</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_mancorr</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gridLayout_21</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_mancorr</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>




            <span class="c1"># -------------------------------</span>



            <span class="c1"># -------------------------------</span>
            <span class="c1"># check if kg1 is stored in workspace</span>
            <span class="c1"># -------------------------------</span>
            <span class="n">exists</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="s1">&#39;./scratch/kg1_data.pkl&#39;</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">exists</span> <span class="p">:</span>
                        <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">()</span><span class="o">.</span><span class="n">disabled</span> <span class="o">=</span> <span class="bp">True</span>

                        <span class="bp">self</span><span class="o">.</span><span class="n">load_pickle</span><span class="p">()</span>

                        <span class="c1"># logging.disable(logging.NOTSET)</span>
                        <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">()</span><span class="o">.</span><span class="n">disabled</span> <span class="o">=</span> <span class="bp">False</span>
                        <span class="n">logger</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="s1">&#39;checking pulse data in workspace&#39;</span><span class="p">)</span>
                        <span class="n">list_attr</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;self.data.KG1_data&#39;</span><span class="p">,</span><span class="s1">&#39;self.data.KG4_data&#39;</span><span class="p">,</span> <span class="s1">&#39;self.data.MAG_data&#39;</span><span class="p">,</span> <span class="s1">&#39;self.data.PELLETS_data&#39;</span><span class="p">,</span><span class="s1">&#39;self.data.ELM_data&#39;</span><span class="p">,</span> <span class="s1">&#39;self.data.HRTS_data&#39;</span><span class="p">,</span><span class="s1">&#39;self.data.NBI_data&#39;</span><span class="p">,</span> <span class="s1">&#39;self.data.is_dis&#39;</span><span class="p">,</span> <span class="s1">&#39;self.data.dis_time&#39;</span><span class="p">,</span><span class="s1">&#39;self.data.LIDAR_data&#39;</span><span class="p">]</span>
                        <span class="k">for</span> <span class="n">attr</span> <span class="ow">in</span> <span class="n">list_attr</span><span class="p">:</span>
                            <span class="c1"># pyqt_set_trace()</span>
                            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attr</span><span class="p">):</span>
                                <span class="nb">delattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">attr</span><span class="p">)</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="s2">&quot;CORMAT_py - {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">pulse</span><span class="p">))</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_jpn</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">pulse</span><span class="p">))</span>


                        <span class="k">del</span>  <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">pulse</span>




            
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;INIT DONE&#39;</span><span class="p">)</span>
            <span class="c1">#auto click read button</span>
            <span class="c1"># self.button_read_pulse.click()</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;Error!&#39;</span><span class="p">)</span>



    <span class="c1">#-------------------------------</span>
    <span class="nd">@QtCore.pyqtSlot</span><span class="p">()</span>
<div class="viewcode-block" id="CORMAT_GUI.handle_readbutton_master"><a class="viewcode-back" href="../Cormat_main.html#Cormat_main.CORMAT_GUI.handle_readbutton_master">[docs]</a>    <span class="k">def</span> <span class="nf">handle_readbutton_master</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        implemets what happen when clicking the load button on the GUI</span>
<span class="sd">        the logic is explained in the FLowDiagram ../FlowDiagram/load_button_new.dia</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># -------------------------------</span>
        <span class="c1"># reading pulse from GUI</span>
        <span class="c1"># -------------------------------</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">pulse</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_jpn</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>


        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">pulse</span> <span class="ow">is</span> <span class="s1">&#39;&#39;</span><span class="p">:</span> <span class="c1">#user has not entered a pulse number</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;PLEASE USE JPN lower than {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">((</span><span class="n">pdmsht</span><span class="p">())))</span>
            <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">pulse</span> <span class="ow">is</span> <span class="ow">not</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s2">&quot;ERROR no pulse selected&quot;</span>
            <span class="k">return</span>


        <span class="k">else</span><span class="p">:</span>
            <span class="c1">#self.data.pulse = int(self.lineEdit_jpn.text())</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">pulse</span><span class="p">)</span>

            <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;PLEASE USE JPN lower than {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">((</span><span class="n">pdmsht</span><span class="p">())))</span>
                <span class="k">return</span>

            <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">pulse</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">pdmsht</span><span class="p">():</span>
                   <span class="k">pass</span> <span class="c1"># user has entered a valid pulse number</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;PLEASE USE JPN lower than {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">((</span><span class="n">pdmsht</span><span class="p">())))</span>
                <span class="k">return</span>



        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">pulse</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_jpn</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="s2">&quot;resetting Canvas before reading data&quot;</span><span class="p">)</span>
        <span class="c1"># status flag groupbox is disabled</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">groupBox_statusflag</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tabWidget</span><span class="o">.</span><span class="n">setCurrentIndex</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

        <span class="c1"># disable &quot;normalize&quot; and &quot;restore&quot; buttons</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">button_normalize</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">button_restore</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_markers</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_2ndtrace</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_2ndtrace</span><span class="o">.</span><span class="n">setCurrentIndex</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_markers</span><span class="o">.</span><span class="n">setCurrentIndex</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

        <span class="c1">#</span>
        <span class="c1"># self.tabWidget.setTabEnabled(0, True)</span>
        <span class="c1"># self.tabWidget.setTabEnabled(1, True)</span>
        <span class="c1"># self.tabWidget.setTabEnabled(2, True)</span>
        <span class="c1"># self.tabWidget.setTabEnabled(3, True)</span>
        <span class="c1"># self.tabWidget.setTabEnabled(4, True)</span>
        <span class="c1"># self.tabWidget.setTabEnabled(5, True)</span>
        <span class="c1"># self.tabWidget.setTabEnabled(6, True)</span>
        <span class="c1"># self.tabWidget.setTabEnabled(7, True)</span>
        <span class="c1"># self.tabWidget.setTabEnabled(8, True)</span>
        <span class="c1"># self.tabWidget.setTabEnabled(9, True)</span>
        <span class="c1"># self.tabWidget.setTabEnabled(10, True)</span>
        <span class="c1"># self.tabWidget.setTabEnabled(11, True)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID1</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID1</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID2</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID2</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID3</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID3</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID4</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID4</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID5</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID5</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID6</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID6</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID7</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID7</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID8</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID8</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID_14</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID_14</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID_58</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID_58</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID_ALL</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID_ALL</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">widget_MIR</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">widget_MIR</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>



        <span class="c1"># -------------------------------</span>
        <span class="c1"># check if kg1 is stored in workspace</span>
        <span class="c1"># -------------------------------</span>
        <span class="n">exists</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="s1">&#39;./scratch/kg1_data.pkl&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">exists</span> <span class="p">:</span>
            <span class="k">assert</span><span class="p">(</span><span class="n">exists</span><span class="p">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span> <span class="s2">&quot;The workspace contains data not saved to ppf&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">data_changed</span> <span class="o">=</span> <span class="bp">True</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">statusflag_changed</span> <span class="o">=</span> <span class="bp">True</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">saved</span> <span class="o">=</span> <span class="bp">False</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">pass</span>



        <span class="c1"># data_changed = equalsFile(&#39;./saved/&#39; + str(self.data.pulse) + &#39;_kg1.pkl&#39;,</span>
        <span class="c1">#                           &#39;./scratch/&#39; + str(self.data.pulse) + &#39;_kg1.pkl&#39;)</span>

        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">data_changed</span> <span class="o">|</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">statusflag_changed</span><span class="p">)</span> <span class="o">==</span> <span class="bp">True</span><span class="p">:</span> <span class="c1"># data has changed</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="s2">&quot; data or status flags have changed&quot;</span><span class="p">)</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">saved</span><span class="p">:</span>  <span class="c1"># data saved to ppf</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="s2">&quot;  data or status flag have been saved to PPF&quot;</span><span class="p">)</span>
                <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">checkBox_newpulse</span><span class="o">.</span><span class="n">isChecked</span><span class="p">()):</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;{} is  checked&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">checkBox_newpulse</span><span class="o">.</span><span class="n">objectName</span><span class="p">()))</span>

                    <span class="c1"># -------------------------------</span>
                    <span class="c1"># READ self.data.</span>
                    <span class="c1"># -------------------------------</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">read_uid</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_readuid</span><span class="o">.</span><span class="n">currentText</span><span class="p">())</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Reading data for pulse {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">pulse</span><span class="p">)))</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;reading data with uid -  {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">((</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">read_uid</span><span class="p">))))</span>
                    <span class="n">success</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">readdata</span><span class="p">()</span>
                    <span class="c1"># self.tabWidget.setCurrentIndex(0)</span>
                    <span class="c1"># self.tabSelected(arg=0)</span>
                    <span class="c1"># -------------------------------</span>
                    <span class="c1"># PLOT KG1 self.data.</span>
                    <span class="c1"># -------------------------------</span>
                    <span class="k">if</span> <span class="n">success</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">plot_data</span><span class="p">()</span>

                        <span class="c1"># -------------------------------</span>
                        <span class="c1"># update GUI after plot</span>
                        <span class="c1"># -------------------------------</span>

                        <span class="bp">self</span><span class="o">.</span><span class="n">GUI_refresh</span><span class="p">()</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span>
                            <span class="s2">&quot;CORMAT_py - {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">pulse</span><span class="p">))</span>

                        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">old_pulse</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">pulse</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;ERROR reading data&quot;</span><span class="p">)</span>


                <span class="k">else</span><span class="p">:</span>
                    <span class="n">logging</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s1">&#39; NO action performed </span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
                    <span class="n">logging</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1"> please click new pulse!&#39;</span><span class="p">)</span><span class="c1"># new pulse not checked</span>
                    <span class="k">pass</span>

            <span class="k">else</span><span class="p">:</span>  <span class="c1"># pulse not saved to ppf</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="s2">&quot;data or status flag have NOT been saved to PPF&quot;</span><span class="p">)</span>

                <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">checkBox_newpulse</span><span class="o">.</span><span class="n">isChecked</span><span class="p">()):</span>
                    <span class="k">assert</span> <span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">data_changed</span> <span class="o">|</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">statusflag_changed</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span>
                        <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">saved</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">checkBox_newpulse</span><span class="o">.</span><span class="n">isChecked</span><span class="p">()))</span>

                    <span class="n">logger</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;{} is  checked&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">checkBox_newpulse</span><span class="o">.</span><span class="n">objectName</span><span class="p">()))</span>

                    <span class="c1"># if exists and and new pulse checkbox is checked then ask for confirmation if user wants to carry on</span>
                    <span class="c1">#logger.info(&#39; pulse data already downloaded - you are requesting to download again&#39;)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">areyousure_window</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QMainWindow</span><span class="p">()</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ui_areyousure</span> <span class="o">=</span> <span class="n">Ui_areyousure_window</span><span class="p">()</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ui_areyousure</span><span class="o">.</span><span class="n">setupUi</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">areyousure_window</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">areyousure_window</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

                    <span class="bp">self</span><span class="o">.</span><span class="n">ui_areyousure</span><span class="o">.</span><span class="n">pushButton_YES</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">handle_yes</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ui_areyousure</span><span class="o">.</span><span class="n">pushButton_NO</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">handle_no</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;{} is NOT  checked&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">checkBox_newpulse</span><span class="o">.</span><span class="n">objectName</span><span class="p">()))</span>
                    <span class="c1"># pyqt_set_trace()</span>
                    <span class="c1"># logging.disable(logger.info)</span>
                    <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">()</span><span class="o">.</span><span class="n">disabled</span> <span class="o">=</span> <span class="bp">True</span>

                    <span class="bp">self</span><span class="o">.</span><span class="n">load_pickle</span><span class="p">()</span>

                    <span class="c1"># logging.disable(logging.NOTSET)</span>
                    <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">()</span><span class="o">.</span><span class="n">disabled</span> <span class="o">=</span> <span class="bp">False</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="s1">&#39;checking pulse data in workspace&#39;</span><span class="p">)</span>
                    <span class="c1"># pyqt_set_trace()</span>

                    <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">old_pulse</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">pulse</span>

                    <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">pulse</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_jpn</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>
                    <span class="c1"># pyqt_set_trace()</span>
                    <span class="n">list_attr</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;self.data.KG1_data&#39;</span><span class="p">,</span><span class="s1">&#39;self.data.KG4_data&#39;</span><span class="p">,</span> <span class="s1">&#39;self.data.MAG_data&#39;</span><span class="p">,</span> <span class="s1">&#39;self.data.PELLETS_data&#39;</span><span class="p">,</span><span class="s1">&#39;self.data.ELM_data&#39;</span><span class="p">,</span> <span class="s1">&#39;self.data.HRTS_data&#39;</span><span class="p">,</span><span class="s1">&#39;self.data.NBI_data&#39;</span><span class="p">,</span> <span class="s1">&#39;self.data.is_dis&#39;</span><span class="p">,</span> <span class="s1">&#39;self.data.dis_time&#39;</span><span class="p">,</span><span class="s1">&#39;self.data.LIDAR_data&#39;</span><span class="p">]</span>
                    <span class="k">for</span> <span class="n">attr</span> <span class="ow">in</span> <span class="n">list_attr</span><span class="p">:</span>
                        <span class="c1"># pyqt_set_trace()</span>
                        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attr</span><span class="p">):</span>
                            <span class="nb">delattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">attr</span><span class="p">)</span>
                    <span class="c1"># pyqt_set_trace()</span>

                    <span class="c1"># if (self.data.old_pulse is None) | (self.data.old_pulse == self.data.pulse):</span>
                    <span class="k">if</span>  <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">old_pulse</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">pulse</span><span class="p">):</span>
                        <span class="c1"># -------------------------------</span>
                        <span class="c1"># READ self.data.</span>
                        <span class="c1"># -------------------------------</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">read_uid</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBox_readuid</span><span class="o">.</span><span class="n">currentText</span><span class="p">())</span>
                        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;reading data with uid -  {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                                <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">read_uid</span><span class="p">))))</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">load_pickle</span><span class="p">()</span>

                        <span class="k">for</span> <span class="n">chan</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">density</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                            <span class="n">logger</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;enabling channel {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">chan</span><span class="p">))</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">tabWidget</span><span class="o">.</span><span class="n">setTabEnabled</span><span class="p">(</span><span class="n">chan</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>

                        <span class="n">logger</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;enabling tab {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">tabWidget</span><span class="o">.</span><span class="n">setTabEnabled</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
                        <span class="n">logger</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;enabling tab {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">tabWidget</span><span class="o">.</span><span class="n">setTabEnabled</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
                        <span class="n">logger</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;enabling tab {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="mi">11</span><span class="p">))</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">tabWidget</span><span class="o">.</span><span class="n">setTabEnabled</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
                        <span class="n">logger</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;enabling tab {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="mi">12</span><span class="p">))</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">tabWidget</span><span class="o">.</span><span class="n">setTabEnabled</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
                        <span class="c1"># self.tabWidget.setCurrentIndex(0)</span>
                        <span class="c1"># self.tabSelected(arg=0)</span>
                        <span class="c1"># -------------------------------</span>
                        <span class="c1"># PLOT KG1 self.data.</span>
                        <span class="c1"># -------------------------------</span>

                        <span class="bp">self</span><span class="o">.</span><span class="n">plot_data</span><span class="p">()</span>

                            <span class="c1"># -------------------------------</span>
                            <span class="c1"># update GUI after plot</span>
                            <span class="c1"># -------------------------------</span>

                        <span class="bp">self</span><span class="o">.</span><span class="n">GUI_refresh</span><span class="p">()</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span>
                            <span class="s2">&quot;CORMAT_py - {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">pulse</span><span class="p">))</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">old_pulse</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">pulse</span>



                    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">old_pulse</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">pulse</span><span class="p">:</span>
                        <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;no action performed, check input data&#39;</span><span class="p">)</span>
                        <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;old pulse is {} - selected pulse is {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">old_pulse</span><span class="p">),</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">pulse</span><span class="p">)))</span>
                        <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;you have unsaved data in your workspace!&#39;</span><span class="p">)</span>
                        <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">checkBox_newpulse</span><span class="o">.</span><span class="n">isChecked</span><span class="p">()):</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="s1">&#39; {} is  checked&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">checkBox_newpulse</span><span class="o">.</span><span class="n">objectName</span><span class="p">()))</span>
                <span class="c1"># if exists and and new pulse checkbox is checked then ask for confirmation if user wants to carry on</span>
                <span class="c1">#logger.info(&#39; pulse data already downloaded - you are requesting to download again&#39;)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">areyousure_window</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QMainWindow</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ui_areyousure</span> <span class="o">=</span> <span class="n">Ui_areyousure_window</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ui_areyousure</span><span class="o">.</span><span class="n">setupUi</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">areyousure_window</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">areyousure_window</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">ui_areyousure</span><span class="o">.</span><span class="n">pushButton_YES</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">handle_yes</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ui_areyousure</span><span class="o">.</span><span class="n">pushButton_NO</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle_no</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;{} is NOT checked&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">checkBox_newpulse</span><span class="o">.</span><span class="n">objectName</span><span class="p">()))</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39; no action performed&#39;</span><span class="p">)</span>



        <span class="c1">#now set</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">saved</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">statusflag_changed</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">data_changed</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="s2">&quot; {} - saved is {} - data changed is {} - status flags changed is {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">myself</span><span class="p">(),</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">saved</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">data_changed</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">statusflag_changed</span><span class="p">))</span></div>


        <span class="c1"># pyqt_set_trace()</span>


<span class="c1"># ----------------------------</span>


<span class="c1"># -------------------------</span>
    <span class="nd">@QtCore.pyqtSlot</span><span class="p">()</span>
<div class="viewcode-block" id="CORMAT_GUI.checkStatuFlags"><a class="viewcode-back" href="../Cormat_main.html#Cormat_main.CORMAT_GUI.checkStatuFlags">[docs]</a>    <span class="k">def</span> <span class="nf">checkStatuFlags</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        reads the list containing pulse status flag</span>
<span class="sd">        :return:</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">SF_list</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">SF_ch1</span><span class="p">),</span>
                        <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">SF_ch2</span><span class="p">),</span>
                        <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">SF_ch3</span><span class="p">),</span>
                        <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">SF_ch4</span><span class="p">),</span>
                        <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">SF_ch5</span><span class="p">),</span>
                        <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">SF_ch6</span><span class="p">),</span>
                        <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">SF_ch7</span><span class="p">),</span>
                        <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">SF_ch8</span><span class="p">)]</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> has the following SF </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">pulse</span><span class="p">),</span>
                     <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">SF_list</span><span class="p">)</span></div>

<span class="c1"># ------------------------</span>



<span class="c1"># ------------------------</span>
<div class="viewcode-block" id="CORMAT_GUI.canvasselected"><a class="viewcode-back" href="../Cormat_main.html#Cormat_main.CORMAT_GUI.canvasselected">[docs]</a>    <span class="k">def</span> <span class="nf">canvasselected</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">arg</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        function that convert arg number into tab name</span>
<span class="sd">        it also sets the SF value when changing tabs</span>
<span class="sd">        :param arg: index of canvas</span>
<span class="sd">        :return:</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># logger.log(5, &#39;tab number is {}&#39;.format(str(arg + 1)))</span>
        <span class="k">if</span> <span class="n">arg</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;status flag is {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">SF_ch1</span><span class="p">)))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">groupBox_statusflag</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">current_tab</span> <span class="o">=</span> <span class="s1">&#39;LID_1&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">chan</span> <span class="o">=</span> <span class="s1">&#39;1&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_status_flag_radio</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">SF_ch1</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">arg</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;status flag is {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">SF_ch2</span><span class="p">)))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">groupBox_statusflag</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">current_tab</span> <span class="o">=</span> <span class="s1">&#39;LID_2&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">chan</span> <span class="o">=</span> <span class="s1">&#39;2&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_status_flag_radio</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">SF_ch2</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">arg</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;status flag is {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">SF_ch3</span><span class="p">)))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">groupBox_statusflag</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">current_tab</span> <span class="o">=</span> <span class="s1">&#39;LID_3&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">chan</span> <span class="o">=</span> <span class="s1">&#39;3&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_status_flag_radio</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">SF_ch3</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">arg</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;status flag is {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">SF_ch4</span><span class="p">)))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">groupBox_statusflag</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">current_tab</span> <span class="o">=</span> <span class="s1">&#39;LID_4&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">chan</span> <span class="o">=</span> <span class="s1">&#39;4&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_status_flag_radio</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">SF_ch4</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">arg</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;status flag is {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">SF_ch5</span><span class="p">)))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">groupBox_statusflag</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">current_tab</span> <span class="o">=</span> <span class="s1">&#39;LID_5&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">chan</span> <span class="o">=</span> <span class="s1">&#39;5&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_status_flag_radio</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">SF_ch5</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">arg</span> <span class="o">==</span> <span class="mi">5</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;status flag is {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">SF_ch6</span><span class="p">)))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">groupBox_statusflag</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">current_tab</span> <span class="o">=</span> <span class="s1">&#39;LID_6&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">chan</span> <span class="o">=</span> <span class="s1">&#39;6&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_status_flag_radio</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">SF_ch6</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">arg</span> <span class="o">==</span> <span class="mi">6</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;status flag is {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">SF_ch7</span><span class="p">)))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">groupBox_statusflag</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">current_tab</span> <span class="o">=</span> <span class="s1">&#39;LID_7&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">chan</span> <span class="o">=</span> <span class="s1">&#39;7&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_status_flag_radio</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">SF_ch7</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">arg</span> <span class="o">==</span> <span class="mi">7</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;status flag is {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">SF_ch8</span><span class="p">)))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">groupBox_statusflag</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">current_tab</span> <span class="o">=</span> <span class="s1">&#39;LID_8&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">chan</span> <span class="o">=</span> <span class="s1">&#39;8&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_status_flag_radio</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">SF_ch8</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">arg</span> <span class="o">==</span> <span class="mi">8</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">groupBox_statusflag</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">current_tab</span> <span class="o">=</span> <span class="s1">&#39;LID_1-4&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">chan</span> <span class="o">=</span> <span class="s1">&#39;vertical&#39;</span>
        <span class="k">if</span> <span class="n">arg</span> <span class="o">==</span> <span class="mi">9</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">groupBox_statusflag</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">current_tab</span> <span class="o">=</span> <span class="s1">&#39;LID_5-8&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">chan</span> <span class="o">=</span> <span class="s1">&#39;lateral&#39;</span>
        <span class="k">if</span> <span class="n">arg</span> <span class="o">==</span> <span class="mi">10</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">groupBox_statusflag</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">current_tab</span> <span class="o">=</span> <span class="s1">&#39;LID_ALL&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">chan</span> <span class="o">=</span> <span class="s1">&#39;all&#39;</span>
        <span class="k">if</span> <span class="n">arg</span> <span class="o">==</span> <span class="mi">11</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">groupBox_statusflag</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">current_tab</span> <span class="o">=</span> <span class="s1">&#39;MIR&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">chan</span> <span class="o">=</span> <span class="s1">&#39;vib&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gettotalcorrections</span><span class="p">()</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\t</span><span class="s1">: current Tab is {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_tab</span><span class="p">))</span></div>
<span class="c1">#-------------------------</span>
<div class="viewcode-block" id="CORMAT_GUI.setcoord"><a class="viewcode-back" href="../Cormat_main.html#Cormat_main.CORMAT_GUI.setcoord">[docs]</a>    <span class="k">def</span> <span class="nf">setcoord</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">chan</span><span class="p">,</span><span class="n">reset</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        connects selected tab to its own list of selected data points</span>

<span class="sd">        :param reset:</span>
<span class="sd">        :return:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">reset</span> <span class="ow">is</span> <span class="bp">False</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">chan</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;1&#39;</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">coord_ch1</span>
            <span class="k">elif</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chan</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;2&#39;</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">coord_ch2</span>
            <span class="k">elif</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chan</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;3&#39;</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">coord_ch3</span>
            <span class="k">elif</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chan</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;4&#39;</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">coord_ch4</span>
            <span class="k">elif</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chan</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;5&#39;</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">coord_ch5</span>
            <span class="k">elif</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chan</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;6&#39;</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">coord_ch6</span>
            <span class="k">elif</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chan</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;7&#39;</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">coord_ch7</span>
            <span class="k">elif</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chan</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;8&#39;</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">coord_ch8</span>
        <span class="k">elif</span> <span class="n">reset</span> <span class="ow">is</span> <span class="bp">True</span> <span class="ow">and</span> <span class="n">chan</span> <span class="o">==</span><span class="s1">&#39;all&#39;</span><span class="p">:</span>
            <span class="c1">#reset all channels</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">coord_ch1</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">coord_ch2</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">coord_ch3</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">coord_ch4</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">coord_ch5</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">coord_ch6</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">coord_ch7</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">coord_ch8</span> <span class="o">=</span> <span class="p">[]</span>


        <span class="k">elif</span> <span class="n">reset</span> <span class="ow">is</span> <span class="bp">True</span><span class="p">:</span>
            <span class="c1">#reset single channel</span>
            <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">chan</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;1&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">coord_ch1</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">elif</span> <span class="nb">str</span><span class="p">(</span><span class="n">chan</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;2&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">coord_ch2</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">elif</span> <span class="nb">str</span><span class="p">(</span><span class="n">chan</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;3&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">coord_ch3</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">elif</span> <span class="nb">str</span><span class="p">(</span><span class="n">chan</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;4&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">coord_ch4</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">elif</span> <span class="nb">str</span><span class="p">(</span><span class="n">chan</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;5&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">coord_ch5</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">elif</span> <span class="nb">str</span><span class="p">(</span><span class="n">chan</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;6&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">coord_ch6</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">elif</span> <span class="nb">str</span><span class="p">(</span><span class="n">chan</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;7&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">coord_ch7</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">elif</span> <span class="nb">str</span><span class="p">(</span><span class="n">chan</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;8&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">coord_ch8</span> <span class="o">=</span> <span class="p">[]</span></div>


<span class="c1"># -------------------------</span>
<div class="viewcode-block" id="CORMAT_GUI.checkstate"><a class="viewcode-back" href="../Cormat_main.html#Cormat_main.CORMAT_GUI.checkstate">[docs]</a>    <span class="k">def</span> <span class="nf">checkstate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">button</span><span class="p">):</span>

        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        connect tab number to LID channel and sets status flag</span>
<span class="sd">        it also performs a check if the user clicked a radio button to change status flag for current tab/channel</span>
<span class="sd">        :param button:</span>
<span class="sd">        :return:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># snd = self.sender() # gets object that called</span>


        <span class="n">SF</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">button</span><span class="o">.</span><span class="n">objectName</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">2</span><span class="p">])</span>  <span class="c1"># statusflag value selected</span>



        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_tab</span> <span class="o">==</span> <span class="s1">&#39;LID_1&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">SF_ch1</span> <span class="o">=</span> <span class="n">SF</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_tab</span> <span class="o">==</span> <span class="s1">&#39;LID_2&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">SF_ch2</span> <span class="o">=</span> <span class="n">SF</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_tab</span> <span class="o">==</span> <span class="s1">&#39;LID_3&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">SF_ch3</span> <span class="o">=</span> <span class="n">SF</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_tab</span> <span class="o">==</span> <span class="s1">&#39;LID_4&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">SF_ch4</span> <span class="o">=</span> <span class="n">SF</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_tab</span> <span class="o">==</span> <span class="s1">&#39;LID_5&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">SF_ch5</span> <span class="o">=</span> <span class="n">SF</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_tab</span> <span class="o">==</span> <span class="s1">&#39;LID_6&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">SF_ch6</span> <span class="o">=</span> <span class="n">SF</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_tab</span> <span class="o">==</span> <span class="s1">&#39;LID_7&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">SF_ch7</span> <span class="o">=</span> <span class="n">SF</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_tab</span> <span class="o">==</span> <span class="s1">&#39;LID_8&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">SF_ch8</span> <span class="o">=</span> <span class="n">SF</span>


        <span class="k">if</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">SF_old1</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">SF_ch1</span><span class="p">)):</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">statusflag_changed</span> <span class="o">=</span> <span class="bp">True</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="s2">&quot;status flag LID1 changed by user&quot;</span><span class="p">)</span>

        <span class="k">elif</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">SF_old2</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">SF_ch2</span><span class="p">)):</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">statusflag_changed</span> <span class="o">=</span> <span class="bp">True</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="s2">&quot;status flag LID2 changed by user&quot;</span><span class="p">)</span>

        <span class="k">elif</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">SF_old3</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">SF_ch3</span><span class="p">)):</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">statusflag_changed</span> <span class="o">=</span> <span class="bp">True</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="s2">&quot;status flag LID3 changed by user&quot;</span><span class="p">)</span>

        <span class="k">elif</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">SF_old4</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">SF_ch4</span><span class="p">)):</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">statusflag_changed</span> <span class="o">=</span> <span class="bp">True</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="s2">&quot;status flag LID4 changed by user&quot;</span><span class="p">)</span>

        <span class="k">elif</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">SF_old5</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">SF_ch5</span><span class="p">)):</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">statusflag_changed</span> <span class="o">=</span> <span class="bp">True</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="s2">&quot;status flag LID5 changed by user&quot;</span><span class="p">)</span>

        <span class="k">elif</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">SF_old6</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">SF_ch6</span><span class="p">)):</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">statusflag_changed</span> <span class="o">=</span> <span class="bp">True</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="s2">&quot;status flag LID6 changed by user&quot;</span><span class="p">)</span>

        <span class="k">elif</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">SF_old7</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">SF_ch7</span><span class="p">)):</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">statusflag_changed</span> <span class="o">=</span> <span class="bp">True</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="s2">&quot;status flag LID7 changed by user&quot;</span><span class="p">)</span>

        <span class="k">elif</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">SF_old8</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">SF_ch8</span><span class="p">)):</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">statusflag_changed</span> <span class="o">=</span> <span class="bp">True</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="s2">&quot;status flag LID8 changed by user&quot;</span><span class="p">)</span></div>


<span class="c1"># -------------------------</span>

<div class="viewcode-block" id="CORMAT_GUI.set_status_flag_radio"><a class="viewcode-back" href="../Cormat_main.html#Cormat_main.CORMAT_GUI.set_status_flag_radio">[docs]</a>    <span class="k">def</span> <span class="nf">set_status_flag_radio</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        converts status flag integer value into boolean to check SF radio buttons in GUI</span>
<span class="sd">        :param value: status flag to be applied to selected channel</span>
<span class="sd">        :return:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">value</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">radioButton_statusflag_0</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">radioButton_statusflag_1</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">radioButton_statusflag_2</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">radioButton_statusflag_3</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">radioButton_statusflag_4</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">value</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">radioButton_statusflag_0</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">radioButton_statusflag_1</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">radioButton_statusflag_2</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">radioButton_statusflag_3</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">radioButton_statusflag_4</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">value</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">radioButton_statusflag_0</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">radioButton_statusflag_1</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">radioButton_statusflag_2</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">radioButton_statusflag_3</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">radioButton_statusflag_4</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">value</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">radioButton_statusflag_0</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">radioButton_statusflag_1</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">radioButton_statusflag_2</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">radioButton_statusflag_3</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">radioButton_statusflag_4</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">value</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">radioButton_statusflag_0</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">radioButton_statusflag_1</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">radioButton_statusflag_2</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">radioButton_statusflag_3</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">radioButton_statusflag_4</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;data saved is {} - status flag saved is - data changed is {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">saved</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">statusflag_changed</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">data_changed</span><span class="p">))</span></div>


    <span class="c1"># ------------------------</span>
<div class="viewcode-block" id="CORMAT_GUI.load_pickle"><a class="viewcode-back" href="../Cormat_main.html#Cormat_main.CORMAT_GUI.load_pickle">[docs]</a>    <span class="k">def</span> <span class="nf">load_pickle</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        loads last saved data from non saved operations</span>
<span class="sd">        data are saved in pickle format (binary)</span>

<span class="sd">        also to be used when reloading a pulse</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39; loading pulse data from workspace&#39;</span><span class="p">)</span>
        <span class="c1"># Python 3: open(..., &#39;rb&#39;)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;./saved/data.pkl&#39;</span><span class="p">,</span>
                  <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">pulse</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="p">,</span>
             <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG4_data</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">MAG_data</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">PELLETS_data</span><span class="p">,</span>
             <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">ELM_data</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">HRTS_data</span><span class="p">,</span>
             <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">NBI_data</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">is_dis</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">dis_time</span><span class="p">,</span>
             <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">LIDAR_data</span><span class="p">]</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;./scratch/kg1_data.pkl&#39;</span><span class="p">,</span>
                  <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>  <span class="c1"># Python 3: open(..., &#39;rb&#39;)</span>
            <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">SF_list</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">unval_seq</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">val_seq</span><span class="p">,</span>
             <span class="bp">self</span><span class="o">.</span><span class="n">read_uid</span><span class="p">]</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39; workspace loaded&#39;</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
            <span class="s1">&#39; workspace data comes from userid {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">read_uid</span><span class="p">))</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
            <span class="s1">&#39;{} has the following SF {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">pulse</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">SF_list</span><span class="p">))</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">mode</span> <span class="o">!=</span> <span class="s2">&quot;Automatic Corrections&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">correctedby</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">mode</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)[</span><span class="mi">2</span><span class="p">]</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;{} last validated seq is {} by {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">pulse</span><span class="p">),</span>
                                                                    <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">val_seq</span><span class="p">),</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">correctedby</span><span class="p">))</span>

        <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">SF_ch1</span><span class="p">,</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">SF_ch2</span><span class="p">,</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">SF_ch3</span><span class="p">,</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">SF_ch4</span><span class="p">,</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">SF_ch5</span><span class="p">,</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">SF_ch6</span><span class="p">,</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">SF_ch7</span><span class="p">,</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">SF_ch8</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">SF_list</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">SF_old1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">SF_ch1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">SF_old2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">SF_ch2</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">SF_old3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">SF_ch3</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">SF_old4</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">SF_ch4</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">SF_old5</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">SF_ch5</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">SF_old6</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">SF_ch6</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">SF_old7</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">SF_ch7</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">SF_old8</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">SF_ch8</span>

        <span class="c1"># set saved status to False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">saved</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">data_changed</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">statusflag_changed</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="s2">&quot;load_pickle - saved is {} - data changed is {} - status flags changed is {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">saved</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">data_changed</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">statusflag_changed</span><span class="p">))</span></div>



    <span class="c1"># ------------------------</span>
<div class="viewcode-block" id="CORMAT_GUI.save_to_pickle"><a class="viewcode-back" href="../Cormat_main.html#Cormat_main.CORMAT_GUI.save_to_pickle">[docs]</a>    <span class="k">def</span> <span class="nf">save_to_pickle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">folder</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        saves to pickle experimental data</span>
<span class="sd">        :param folder: for now user can save either to saved or scratch folder</span>
<span class="sd">        :return:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39; saving pulse data to {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">folder</span><span class="p">))</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;./&#39;</span> <span class="o">+</span> <span class="n">folder</span> <span class="o">+</span> <span class="s1">&#39;/data.pkl&#39;</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span>
                <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">pulse</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="p">,</span>
                 <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG4_data</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">MAG_data</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">PELLETS_data</span><span class="p">,</span>
                 <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">ELM_data</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">HRTS_data</span><span class="p">,</span>
                 <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">NBI_data</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">is_dis</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">dis_time</span><span class="p">,</span>
                 <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">LIDAR_data</span><span class="p">],</span> <span class="n">f</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39; data saved to {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">folder</span><span class="p">))</span></div>

    <span class="c1"># ------------------------</span>
<div class="viewcode-block" id="CORMAT_GUI.save_kg1"><a class="viewcode-back" href="../Cormat_main.html#Cormat_main.CORMAT_GUI.save_kg1">[docs]</a>    <span class="k">def</span> <span class="nf">save_kg1</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">folder</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        module that saves just kg1 data to folder</span>
<span class="sd">        :param folder:</span>
<span class="sd">        :return:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39; saving KG1 data to {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">folder</span><span class="p">))</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;./&#39;</span> <span class="o">+</span> <span class="n">folder</span> <span class="o">+</span> <span class="s1">&#39;/kg1_data.pkl&#39;</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span>
                <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">SF_list</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">unval_seq</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">val_seq</span><span class="p">,</span>
                 <span class="bp">self</span><span class="o">.</span><span class="n">read_uid</span><span class="p">,],</span> <span class="n">f</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39; KG1 data saved to {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">folder</span><span class="p">))</span></div>

<span class="c1">#---------------------------------</span>
    <span class="nd">@QtCore.pyqtSlot</span><span class="p">()</span>
<div class="viewcode-block" id="CORMAT_GUI.dump_kg1"><a class="viewcode-back" href="../Cormat_main.html#Cormat_main.CORMAT_GUI.dump_kg1">[docs]</a>    <span class="k">def</span> <span class="nf">dump_kg1</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        temporary save kg1 data to scratch folder</span>
<span class="sd">        :return:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># logger.info(&#39; dumping KG1 data&#39;)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">save_kg1</span><span class="p">(</span><span class="s1">&#39;scratch&#39;</span><span class="p">)</span>
        <span class="c1"># logger.info(&#39; KG1 data dumped to scratch&#39;)</span>
        <span class="c1"># if workspace is saved then delete data point collected (so no need to undo)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setcoord</span><span class="p">(</span><span class="n">reset</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">chan</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">)</span></div>


<span class="c1">#----------------------------</span>

    <span class="nd">@QtCore.pyqtSlot</span><span class="p">()</span>
<div class="viewcode-block" id="CORMAT_GUI.handle_no"><a class="viewcode-back" href="../Cormat_main.html#Cormat_main.CORMAT_GUI.handle_no">[docs]</a>    <span class="k">def</span> <span class="nf">handle_no</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        functions that ask to confirm if user wants NOT to proceed</span>

<span class="sd">        to set read data for selected pulse</span>
<span class="sd">    &quot;&quot;&quot;</span>

        <span class="c1"># button_name = button.objectName()</span>
        <span class="c1"># print(button_name)</span>


        <span class="n">logger</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;pressed </span><span class="si">%s</span><span class="s1"> button&#39;</span><span class="p">,</span>
                      <span class="bp">self</span><span class="o">.</span><span class="n">ui_areyousure</span><span class="o">.</span><span class="n">pushButton_NO</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;go back and perform a different action&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">ui_areyousure</span><span class="o">.</span><span class="n">pushButton_NO</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">areyousure_window</span><span class="o">.</span><span class="n">hide</span><span class="p">()</span></div>

    <span class="c1"># ----------------------------</span>
    <span class="nd">@QtCore.pyqtSlot</span><span class="p">()</span>
<div class="viewcode-block" id="CORMAT_GUI.handle_yes"><a class="viewcode-back" href="../Cormat_main.html#Cormat_main.CORMAT_GUI.handle_yes">[docs]</a>    <span class="k">def</span> <span class="nf">handle_yes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        functions that ask to confirm if user wants to proceed</span>

<span class="sd">        to set read data for selected pulse</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># button_name = button.text()</span>
        <span class="c1"># print(button_name)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">ui_areyousure</span><span class="o">.</span><span class="n">pushButton_YES</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">areyousure_window</span><span class="o">.</span><span class="n">hide</span><span class="p">()</span>


        <span class="n">logger</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;pressed </span><span class="si">%s</span><span class="s1"> button&#39;</span><span class="p">,</span>
                      <span class="bp">self</span><span class="o">.</span><span class="n">ui_areyousure</span><span class="o">.</span><span class="n">pushButton_YES</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">read_uid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_readuid</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Reading data for pulse {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">pulse</span><span class="p">)))</span>
        <span class="n">success</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">readdata</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">success</span><span class="p">:</span>
            <span class="c1"># status flag groupbox is disabled</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">groupBox_statusflag</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">checkSFbutton</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_markers</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
            <span class="c1"># disable &quot;normalize&quot; and &quot;restore&quot; buttons</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">button_normalize</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">button_restore</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_2ndtrace</span><span class="o">.</span><span class="n">setCurrentIndex</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_markers</span><span class="o">.</span><span class="n">setCurrentIndex</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>


            <span class="bp">self</span><span class="o">.</span><span class="n">plot_data</span><span class="p">()</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">GUI_refresh</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="s2">&quot;CORMAT_py - {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">pulse</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">old_pulse</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">pulse</span>

            <span class="c1"># now set</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="s2">&quot; {} - saved is {} - data changed is {} - status flags changed is {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">myself</span><span class="p">(),</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">saved</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">data_changed</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">statusflag_changed</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;ERROR reading data&quot;</span><span class="p">)</span></div>

    <span class="c1"># -----------------------</span>

<div class="viewcode-block" id="CORMAT_GUI.handle_yes_reload"><a class="viewcode-back" href="../Cormat_main.html#Cormat_main.CORMAT_GUI.handle_yes_reload">[docs]</a>    <span class="k">def</span> <span class="nf">handle_yes_reload</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        module that handles readloading already downloaded data</span>
<span class="sd">        :return:</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39; pulse data already downloaded&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">load_pickle</span><span class="p">()</span>

        <span class="c1"># self.tabWidget.setCurrentIndex(0)</span>
        <span class="c1"># self.tabSelected(arg=0)</span>

        <span class="c1"># -------------------------------</span>
        <span class="c1"># PLOT KG1 self.data.</span>
        <span class="c1"># -------------------------------</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">plot_data</span><span class="p">()</span>

        <span class="c1"># -------------------------------</span>
        <span class="c1"># update GUI after plot</span>
        <span class="c1"># -------------------------------</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">GUI_refresh</span><span class="p">()</span>
        <span class="c1">#</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">old_pulse</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">pulse</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;old pulse is {}, new pulse is {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">old_pulse</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">pulse</span><span class="p">))</span>
        <span class="c1"># now set</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">saved</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">statusflag_changed</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">data_changed</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gettotalcorrections</span><span class="p">()</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;data saved is {} - status flag saved is - data changed is {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">saved</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">statusflag_changed</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">data_changed</span><span class="p">))</span></div>
<span class="c1">#-------------------------</span>

<span class="c1"># -------------------------------</span>
<div class="viewcode-block" id="CORMAT_GUI.readdata"><a class="viewcode-back" href="../Cormat_main.html#Cormat_main.CORMAT_GUI.readdata">[docs]</a>    <span class="k">def</span> <span class="nf">readdata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        function that reads data as described in const.ini</span>
<span class="sd">        :return: True if success</span>
<span class="sd">                False if error</span>
<span class="sd">                saves data to pickle files: one just for KG1 (kg1_data) and one for everything else (data.pkl)</span>
<span class="sd">        &quot;&quot;&quot;</span>


        <span class="c1"># -------------------------------</span>
        <span class="c1"># 1. Read in Magnetics data</span>
        <span class="c1"># -------------------------------</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;             Reading in magnetics data.&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">MAG_data</span> <span class="o">=</span> <span class="n">MagData</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">constants</span><span class="p">)</span>
        <span class="n">success</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">MAG_data</span><span class="o">.</span><span class="n">read_data</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">pulse</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">success</span><span class="p">:</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
                <span class="s1">&#39;no MAG data for pulse {} with uid {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">pulse</span><span class="p">,</span>
                                                               <span class="bp">self</span><span class="o">.</span><span class="n">read_uid</span><span class="p">))</span>


        <span class="c1"># -------------------------------</span>
        <span class="c1"># 2. Read in KG1 data</span>
        <span class="c1"># -------------------------------</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;             Reading in KG1 data.&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span> <span class="o">=</span> <span class="n">Kg1PPFData</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">constants</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">pulse</span><span class="p">)</span>


        <span class="bp">self</span><span class="o">.</span><span class="n">read_uid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_readuid</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span>
        <span class="n">success</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">read_data</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">pulse</span><span class="p">,</span> <span class="n">read_uid</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">read_uid</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="n">success</span><span class="p">)</span>
        <span class="c1"># Exit if there were no good signals</span>
        <span class="c1"># If success == 1 it means that at least one channel was not available. But this shouldn&#39;t stop the rest of the code</span>
        <span class="c1"># from running.</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">success</span><span class="p">:</span>
            <span class="c1"># success = 11: Validated PPF data is already available for all channels</span>
            <span class="c1"># success = 8: No good JPF data was found</span>
            <span class="c1"># success = 9: JPF data was bad</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
                <span class="s1">&#39;no KG1V data for pulse {} with uid {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">pulse</span><span class="p">,</span>
                                                               <span class="bp">self</span><span class="o">.</span><span class="n">read_uid</span><span class="p">))</span>
            <span class="k">return</span> <span class="bp">False</span>
            <span class="c1"># -------------------------------</span>
        <span class="c1"># -------------------------------</span>
        <span class="c1"># 4. Read in KG4 data</span>
        <span class="c1"># -------------------------------</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;             Reading in KG4 data.&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG4_data</span> <span class="o">=</span> <span class="n">Kg4Data</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">constants</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG4_data</span><span class="o">.</span><span class="n">read_data</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">MAG_data</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">pulse</span><span class="p">)</span>

        <span class="c1"># -------------------------------</span>
        <span class="c1"># 5. Read in pellet signals</span>
        <span class="c1"># -------------------------------</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;             Reading in pellet data.&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">PELLETS_data</span> <span class="o">=</span> <span class="n">PelletData</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">constants</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">PELLETS_data</span><span class="o">.</span><span class="n">read_data</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">pulse</span><span class="p">)</span>

        <span class="c1"># -------------------------------</span>
        <span class="c1"># 6. Read in NBI self.data.</span>
        <span class="c1"># -------------------------------</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;             Reading in NBI data.&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">NBI_data</span> <span class="o">=</span> <span class="n">NBIData</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">constants</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">NBI_data</span><span class="o">.</span><span class="n">read_data</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">pulse</span><span class="p">)</span>

        <span class="c1"># -------------------------------</span>
        <span class="c1"># 7. Check for a disruption, and set status flag near the disruption to 4</span>
        <span class="c1">#    If there was no disruption then dis_time elements are set to -1.</span>
        <span class="c1">#    dis_time is a 2 element list, being the window around the disruption.</span>
        <span class="c1">#    Within this time window the code will not make corrections.</span>
        <span class="c1"># -------------------------------</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;             Find disruption.&quot;</span><span class="p">)</span>
        <span class="n">is_dis</span><span class="p">,</span> <span class="n">dis_time</span> <span class="o">=</span> <span class="n">find_disruption</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">pulse</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">constants</span><span class="p">,</span>
                                           <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">is_dis</span> <span class="o">=</span> <span class="n">is_dis</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">dis_time</span> <span class="o">=</span> <span class="n">dis_time</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Time of disruption {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">dis_time</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>



        <span class="c1"># -------------------------------</span>
        <span class="c1"># 8. Read in Be-II signals, and find ELMs</span>
        <span class="c1"># -------------------------------</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;             Reading in ELMs data.&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">ELM_data</span> <span class="o">=</span> <span class="n">ElmsData</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">constants</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">pulse</span><span class="p">,</span> <span class="n">dis_time</span><span class="o">=</span><span class="n">dis_time</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

        <span class="c1"># -------------------------------</span>
        <span class="c1"># 9. Read HRTS data</span>
        <span class="c1"># # -------------------------------</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;             Reading in HRTS data.&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">HRTS_data</span> <span class="o">=</span> <span class="n">HRTSData</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">constants</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">HRTS_data</span><span class="o">.</span><span class="n">read_data</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">pulse</span><span class="p">)</span>

        <span class="c1"># # # # -------------------------------</span>
        <span class="c1"># # # 10. Read LIDAR data</span>
        <span class="c1"># # # -------------------------------</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;             Reading in LIDAR data.&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">LIDAR_data</span> <span class="o">=</span> <span class="n">LIDARData</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">constants</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">LIDAR_data</span><span class="o">.</span><span class="n">read_data</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">pulse</span><span class="p">)</span>


        <span class="c1"># read status flag</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">SF_list</span> <span class="o">=</span> <span class="n">check_SF</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">read_uid</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">pulse</span><span class="p">)</span>

        <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">SF_ch1</span><span class="p">,</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">SF_ch2</span><span class="p">,</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">SF_ch3</span><span class="p">,</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">SF_ch4</span><span class="p">,</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">SF_ch5</span><span class="p">,</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">SF_ch6</span><span class="p">,</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">SF_ch7</span><span class="p">,</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">SF_ch8</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">SF_list</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">SF_old1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">SF_ch1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">SF_old2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">SF_ch2</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">SF_old3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">SF_ch3</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">SF_old4</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">SF_ch4</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">SF_old5</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">SF_ch5</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">SF_old6</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">SF_ch6</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">SF_old7</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">SF_ch7</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">SF_old8</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">SF_ch8</span>


        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">unval_seq</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">val_seq</span> <span class="o">=</span> <span class="n">get_min_max_seq</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">pulse</span><span class="p">,</span> <span class="n">dda</span><span class="o">=</span><span class="s2">&quot;KG1V&quot;</span><span class="p">,</span>
                                                       <span class="n">read_uid</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">read_uid</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_uid</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;jetppf&#39;</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
                <span class="s1">&#39;{} last public validated seq is {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">pulse</span><span class="p">),</span>
                                                            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">val_seq</span><span class="p">)))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
                <span class="s1">&#39;{} last private validated seq is {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">pulse</span><span class="p">),</span>
                                                             <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">val_seq</span><span class="p">)))</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;userid is {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">read_uid</span><span class="p">))</span>


        <span class="c1"># logger.info(&#39;unval_seq {}, val_seq {}&#39;.format(str(self.data.unval_seq),str(self.data.val_seq)))</span>
        <span class="c1"># save data to pickle into saved folder</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">save_to_pickle</span><span class="p">(</span><span class="s1">&#39;saved&#39;</span><span class="p">)</span>
        <span class="c1"># save data to pickle into scratch folder</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">save_to_pickle</span><span class="p">(</span><span class="s1">&#39;scratch&#39;</span><span class="p">)</span>
        <span class="c1"># save KG1 data on different file (needed later when applying corrections)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">save_kg1</span><span class="p">(</span><span class="s1">&#39;saved&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">save_kg1</span><span class="p">(</span><span class="s1">&#39;scratch&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">saved</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">data_changed</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">statusflag_changed</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="c1"># dump KG1 data on different file (used to autosave later when applying corrections)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dump_kg1</span>


        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">mode</span> <span class="o">!=</span> <span class="s2">&quot;Automatic Corrections&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">correctedby</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">mode</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)[</span><span class="mi">2</span><span class="p">]</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;{} last validated seq is {} by {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">pulse</span><span class="p">),</span>
                                                                    <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">val_seq</span><span class="p">),</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">correctedby</span><span class="p">))</span>

        <span class="k">for</span> <span class="n">chan</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">density</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="s1">&#39;enabling channel {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">chan</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tabWidget</span><span class="o">.</span><span class="n">setTabEnabled</span><span class="p">(</span><span class="n">chan</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;enabling tab {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tabWidget</span><span class="o">.</span><span class="n">setTabEnabled</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;enabling tab {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tabWidget</span><span class="o">.</span><span class="n">setTabEnabled</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;enabling tab {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="mi">11</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tabWidget</span><span class="o">.</span><span class="n">setTabEnabled</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;enabling tab {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="mi">12</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tabWidget</span><span class="o">.</span><span class="n">setTabEnabled</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>


        <span class="k">return</span> <span class="bp">True</span></div>

<span class="c1"># -----------------------</span>

<span class="c1"># -------------------------------</span>
<div class="viewcode-block" id="CORMAT_GUI.plot_data"><a class="viewcode-back" href="../Cormat_main.html#Cormat_main.CORMAT_GUI.plot_data">[docs]</a>    <span class="k">def</span> <span class="nf">plot_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        handles widgets</span>
<span class="sd">        initialises canvas to blank</span>
<span class="sd">        sets grid and axes</span>
<span class="sd">        plots KG1 data</span>

<span class="sd">        :return:</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># -------------------------------</span>
        <span class="c1"># PLOT KG1 self.data.</span>
        <span class="c1"># -------------------------------</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID1</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID1</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID2</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID2</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID3</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID3</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID4</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID4</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID5</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID5</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID6</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID6</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID7</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID7</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID8</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID8</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID_14</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID_14</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID_58</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID_58</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID_ALL</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID_ALL</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">widget_MIR</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">widget_MIR</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>

        <span class="c1"># define now two gridspecs</span>
        <span class="c1"># gs is the gridspec per channels 1-4</span>
        <span class="c1"># gs1 is the gridspec for channels 5-8</span>
        <span class="c1"># when plotting markers they will allocate space to plot markers in a subplot under current plot</span>

        <span class="c1"># gs = gridspec.GridSpec(2, 1, height_ratios=[3, 1])# working: creates canvas with 2 columns in the ratio 1/3</span>

        <span class="n">heights</span> <span class="o">=</span> <span class="p">[</span><span class="mi">4</span><span class="p">]</span>
        <span class="n">gs</span> <span class="o">=</span> <span class="n">gridspec</span><span class="o">.</span><span class="n">GridSpec</span><span class="p">(</span><span class="n">ncols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">height_ratios</span><span class="o">=</span><span class="n">heights</span><span class="p">)</span>
        <span class="n">heights1</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
        <span class="n">gs1</span> <span class="o">=</span> <span class="n">gridspec</span><span class="o">.</span><span class="n">GridSpec</span><span class="p">(</span><span class="n">ncols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">nrows</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">height_ratios</span><span class="o">=</span><span class="n">heights1</span><span class="p">)</span>

        <span class="n">ax1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID1</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax1</span><span class="o">=</span><span class="n">ax1</span>

        <span class="n">ax2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID2</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax2</span><span class="o">=</span><span class="n">ax2</span>

        <span class="n">ax3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID3</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax3</span><span class="o">=</span><span class="n">ax3</span>

        <span class="n">ax4</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID4</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax4</span><span class="o">=</span><span class="n">ax4</span>

        <span class="n">ax5</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID5</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs1</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax5</span><span class="o">=</span><span class="n">ax5</span>
        <span class="n">ax51</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID5</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs1</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">sharex</span><span class="o">=</span><span class="n">ax5</span><span class="p">);</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax51</span><span class="o">=</span><span class="n">ax51</span>

        <span class="n">ax6</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID6</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs1</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax6</span><span class="o">=</span><span class="n">ax6</span>
        <span class="n">ax61</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID6</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs1</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">sharex</span><span class="o">=</span><span class="n">ax6</span><span class="p">);</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax61</span><span class="o">=</span><span class="n">ax61</span>

        <span class="n">ax7</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID7</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs1</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax7</span><span class="o">=</span><span class="n">ax7</span>
        <span class="n">ax71</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID7</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs1</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">sharex</span><span class="o">=</span><span class="n">ax7</span><span class="p">);</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax71</span><span class="o">=</span><span class="n">ax71</span>

        <span class="n">ax8</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID8</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs1</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax8</span><span class="o">=</span><span class="n">ax8</span>
        <span class="n">ax81</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID8</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs1</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">sharex</span><span class="o">=</span><span class="n">ax8</span><span class="p">);</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax81</span><span class="o">=</span><span class="n">ax81</span>

        <span class="n">ax_all</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID_ALL</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax_all</span><span class="o">=</span><span class="n">ax_all</span>
        <span class="n">ax_14</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID_14</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax_14</span><span class="o">=</span><span class="n">ax_14</span>
        <span class="n">ax_58</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID_58</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax_58</span><span class="o">=</span><span class="n">ax_58</span>

        <span class="n">ax_mir</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">widget_MIR</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax_mir</span><span class="o">=</span><span class="n">ax_mir</span>

        <span class="k">for</span> <span class="n">chan</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">density</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">ax_name</span> <span class="o">=</span> <span class="s1">&#39;ax&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">chan</span><span class="p">)</span>
            <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;LID&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">chan</span><span class="p">)</span>
            <span class="n">widget_name</span> <span class="o">=</span> <span class="s1">&#39;widget_LID&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">chan</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">kg1_norm</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span> <span class="o">=</span> <span class="n">SignalBase</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">constants</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">kg1_norm</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">norm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">density</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>

            <span class="nb">vars</span><span class="p">()[</span><span class="n">ax_name</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">density</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">time</span><span class="p">,</span>
                                 <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">density</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
                                 <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;None&#39;</span><span class="p">)</span>

            <span class="nb">vars</span><span class="p">()[</span><span class="n">ax_name</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

            <span class="n">ax_all</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">density</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">time</span><span class="p">,</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">density</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
                        <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;None&#39;</span><span class="p">)</span>
            <span class="n">ax_all</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">chan</span> <span class="o">&lt;</span> <span class="mi">5</span><span class="p">:</span>
                <span class="n">ax_14</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">density</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">time</span><span class="p">,</span>
                           <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">density</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
                           <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;None&#39;</span><span class="p">)</span>
                <span class="n">ax_14</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

            <span class="k">if</span> <span class="n">chan</span> <span class="o">&gt;</span> <span class="mi">4</span><span class="p">:</span>
                <span class="n">ax_58</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">density</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">time</span><span class="p">,</span>
                           <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">density</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
                           <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;None&#39;</span><span class="p">)</span>
                <span class="n">ax_58</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>



            <span class="k">if</span> <span class="n">chan</span> <span class="o">&gt;</span> <span class="mi">4</span><span class="p">:</span>
                <span class="n">name1</span> <span class="o">=</span> <span class="s1">&#39;MIR&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">chan</span><span class="p">)</span>
                <span class="n">name2</span> <span class="o">=</span> <span class="s1">&#39;JxB&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">chan</span><span class="p">)</span>
                <span class="n">ax_name1</span> <span class="o">=</span> <span class="s1">&#39;ax&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">chan</span><span class="p">)</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">widget_name1</span> <span class="o">=</span> <span class="s1">&#39;widget_LID&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">chan</span><span class="p">)</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">axx</span> <span class="o">=</span> <span class="nb">vars</span><span class="p">()[</span><span class="n">ax_name1</span><span class="p">]</span>
                <span class="nb">vars</span><span class="p">()[</span><span class="n">ax_name1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">vibration</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">time</span><span class="p">,</span>
                                      <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">vibration</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">data</span> <span class="o">*</span> <span class="mf">1e6</span><span class="p">,</span>
                                      <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">name1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span>
                                      <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;None&#39;</span><span class="p">)</span>
                <span class="nb">vars</span><span class="p">()[</span><span class="n">ax_name1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">jxb</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">time</span><span class="p">,</span>
                                      <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">jxb</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">data</span> <span class="o">*</span> <span class="mf">1e6</span><span class="p">,</span>
                                      <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">name2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;c&#39;</span><span class="p">,</span>
                                      <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;None&#39;</span><span class="p">)</span>
                <span class="nb">vars</span><span class="p">()[</span><span class="n">ax_name1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

                <span class="n">ax_mir</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">vibration</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">time</span><span class="p">,</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">vibration</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">data</span> <span class="o">*</span> <span class="mf">1e6</span><span class="p">,</span>
                            <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">name1</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;None&#39;</span><span class="p">)</span>
                <span class="n">ax_mir</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
                <span class="c1"># draw_widget(chan)</span>

        <span class="k">for</span> <span class="n">chan</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">fj_dcn</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">chan</span> <span class="o">&lt;</span> <span class="mi">9</span><span class="p">:</span>
                <span class="n">ax_name</span> <span class="o">=</span> <span class="s1">&#39;ax&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">chan</span><span class="p">)</span>
                <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;LID&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">chan</span><span class="p">)</span>
                <span class="n">widget_name</span> <span class="o">=</span> <span class="s1">&#39;widget_LID&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">chan</span><span class="p">)</span>
                <span class="n">xposition</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">fj_dcn</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">time</span>
                <span class="k">for</span> <span class="n">xc</span> <span class="ow">in</span> <span class="n">xposition</span><span class="p">:</span>
                    <span class="nb">vars</span><span class="p">()[</span><span class="n">ax_name</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">xc</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ax_name</span> <span class="o">=</span> <span class="s1">&#39;ax&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">chan</span> <span class="o">-</span> <span class="mi">4</span><span class="p">)</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;LID&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">chan</span><span class="o">-</span><span class="mi">4</span><span class="p">)</span>
                <span class="n">widget_name</span> <span class="o">=</span> <span class="s1">&#39;widget_LID&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">chan</span><span class="p">)</span>
                <span class="n">xposition</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">fj_dcn</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">time</span>
                <span class="k">for</span> <span class="n">xc</span> <span class="ow">in</span> <span class="n">xposition</span><span class="p">:</span>
                    <span class="nb">vars</span><span class="p">()[</span><span class="n">ax_name</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">xc</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">chan</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">fj_met</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="n">ax_name</span> <span class="o">=</span> <span class="s1">&#39;ax&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">chan</span><span class="p">)</span>
                <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;LID&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">chan</span><span class="p">)</span>
                <span class="n">widget_name</span> <span class="o">=</span> <span class="s1">&#39;widget_LID&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">chan</span><span class="p">)</span>
                <span class="n">xposition</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">fj_met</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">time</span>
                <span class="k">for</span> <span class="n">xc</span> <span class="ow">in</span> <span class="n">xposition</span><span class="p">:</span>
                    <span class="nb">vars</span><span class="p">()[</span><span class="n">ax_name</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">xc</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>


        <span class="c1"># update canvas</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID1</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID2</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID3</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID4</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID5</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID6</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID7</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID8</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID_14</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID_ALL</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID_58</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">widget_MIR</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span></div>



    <span class="c1"># -----------------------</span>
<div class="viewcode-block" id="CORMAT_GUI.GUI_refresh"><a class="viewcode-back" href="../Cormat_main.html#Cormat_main.CORMAT_GUI.GUI_refresh">[docs]</a>    <span class="k">def</span> <span class="nf">GUI_refresh</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        updates GUI after reading data</span>
<span class="sd">        enables/disables buttons</span>

<span class="sd">        connects tab to tabselected signal</span>

<span class="sd">        finally run a check on status flag applied to selected channel</span>
<span class="sd">        :return:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># now status flag group can be enabled</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">groupBox_statusflag</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>

        <span class="c1"># self.button_plot.setEnabled(True)</span>
        <span class="c1"># self.button_check_pulse.setEnabled(True)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">button_saveppf</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">button_save</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
        <span class="c1"># self.pushButton_apply.setEnabled(False)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pushButton_makeperm</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pushButton_undo</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">checkSFbutton</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_markers</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_2ndtrace</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">tabWidget</span><span class="o">.</span><span class="n">setCurrentIndex</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">canvasselected</span><span class="p">(</span><span class="n">arg</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tabWidget</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tabWidget</span><span class="p">,</span>
                               <span class="n">QtCore</span><span class="o">.</span><span class="n">SIGNAL</span><span class="p">(</span><span class="s2">&quot;currentChanged(int)&quot;</span><span class="p">),</span>
                               <span class="bp">self</span><span class="o">.</span><span class="n">canvasselected</span><span class="p">)</span>


        <span class="c1"># set combobox index to 1 so that the default write_uid is owner</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_writeuid</span><span class="o">.</span><span class="n">setCurrentIndex</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">radioButton_statusflag_0</span><span class="o">.</span><span class="n">toggled</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
            <span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkstate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">radioButton_statusflag_0</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">radioButton_statusflag_1</span><span class="o">.</span><span class="n">toggled</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
            <span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkstate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">radioButton_statusflag_1</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">radioButton_statusflag_2</span><span class="o">.</span><span class="n">toggled</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
            <span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkstate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">radioButton_statusflag_2</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">radioButton_statusflag_3</span><span class="o">.</span><span class="n">toggled</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
            <span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkstate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">radioButton_statusflag_3</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">radioButton_statusflag_4</span><span class="o">.</span><span class="n">toggled</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
            <span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">checkstate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">radioButton_statusflag_4</span><span class="p">))</span></div>

        <span class="c1"># self.tabWidget.removeTab(3)</span>



<span class="c1">#----------------------</span>
<div class="viewcode-block" id="CORMAT_GUI.update_channel"><a class="viewcode-back" href="../Cormat_main.html#Cormat_main.CORMAT_GUI.update_channel">[docs]</a>    <span class="k">def</span> <span class="nf">update_channel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">chan</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        after a correction is applied this module updates kg1 data to new values</span>
<span class="sd">        and replots data on all tabs</span>
<span class="sd">        :param chan:</span>
<span class="sd">        :return:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1">#ax,widget = self.which_tab()</span>
        <span class="k">if</span> <span class="n">chan</span> <span class="o">==</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">ax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax1</span>
            <span class="n">widget</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID1</span>

            <span class="n">ax</span><span class="o">.</span><span class="n">lines</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ydata</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">density</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">lines</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
            <span class="c1"># ax.autoscale(enable=True, axis=&quot;y&quot;, tight=False)</span>
            <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">density</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
            <span class="n">autoscale_data</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span><span class="n">data</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ax_14</span><span class="o">.</span><span class="n">lines</span><span class="p">[</span><span class="n">chan</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ydata</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">density</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ax_all</span><span class="o">.</span><span class="n">lines</span><span class="p">[</span><span class="n">chan</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ydata</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">density</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID_14</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID_14</span><span class="o">.</span><span class="n">flush_events</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID_ALL</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID_ALL</span><span class="o">.</span><span class="n">flush_events</span><span class="p">()</span>
            <span class="n">widget</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
            <span class="n">widget</span><span class="o">.</span><span class="n">flush_events</span><span class="p">()</span>
            <span class="n">widget</span><span class="o">.</span><span class="n">blockSignals</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>

            <span class="c1"># ax.yaxis.set_major_locator(MyLocator())</span>


        <span class="k">elif</span> <span class="n">chan</span> <span class="o">==</span><span class="mi">2</span><span class="p">:</span>
            <span class="n">ax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax2</span>
            <span class="n">widget</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID2</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">lines</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ydata</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">density</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">lines</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
            <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">density</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
            <span class="n">autoscale_data</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span><span class="n">data</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ax_14</span><span class="o">.</span><span class="n">lines</span><span class="p">[</span><span class="n">chan</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ydata</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">density</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ax_all</span><span class="o">.</span><span class="n">lines</span><span class="p">[</span><span class="n">chan</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ydata</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">density</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID_14</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID_14</span><span class="o">.</span><span class="n">flush_events</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID_ALL</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID_ALL</span><span class="o">.</span><span class="n">flush_events</span><span class="p">()</span>
            <span class="n">widget</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
            <span class="n">widget</span><span class="o">.</span><span class="n">flush_events</span><span class="p">()</span>
            <span class="n">widget</span><span class="o">.</span><span class="n">blockSignals</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>


        <span class="k">elif</span> <span class="n">chan</span> <span class="o">==</span><span class="mi">3</span><span class="p">:</span>
            <span class="n">ax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax3</span>
            <span class="n">widget</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID3</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">lines</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ydata</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">density</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">lines</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
            <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">density</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
            <span class="n">autoscale_data</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span><span class="n">data</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ax_14</span><span class="o">.</span><span class="n">lines</span><span class="p">[</span><span class="n">chan</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ydata</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">density</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ax_all</span><span class="o">.</span><span class="n">lines</span><span class="p">[</span><span class="n">chan</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ydata</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">density</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID_14</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID_14</span><span class="o">.</span><span class="n">flush_events</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID_ALL</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID_ALL</span><span class="o">.</span><span class="n">flush_events</span><span class="p">()</span>
            <span class="n">widget</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
            <span class="n">widget</span><span class="o">.</span><span class="n">flush_events</span><span class="p">()</span>
            <span class="n">widget</span><span class="o">.</span><span class="n">blockSignals</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>

        <span class="k">elif</span> <span class="n">chan</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
            <span class="n">ax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax4</span>
            <span class="n">widget</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID4</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">lines</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ydata</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">density</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">lines</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
            <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">density</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
            <span class="n">autoscale_data</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span><span class="n">data</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ax_14</span><span class="o">.</span><span class="n">lines</span><span class="p">[</span><span class="n">chan</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ydata</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">density</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ax_all</span><span class="o">.</span><span class="n">lines</span><span class="p">[</span><span class="n">chan</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ydata</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">density</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID_14</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID_14</span><span class="o">.</span><span class="n">flush_events</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID_ALL</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID_ALL</span><span class="o">.</span><span class="n">flush_events</span><span class="p">()</span>
            <span class="n">widget</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
            <span class="n">widget</span><span class="o">.</span><span class="n">flush_events</span><span class="p">()</span>
            <span class="n">widget</span><span class="o">.</span><span class="n">blockSignals</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>

        <span class="k">elif</span> <span class="n">chan</span> <span class="o">==</span> <span class="mi">5</span><span class="p">:</span>
            <span class="n">ax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax5</span>
            <span class="n">widget</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID5</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">lines</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ydata</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">density</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">lines</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
            <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">density</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
            <span class="n">autoscale_data</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span><span class="n">data</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ax_58</span><span class="o">.</span><span class="n">lines</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ydata</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">density</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ax_all</span><span class="o">.</span><span class="n">lines</span><span class="p">[</span><span class="n">chan</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ydata</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">density</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
            <span class="n">ax1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax51</span>
            <span class="n">ax1</span><span class="o">.</span><span class="n">lines</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ydata</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">vibration</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="o">*</span> <span class="mf">1e6</span><span class="p">)</span>
            <span class="n">autoscale_data</span><span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">vibration</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">data</span> <span class="o">*</span> <span class="mf">1e6</span><span class="p">)</span>
            <span class="n">ax1</span><span class="o">.</span><span class="n">lines</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ax_mir</span><span class="o">.</span><span class="n">lines</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ydata</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">vibration</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="o">*</span> <span class="mf">1e6</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ax_mir</span><span class="o">.</span><span class="n">autoscale</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID_58</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID_58</span><span class="o">.</span><span class="n">flush_events</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">widget_MIR</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">widget_MIR</span><span class="o">.</span><span class="n">flush_events</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID_ALL</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID_ALL</span><span class="o">.</span><span class="n">flush_events</span><span class="p">()</span>
            <span class="n">widget</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
            <span class="n">widget</span><span class="o">.</span><span class="n">flush_events</span><span class="p">()</span>
            <span class="n">widget</span><span class="o">.</span><span class="n">blockSignals</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>

        <span class="k">elif</span> <span class="n">chan</span> <span class="o">==</span> <span class="mi">6</span><span class="p">:</span>
            <span class="n">ax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax6</span>
            <span class="n">widget</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID6</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">lines</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ydata</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">density</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">lines</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
            <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">density</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
            <span class="n">autoscale_data</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span><span class="n">data</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ax_58</span><span class="o">.</span><span class="n">lines</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ydata</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">density</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ax_all</span><span class="o">.</span><span class="n">lines</span><span class="p">[</span><span class="n">chan</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ydata</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">density</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
            <span class="n">ax1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax61</span>
            <span class="n">ax1</span><span class="o">.</span><span class="n">lines</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ydata</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">vibration</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="o">*</span> <span class="mf">1e6</span><span class="p">)</span>
            <span class="n">autoscale_data</span><span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">vibration</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">data</span> <span class="o">*</span> <span class="mf">1e6</span><span class="p">)</span>
            <span class="n">ax1</span><span class="o">.</span><span class="n">lines</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ax_mir</span><span class="o">.</span><span class="n">lines</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ydata</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">vibration</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="o">*</span> <span class="mf">1e6</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID_58</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID_58</span><span class="o">.</span><span class="n">flush_events</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">widget_MIR</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">widget_MIR</span><span class="o">.</span><span class="n">flush_events</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID_ALL</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID_ALL</span><span class="o">.</span><span class="n">flush_events</span><span class="p">()</span>
            <span class="n">widget</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
            <span class="n">widget</span><span class="o">.</span><span class="n">flush_events</span><span class="p">()</span>
            <span class="n">widget</span><span class="o">.</span><span class="n">blockSignals</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>

        <span class="k">elif</span> <span class="n">chan</span> <span class="o">==</span> <span class="mi">7</span><span class="p">:</span>
            <span class="n">ax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax7</span>
            <span class="n">widget</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID7</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">lines</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ydata</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">density</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">lines</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
            <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">density</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
            <span class="n">autoscale_data</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span><span class="n">data</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ax_58</span><span class="o">.</span><span class="n">lines</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_ydata</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">density</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ax_all</span><span class="o">.</span><span class="n">lines</span><span class="p">[</span><span class="n">chan</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ydata</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">density</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
            <span class="n">ax1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax71</span>
            <span class="n">ax1</span><span class="o">.</span><span class="n">lines</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ydata</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">vibration</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="o">*</span> <span class="mf">1e6</span><span class="p">)</span>
            <span class="n">autoscale_data</span><span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">vibration</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">data</span> <span class="o">*</span> <span class="mf">1e6</span><span class="p">)</span>
            <span class="n">ax1</span><span class="o">.</span><span class="n">lines</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ax_mir</span><span class="o">.</span><span class="n">lines</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_ydata</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">vibration</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="o">*</span> <span class="mf">1e6</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID_58</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID_58</span><span class="o">.</span><span class="n">flush_events</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">widget_MIR</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">widget_MIR</span><span class="o">.</span><span class="n">flush_events</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID_ALL</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID_ALL</span><span class="o">.</span><span class="n">flush_events</span><span class="p">()</span>
            <span class="n">widget</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
            <span class="n">widget</span><span class="o">.</span><span class="n">flush_events</span><span class="p">()</span>
            <span class="n">widget</span><span class="o">.</span><span class="n">blockSignals</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>

        <span class="k">elif</span> <span class="n">chan</span> <span class="o">==</span> <span class="mi">8</span><span class="p">:</span>
            <span class="n">ax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax8</span>
            <span class="n">widget</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID8</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">lines</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ydata</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">density</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">lines</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
            <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">density</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
            <span class="n">autoscale_data</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span><span class="n">data</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ax_58</span><span class="o">.</span><span class="n">lines</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">set_ydata</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">density</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ax_all</span><span class="o">.</span><span class="n">lines</span><span class="p">[</span><span class="n">chan</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ydata</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">density</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
            <span class="n">ax1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax81</span>
            <span class="n">ax1</span><span class="o">.</span><span class="n">lines</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ydata</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">vibration</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="o">*</span> <span class="mf">1e6</span><span class="p">)</span>
            <span class="n">autoscale_data</span><span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">vibration</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="o">*</span> <span class="mf">1e6</span><span class="p">)</span>
            <span class="n">ax1</span><span class="o">.</span><span class="n">lines</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ax_mir</span><span class="o">.</span><span class="n">lines</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">set_ydata</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">vibration</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="o">*</span> <span class="mf">1e6</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID_58</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID_58</span><span class="o">.</span><span class="n">flush_events</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">widget_MIR</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">widget_MIR</span><span class="o">.</span><span class="n">flush_events</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID_ALL</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID_ALL</span><span class="o">.</span><span class="n">flush_events</span><span class="p">()</span>
            <span class="n">widget</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
            <span class="n">widget</span><span class="o">.</span><span class="n">flush_events</span><span class="p">()</span>
            <span class="n">widget</span><span class="o">.</span><span class="n">blockSignals</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="s1">&#39; updated channhel {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">chan</span><span class="p">))</span></div>




<div class="viewcode-block" id="CORMAT_GUI.set_xlimits"><a class="viewcode-back" href="../Cormat_main.html#Cormat_main.CORMAT_GUI.set_xlimits">[docs]</a>    <span class="k">def</span> <span class="nf">set_xlimits</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lower</span><span class="p">,</span> <span class="n">upper</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Convenience method to canvas.axes.set_xlim</span>
<span class="sd">        as matplotlib autoupdate is bugged</span>

<span class="sd">        :param lower: lower limit of data</span>
<span class="sd">        :param upper: upper limit of data</span>
<span class="sd">        :return:</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">lower</span><span class="p">,</span> <span class="n">upper</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span></div>



<span class="c1"># ------------------------</span>
    <span class="nd">@QtCore.pyqtSlot</span><span class="p">()</span>
<div class="viewcode-block" id="CORMAT_GUI.plot_2nd_trace"><a class="viewcode-back" href="../Cormat_main.html#Cormat_main.CORMAT_GUI.plot_2nd_trace">[docs]</a>    <span class="k">def</span> <span class="nf">plot_2nd_trace</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        function that plots a second trace in the tabs(each canvas)</span>
<span class="sd">        at the moment clears the canvas and re-plot everything</span>
<span class="sd">        so probably a little slow.</span>

<span class="sd">        :return:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># self.data.s2ndtrace = self.comboBox_2ndtrace.itemText(i)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_markers</span><span class="o">.</span><span class="n">setCurrentIndex</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">secondtrace_original</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">secondtrace_norm</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">s2ndtrace</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_2ndtrace</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span>

        <span class="c1"># initialize and clean canvas</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID1</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID1</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID2</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID2</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID3</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID3</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID4</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID4</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID5</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID5</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID6</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID6</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID7</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID7</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID8</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID8</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>

        <span class="c1"># self.widget_LID_14.figure.clear()</span>
        <span class="c1"># self.widget_LID_14.draw()</span>
        <span class="c1">#</span>
        <span class="c1"># self.widget_LID_58.figure.clear()</span>
        <span class="c1"># self.widget_LID_58.draw()</span>
        <span class="c1">#</span>
        <span class="c1"># self.widget_LID_ALL.figure.clear()</span>
        <span class="c1"># self.widget_LID_ALL.draw()</span>

        <span class="c1"># self.widget_MIR.figure.clear()</span>
        <span class="c1"># self.widget_MIR.draw()</span>

        <span class="n">heights</span> <span class="o">=</span> <span class="p">[</span><span class="mi">4</span><span class="p">]</span>
        <span class="n">gs</span> <span class="o">=</span> <span class="n">gridspec</span><span class="o">.</span><span class="n">GridSpec</span><span class="p">(</span><span class="n">ncols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">height_ratios</span><span class="o">=</span><span class="n">heights</span><span class="p">)</span>
        <span class="n">heights1</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
        <span class="n">gs1</span> <span class="o">=</span> <span class="n">gridspec</span><span class="o">.</span><span class="n">GridSpec</span><span class="p">(</span><span class="n">ncols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">nrows</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">height_ratios</span><span class="o">=</span><span class="n">heights1</span><span class="p">)</span>

        <span class="n">ax1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID1</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax1</span><span class="o">=</span><span class="n">ax1</span>

        <span class="n">ax2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID2</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax2</span><span class="o">=</span><span class="n">ax2</span>

        <span class="n">ax3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID3</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax3</span><span class="o">=</span><span class="n">ax3</span>

        <span class="n">ax4</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID4</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax4</span><span class="o">=</span><span class="n">ax4</span>

        <span class="n">ax5</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID5</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs1</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax5</span><span class="o">=</span><span class="n">ax5</span>
        <span class="n">ax51</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID5</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs1</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">sharex</span><span class="o">=</span><span class="n">ax5</span><span class="p">);</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax51</span><span class="o">=</span><span class="n">ax51</span>

        <span class="n">ax6</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID6</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs1</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax6</span><span class="o">=</span><span class="n">ax6</span>
        <span class="n">ax61</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID6</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs1</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">sharex</span><span class="o">=</span><span class="n">ax6</span><span class="p">);</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax61</span><span class="o">=</span><span class="n">ax61</span>

        <span class="n">ax7</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID7</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs1</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax7</span><span class="o">=</span><span class="n">ax7</span>
        <span class="n">ax71</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID7</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs1</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">sharex</span><span class="o">=</span><span class="n">ax7</span><span class="p">);</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax71</span><span class="o">=</span><span class="n">ax71</span>

        <span class="n">ax8</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID8</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs1</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax8</span><span class="o">=</span><span class="n">ax8</span>
        <span class="n">ax81</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID8</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs1</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">sharex</span><span class="o">=</span><span class="n">ax8</span><span class="p">);</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax81</span><span class="o">=</span><span class="n">ax81</span>

        <span class="c1"># for every channel in KG1 (8 channels)</span>
        <span class="k">for</span> <span class="n">chan</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">density</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">ax_name</span> <span class="o">=</span> <span class="s1">&#39;ax&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">chan</span><span class="p">)</span>
            <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;LID&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">chan</span><span class="p">)</span>

            <span class="nb">vars</span><span class="p">()[</span><span class="n">ax_name</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">density</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">time</span><span class="p">,</span>
                                 <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">density</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">,</span>
                                 <span class="n">label</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span>
                                 <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;None&#39;</span><span class="p">)</span>
            <span class="nb">vars</span><span class="p">()[</span><span class="n">ax_name</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
            <span class="c1"># self.widget_LID1.draw()</span>

            <span class="k">if</span> <span class="n">chan</span> <span class="o">&gt;</span> <span class="mi">4</span><span class="p">:</span>
                <span class="n">name1</span> <span class="o">=</span> <span class="s1">&#39;MIR&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">chan</span><span class="p">)</span>
                <span class="n">name2</span> <span class="o">=</span> <span class="s1">&#39;JxB&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">chan</span><span class="p">)</span>
                <span class="n">ax_name1</span> <span class="o">=</span> <span class="s1">&#39;ax&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">chan</span><span class="p">)</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
                <span class="nb">vars</span><span class="p">()[</span><span class="n">ax_name1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">vibration</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">time</span><span class="p">,</span>
                                      <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">vibration</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">data</span> <span class="o">*</span> <span class="mf">1e6</span><span class="p">,</span>
                                      <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">name1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span>
                                      <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;None&#39;</span><span class="p">)</span>
                <span class="nb">vars</span><span class="p">()[</span><span class="n">ax_name1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">jxb</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">time</span><span class="p">,</span>
                                      <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">jxb</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">data</span> <span class="o">*</span> <span class="mf">1e6</span><span class="p">,</span>
                                      <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">name2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;c&#39;</span><span class="p">,</span>
                                      <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;None&#39;</span><span class="p">)</span>
                <span class="nb">vars</span><span class="p">()[</span><span class="n">ax_name1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>



        <span class="k">for</span> <span class="n">chan</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">fj_dcn</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">chan</span> <span class="o">&gt;</span><span class="mi">9</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ax_name</span> <span class="o">=</span> <span class="s1">&#39;ax&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">chan</span><span class="p">)</span>
                <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;LID&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">chan</span><span class="p">)</span>
                <span class="n">widget_name</span> <span class="o">=</span> <span class="s1">&#39;widget_LID&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">chan</span><span class="p">)</span>
                <span class="n">xposition</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">fj_dcn</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">time</span>
                <span class="k">for</span> <span class="n">xc</span> <span class="ow">in</span> <span class="n">xposition</span><span class="p">:</span>
                    <span class="nb">vars</span><span class="p">()[</span><span class="n">ax_name</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">xc</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">chan</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">fj_met</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">chan</span> <span class="o">&gt;</span><span class="mi">9</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ax_name</span> <span class="o">=</span> <span class="s1">&#39;ax&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">chan</span><span class="p">)</span>
                <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;LID&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">chan</span><span class="p">)</span>
                <span class="n">widget_name</span> <span class="o">=</span> <span class="s1">&#39;widget_LID&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">chan</span><span class="p">)</span>
                <span class="n">xposition</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">fjmet</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">time</span>
                <span class="k">for</span> <span class="n">xc</span> <span class="ow">in</span> <span class="n">xposition</span><span class="p">:</span>
                    <span class="nb">vars</span><span class="p">()[</span><span class="n">ax_name</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">xc</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>


        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;plotting second trace {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">s2ndtrace</span><span class="p">))</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">s2ndtrace</span> <span class="o">==</span> <span class="s1">&#39;None&#39;</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;no second trace selected&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">s2ndtrace</span> <span class="o">==</span> <span class="s1">&#39;HRTS&#39;</span><span class="p">:</span>
            <span class="c1"># check HRTS data exist</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">HRTS_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                <span class="c1"># if len(self.data.HRTS_data.density[chan].time) == 0:</span>
                <span class="c1">#     logger.info(&#39;NO HRTS data&#39;)</span>
                <span class="c1"># else:</span>
                <span class="k">for</span> <span class="n">chan</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">HRTS_data</span><span class="o">.</span><span class="n">density</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                    <span class="k">if</span> <span class="n">chan</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">density</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                        <span class="n">ax_name</span> <span class="o">=</span> <span class="s1">&#39;ax&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">chan</span><span class="p">)</span>
                        <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;HRTS ch.&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">chan</span><span class="p">)</span>
                        <span class="c1"># noinspection PyUnusedLocal</span>
                        <span class="n">widget_name</span> <span class="o">=</span> <span class="s1">&#39;widget_LID&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">chan</span><span class="p">)</span>

                        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">secondtrace_original</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span> <span class="o">=</span> <span class="n">SignalBase</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">constants</span><span class="p">)</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">secondtrace_norm</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span> <span class="o">=</span> <span class="n">SignalBase</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">constants</span><span class="p">)</span>

                        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">secondtrace_original</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">time</span> <span class="o">=</span> \
                            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">HRTS_data</span><span class="o">.</span><span class="n">density</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">time</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">secondtrace_original</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> \
                            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">HRTS_data</span><span class="o">.</span><span class="n">density</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
                        <span class="c1"># self.data.secondtrace_norm[chan].data = norm(self.data.HRTS_data.density[chan].data)</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">secondtrace_norm</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">normalise</span><span class="p">(</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">HRTS_data</span><span class="o">.</span><span class="n">density</span><span class="p">[</span><span class="n">chan</span><span class="p">],</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">density</span><span class="p">[</span><span class="n">chan</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">dis_time</span><span class="p">)</span>

                        <span class="nb">vars</span><span class="p">()[</span><span class="n">ax_name</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">HRTS_data</span><span class="o">.</span><span class="n">density</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">time</span><span class="p">,</span>
                                             <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">HRTS_data</span><span class="o">.</span><span class="n">density</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">,</span>
                                             <span class="n">label</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span>
                                             <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">)</span>
                        <span class="nb">vars</span><span class="p">()[</span><span class="n">ax_name</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s1">&#39;no {} data&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">s2ndtrace</span><span class="p">))</span>


        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">s2ndtrace</span> <span class="o">==</span> <span class="s1">&#39;Lidar&#39;</span><span class="p">:</span>
            <span class="c1">#if len(self.data.LIDAR_data.density[chan].time) == 0:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">LIDAR_data</span><span class="o">.</span><span class="n">density</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>

                <span class="k">for</span> <span class="n">chan</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">LIDAR_data</span><span class="o">.</span><span class="n">density</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                    <span class="k">if</span> <span class="n">chan</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">density</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                        <span class="n">ax_name</span> <span class="o">=</span> <span class="s1">&#39;ax&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">chan</span><span class="p">)</span>
                        <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Lidar ch.&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">chan</span><span class="p">)</span>

                        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">secondtrace_original</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span> <span class="o">=</span> <span class="n">SignalBase</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">constants</span><span class="p">)</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">secondtrace_norm</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span> <span class="o">=</span> <span class="n">SignalBase</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">constants</span><span class="p">)</span>

                        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">secondtrace_original</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">time</span> <span class="o">=</span> \
                            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">LIDAR_data</span><span class="o">.</span><span class="n">density</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">time</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">secondtrace_original</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> \
                            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">LIDAR_data</span><span class="o">.</span><span class="n">density</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
                        <span class="c1"># self.data.secondtrace_norm[chan].data = norm(self.data.LIDAR_data.density[chan].data)</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">secondtrace_norm</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">normalise</span><span class="p">(</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">LIDAR_data</span><span class="o">.</span><span class="n">density</span><span class="p">[</span><span class="n">chan</span><span class="p">],</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">density</span><span class="p">[</span><span class="n">chan</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">dis_time</span><span class="p">)</span>

                        <span class="nb">vars</span><span class="p">()[</span><span class="n">ax_name</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">LIDAR_data</span><span class="o">.</span><span class="n">density</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">time</span><span class="p">,</span>
                                             <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">LIDAR_data</span><span class="o">.</span><span class="n">density</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">,</span>
                                             <span class="n">label</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span>
                                             <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
                        <span class="nb">vars</span><span class="p">()[</span><span class="n">ax_name</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>


            <span class="k">else</span><span class="p">:</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s1">&#39;no {} data&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">s2ndtrace</span><span class="p">))</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">s2ndtrace</span> <span class="o">==</span> <span class="s1">&#39;Far&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG4_data</span><span class="o">.</span><span class="n">faraday</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                <span class="c1"># if len(self.data.KG4_data.faraday[chan].time) == 0:</span>
                <span class="c1">#     logger.info(&#39;NO Far data&#39;)</span>
                <span class="c1"># else:</span>

                <span class="k">for</span> <span class="n">chan</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG4_data</span><span class="o">.</span><span class="n">faraday</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                    <span class="k">if</span> <span class="n">chan</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">density</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                        <span class="n">ax_name</span> <span class="o">=</span> <span class="s1">&#39;ax&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">chan</span><span class="p">)</span>
                        <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Far ch.&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">chan</span><span class="p">)</span>

                        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">secondtrace_original</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span> <span class="o">=</span> <span class="n">SignalBase</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">constants</span><span class="p">)</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">secondtrace_norm</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span> <span class="o">=</span> <span class="n">SignalBase</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">constants</span><span class="p">)</span>

                        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">secondtrace_original</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">time</span> <span class="o">=</span> \
                            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG4_data</span><span class="o">.</span><span class="n">faraday</span><span class="p">[</span>
                                <span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">time</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">secondtrace_original</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> \
                            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG4_data</span><span class="o">.</span><span class="n">faraday</span><span class="p">[</span>
                                <span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
                        <span class="c1"># self.data.secondtrace_norm[chan].data = norm(self.data.KG4_data.faraday[chan].data)</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">secondtrace_norm</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">normalise</span><span class="p">(</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG4_data</span><span class="o">.</span><span class="n">faraday</span><span class="p">[</span><span class="n">chan</span><span class="p">],</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">density</span><span class="p">[</span><span class="n">chan</span><span class="p">],</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">dis_time</span><span class="p">)</span>

                        <span class="nb">vars</span><span class="p">()[</span><span class="n">ax_name</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG4_data</span><span class="o">.</span><span class="n">faraday</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">time</span><span class="p">,</span>
                                             <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG4_data</span><span class="o">.</span><span class="n">faraday</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">,</span>
                                             <span class="n">label</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
                        <span class="nb">vars</span><span class="p">()[</span><span class="n">ax_name</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>


            <span class="k">else</span><span class="p">:</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s1">&#39;no {} data&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">s2ndtrace</span><span class="p">))</span>


        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">s2ndtrace</span> <span class="o">==</span> <span class="s1">&#39;CM&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG4_data</span><span class="o">.</span><span class="n">xg_ell_signal</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>

                <span class="c1"># if len(self.data.KG4_data.xg_ell_signal[chan].time) == 0:</span>
                <span class="c1">#     logger.info(&#39;NO CM data&#39;)</span>
                <span class="c1"># else:</span>

                <span class="k">for</span> <span class="n">chan</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG4_data</span><span class="o">.</span><span class="n">xg_ell_signal</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                    <span class="k">if</span> <span class="n">chan</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">density</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                        <span class="n">ax_name</span> <span class="o">=</span> <span class="s1">&#39;ax&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">chan</span><span class="p">)</span>
                        <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;CM ch.&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">chan</span><span class="p">)</span>

                        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">secondtrace_original</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span> <span class="o">=</span> <span class="n">SignalBase</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">constants</span><span class="p">)</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">secondtrace_norm</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span> <span class="o">=</span> <span class="n">SignalBase</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">constants</span><span class="p">)</span>

                        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">secondtrace_original</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">time</span> <span class="o">=</span> \
                            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG4_data</span><span class="o">.</span><span class="n">xg_ell_signal</span><span class="p">[</span>
                                <span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">time</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">secondtrace_original</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> \
                            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG4_data</span><span class="o">.</span><span class="n">xg_ell_signal</span><span class="p">[</span>
                                <span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
                        <span class="c1"># self.data.secondtrace_norm[chan].data = norm(</span>
                        <span class="c1">#     self.data.KG4_data.xg_ell_signal[chan].data)</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">secondtrace_norm</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">normalise</span><span class="p">(</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG4_data</span><span class="o">.</span><span class="n">xg_ell_signal</span><span class="p">[</span><span class="n">chan</span><span class="p">],</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">density</span><span class="p">[</span><span class="n">chan</span><span class="p">],</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">dis_time</span><span class="p">)</span>

                        <span class="nb">vars</span><span class="p">()[</span><span class="n">ax_name</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG4_data</span><span class="o">.</span><span class="n">xg_ell_signal</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">time</span><span class="p">,</span>
                                             <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG4_data</span><span class="o">.</span><span class="n">xg_ell_signal</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">,</span>
                                             <span class="n">label</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;purple&#39;</span><span class="p">)</span>
                        <span class="nb">vars</span><span class="p">()[</span><span class="n">ax_name</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>


            <span class="k">else</span><span class="p">:</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s1">&#39;no {} data&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">s2ndtrace</span><span class="p">))</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">s2ndtrace</span> <span class="o">==</span> <span class="s1">&#39;KG1_RT&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG4_data</span><span class="o">.</span><span class="n">density</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                <span class="c1"># if len(self.data.KG4_data.density[chan].time) == 0:</span>
                <span class="c1">#     logger.info(&#39;NO KG1_RT data&#39;)</span>
                <span class="c1"># else:</span>

                <span class="k">for</span> <span class="n">chan</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG4_data</span><span class="o">.</span><span class="n">density</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                    <span class="k">if</span> <span class="n">chan</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">density</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                        <span class="n">ax_name</span> <span class="o">=</span> <span class="s1">&#39;ax&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">chan</span><span class="p">)</span>
                        <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;KG1 RT ch.&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">chan</span><span class="p">)</span>

                        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">secondtrace_original</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span> <span class="o">=</span> <span class="n">SignalBase</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">constants</span><span class="p">)</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">secondtrace_norm</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span> <span class="o">=</span> <span class="n">SignalBase</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">constants</span><span class="p">)</span>

                        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">secondtrace_original</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">time</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">kg1rt</span><span class="p">[</span>
                            <span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">time</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">secondtrace_original</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">kg1rt</span><span class="p">[</span>
                            <span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
                        <span class="c1"># self.data.secondtrace_norm[chan].data = norm(</span>
                        <span class="c1">#     self.data.KG1_data.kg1rt[chan].data)</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">secondtrace_norm</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">normalise</span><span class="p">(</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">kg1rt</span><span class="p">[</span><span class="n">chan</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">HRTS_data</span><span class="o">.</span><span class="n">density</span><span class="p">[</span><span class="n">chan</span><span class="p">],</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">dis_time</span><span class="p">)</span>

                        <span class="nb">vars</span><span class="p">()[</span><span class="n">ax_name</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">kg1rt</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">time</span><span class="p">,</span>
                                             <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">kg1rt</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">,</span>
                                             <span class="n">label</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;brown&#39;</span><span class="p">)</span>
                        <span class="nb">vars</span><span class="p">()[</span><span class="n">ax_name</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>



        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">s2ndtrace</span> <span class="o">==</span> <span class="s1">&#39;BremS&#39;</span><span class="p">:</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;not implemented yet&#39;</span><span class="p">)</span>


        <span class="k">for</span> <span class="n">chan</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">fj_dcn</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">chan</span> <span class="o">&gt;</span><span class="mi">9</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ax_name</span> <span class="o">=</span> <span class="s1">&#39;ax&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">chan</span><span class="p">)</span>
                <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;LID&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">chan</span><span class="p">)</span>
                <span class="n">widget_name</span> <span class="o">=</span> <span class="s1">&#39;widget_LID&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">chan</span><span class="p">)</span>
                <span class="n">xposition</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">fj_dcn</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">time</span>
                <span class="k">for</span> <span class="n">xc</span> <span class="ow">in</span> <span class="n">xposition</span><span class="p">:</span>
                    <span class="nb">vars</span><span class="p">()[</span><span class="n">ax_name</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">xc</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">chan</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">fj_met</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">chan</span> <span class="o">&gt;</span><span class="mi">9</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ax_name</span> <span class="o">=</span> <span class="s1">&#39;ax&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">chan</span><span class="p">)</span>
                <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;LID&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">chan</span><span class="p">)</span>
                <span class="n">widget_name</span> <span class="o">=</span> <span class="s1">&#39;widget_LID&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">chan</span><span class="p">)</span>
                <span class="n">xposition</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">fjmet</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">time</span>
                <span class="k">for</span> <span class="n">xc</span> <span class="ow">in</span> <span class="n">xposition</span><span class="p">:</span>
                    <span class="nb">vars</span><span class="p">()[</span><span class="n">ax_name</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">xc</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>



        <span class="c1"># update canvas</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID1</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID2</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID3</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID4</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID5</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID6</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID7</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID8</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>

        <span class="c1"># only now activate button &quot;normalize&quot; and &quot;restore&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">button_normalize</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">button_restore</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span></div>

    <span class="c1"># ------------------------</span>
    <span class="c1"># noinspection PyUnusedLocal,PyUnusedLocal</span>
    <span class="nd">@QtCore.pyqtSlot</span><span class="p">()</span>
<div class="viewcode-block" id="CORMAT_GUI.plot_markers"><a class="viewcode-back" href="../Cormat_main.html#Cormat_main.CORMAT_GUI.plot_markers">[docs]</a>    <span class="k">def</span> <span class="nf">plot_markers</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        function that plots a marker traces in the tabs(each canvas)</span>
<span class="sd">        This version creates sub plot inside the canvas</span>
<span class="sd">        :return:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># self.data.s2ndtrace = self.comboBox_2ndtrace.itemText(i)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_2ndtrace</span><span class="o">.</span><span class="n">setCurrentIndex</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">marker</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_markers</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span>

        <span class="c1"># self.widget_LID8.draw()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID1</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID1</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID2</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID2</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID3</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID3</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID4</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID4</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID5</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID5</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID6</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID6</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID7</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID7</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID8</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID8</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>

        <span class="c1"># self.widget_LID_14.figure.clear()</span>
        <span class="c1"># self.widget_LID_14.draw()</span>
        <span class="c1">#</span>
        <span class="c1"># self.widget_LID_58.figure.clear()</span>
        <span class="c1"># self.widget_LID_58.draw()</span>
        <span class="c1">#</span>
        <span class="c1"># self.widget_LID_ALL.figure.clear()</span>
        <span class="c1"># self.widget_LID_ALL.draw()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">widget_MIR</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">widget_MIR</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>

        <span class="c1"># ax_all = self.widget_LID_ALL.figure.add_subplot(111)</span>

        <span class="c1"># ax_mir = self.widget_MIR.figure.add_subplot(111)</span>

        <span class="c1"># define now two gridspecs</span>
        <span class="c1"># gs is the gridspec per channels 1-4</span>
        <span class="c1"># gs1 is the gridspec for channels 5-8</span>
        <span class="c1"># when plotting markers they will allocate space to plot markers in a subplot under current plot</span>

        <span class="c1"># gs = gridspec.GridSpec(2, 1, height_ratios=[3, 1])# working: creates canvas with 2 columns in the ratio 1/3</span>
        <span class="n">heights</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
        <span class="n">gs</span> <span class="o">=</span> <span class="n">gridspec</span><span class="o">.</span><span class="n">GridSpec</span><span class="p">(</span><span class="n">ncols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">nrows</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">height_ratios</span><span class="o">=</span><span class="n">heights</span><span class="p">)</span>
        <span class="c1">#</span>
        <span class="n">heights1</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
        <span class="n">gs1</span> <span class="o">=</span> <span class="n">gridspec</span><span class="o">.</span><span class="n">GridSpec</span><span class="p">(</span><span class="n">ncols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">nrows</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">height_ratios</span><span class="o">=</span><span class="n">heights1</span><span class="p">)</span>

        <span class="n">ax1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID1</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax1</span><span class="o">=</span><span class="n">ax1</span>
        <span class="n">ax1_marker</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID1</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">sharex</span><span class="o">=</span><span class="n">ax1</span><span class="p">);</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax1_marker</span><span class="o">=</span><span class="n">ax1_marker</span>

        <span class="n">ax2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID2</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax2</span><span class="o">=</span><span class="n">ax2</span>
        <span class="n">ax2_marker</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID2</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">sharex</span><span class="o">=</span><span class="n">ax2</span><span class="p">);</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax2_marker</span><span class="o">=</span><span class="n">ax2_marker</span>

        <span class="n">ax3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID3</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax3</span><span class="o">=</span><span class="n">ax3</span>
        <span class="n">ax3_marker</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID3</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">sharex</span><span class="o">=</span><span class="n">ax3</span><span class="p">);</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax3_marker</span><span class="o">=</span><span class="n">ax3_marker</span>

        <span class="n">ax4</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID4</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax4</span><span class="o">=</span><span class="n">ax4</span>
        <span class="n">ax4_marker</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID4</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">sharex</span><span class="o">=</span><span class="n">ax4</span><span class="p">);</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax4_marker</span><span class="o">=</span><span class="n">ax4_marker</span>

        <span class="n">ax5</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID5</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs1</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax5</span><span class="o">=</span><span class="n">ax5</span>
        <span class="n">ax51</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID5</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs1</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">sharex</span><span class="o">=</span><span class="n">ax5</span><span class="p">);</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax51</span><span class="o">=</span><span class="n">ax51</span>
        <span class="n">ax5_marker</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID5</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs1</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">sharex</span><span class="o">=</span><span class="n">ax5</span><span class="p">);</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax5_marker</span><span class="o">=</span><span class="n">ax5_marker</span>

        <span class="n">ax6</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID6</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs1</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax6</span><span class="o">=</span><span class="n">ax6</span>
        <span class="n">ax61</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID6</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs1</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">sharex</span><span class="o">=</span><span class="n">ax6</span><span class="p">);</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax61</span><span class="o">=</span><span class="n">ax61</span>
        <span class="n">ax6_marker</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID6</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs1</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">sharex</span><span class="o">=</span><span class="n">ax6</span><span class="p">);</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax6_marker</span><span class="o">=</span><span class="n">ax6_marker</span>

        <span class="n">ax7</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID7</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs1</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax7</span><span class="o">=</span><span class="n">ax7</span>
        <span class="n">ax71</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID7</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs1</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">sharex</span><span class="o">=</span><span class="n">ax7</span><span class="p">);</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax71</span><span class="o">=</span><span class="n">ax71</span>
        <span class="n">ax7_marker</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID7</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs1</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">sharex</span><span class="o">=</span><span class="n">ax7</span><span class="p">);</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax7_marker</span><span class="o">=</span><span class="n">ax7_marker</span>

        <span class="n">ax8</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID8</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs1</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax8</span><span class="o">=</span><span class="n">ax8</span>
        <span class="n">ax81</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID8</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs1</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">sharex</span><span class="o">=</span><span class="n">ax8</span><span class="p">);</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax81</span><span class="o">=</span><span class="n">ax81</span>
        <span class="n">ax8_marker</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID8</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs1</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">sharex</span><span class="o">=</span><span class="n">ax8</span><span class="p">);</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax8_marker</span><span class="o">=</span><span class="n">ax8_marker</span>

        <span class="c1">#</span>
        <span class="c1"># ax_all = self.widget_LID_ALL.figure.add_subplot(gs[0])</span>
        <span class="c1"># ax_14 = self.widget_LID_14.figure.add_subplot(gs[0])</span>
        <span class="c1"># ax_58 = self.widget_LID_58.figure.add_subplot(gs[0])</span>

        <span class="c1"># ax_mir = self.widget_MIR.figure.add_subplot(gs[0])</span>

        <span class="c1"># define now other gridspecs</span>
        <span class="c1"># gs2 is the gridspec per channels 1-4</span>
        <span class="c1"># gs21 is the gridspec for channels 5-8</span>
        <span class="c1"># when plotting NO markers they will reset to standard plots</span>

        <span class="n">heights2</span> <span class="o">=</span> <span class="p">[</span><span class="mi">4</span><span class="p">]</span>
        <span class="n">gs2</span> <span class="o">=</span> <span class="n">gridspec</span><span class="o">.</span><span class="n">GridSpec</span><span class="p">(</span><span class="n">ncols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">height_ratios</span><span class="o">=</span><span class="n">heights2</span><span class="p">)</span>
        <span class="n">heights21</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
        <span class="n">gs21</span> <span class="o">=</span> <span class="n">gridspec</span><span class="o">.</span><span class="n">GridSpec</span><span class="p">(</span><span class="n">ncols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">nrows</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">height_ratios</span><span class="o">=</span><span class="n">heights21</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">chan</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">density</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">ax_name</span> <span class="o">=</span> <span class="s1">&#39;ax&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">chan</span><span class="p">)</span>
            <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;LID&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">chan</span><span class="p">)</span>
            <span class="nb">vars</span><span class="p">()[</span><span class="n">ax_name</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">density</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">time</span><span class="p">,</span>
                                 <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">density</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">,</span>
                                 <span class="n">label</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span>
                                 <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;None&#39;</span><span class="p">)</span>
            <span class="nb">vars</span><span class="p">()[</span><span class="n">ax_name</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID1</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>

            <span class="k">if</span> <span class="n">chan</span> <span class="o">&gt;</span> <span class="mi">4</span><span class="p">:</span>
                <span class="n">name1</span> <span class="o">=</span> <span class="s1">&#39;MIR&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">chan</span><span class="p">)</span>
                <span class="n">name2</span> <span class="o">=</span> <span class="s1">&#39;JxB&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">chan</span><span class="p">)</span>
                <span class="n">ax_name1</span> <span class="o">=</span> <span class="s1">&#39;ax&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">chan</span><span class="p">)</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
                <span class="c1"># noinspection PyUnusedLocal</span>
                <span class="n">widget_name1</span> <span class="o">=</span> <span class="s1">&#39;widget_LID&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">chan</span><span class="p">)</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
                <span class="nb">vars</span><span class="p">()[</span><span class="n">ax_name1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">vibration</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">time</span><span class="p">,</span>
                                      <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">vibration</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">data</span> <span class="o">*</span> <span class="mf">1e6</span><span class="p">,</span>
                                      <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">name1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span>
                                      <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;None&#39;</span><span class="p">)</span>
                <span class="nb">vars</span><span class="p">()[</span><span class="n">ax_name1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">jxb</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">time</span><span class="p">,</span>
                                      <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">jxb</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">data</span> <span class="o">*</span> <span class="mf">1e6</span><span class="p">,</span>
                                      <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">name2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;c&#39;</span><span class="p">,</span>
                                      <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;None&#39;</span><span class="p">)</span>
                <span class="nb">vars</span><span class="p">()[</span><span class="n">ax_name1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

                <span class="c1"># ax_mir.plot(self.data.KG1_data.vibration[chan].time,</span>
                <span class="c1">#             self.data.KG1_data.vibration[chan].data * 1e6,</span>
                <span class="c1">#             marker=&#39;x&#39;, label=name1, linestyle=&#39;None&#39;)</span>
                <span class="c1"># ax_mir.legend()</span>
                <span class="c1"># draw_widget(chan)</span>

        <span class="k">for</span> <span class="n">chan</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">fj_dcn</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">ax_name</span> <span class="o">=</span> <span class="s1">&#39;ax&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">chan</span><span class="p">)</span>
            <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;LID&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">chan</span><span class="p">)</span>
            <span class="n">widget_name</span> <span class="o">=</span> <span class="s1">&#39;widget_LID&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">chan</span><span class="p">)</span>
            <span class="n">xposition</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">fj_dcn</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">time</span>
            <span class="k">for</span> <span class="n">xc</span> <span class="ow">in</span> <span class="n">xposition</span><span class="p">:</span>
                <span class="nb">vars</span><span class="p">()[</span><span class="n">ax_name</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">xc</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">chan</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">fj_met</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">ax_name</span> <span class="o">=</span> <span class="s1">&#39;ax&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">chan</span><span class="p">)</span>
            <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;LID&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">chan</span><span class="p">)</span>
            <span class="n">widget_name</span> <span class="o">=</span> <span class="s1">&#39;widget_LID&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">chan</span><span class="p">)</span>
            <span class="n">xposition</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">fjmet</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">time</span>
            <span class="k">for</span> <span class="n">xc</span> <span class="ow">in</span> <span class="n">xposition</span><span class="p">:</span>
                <span class="nb">vars</span><span class="p">()[</span><span class="n">ax_name</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">xc</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">marker</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;plotting marker {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">marker</span><span class="p">))</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">marker</span> <span class="o">==</span> <span class="s1">&#39;None&#39;</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;no marker selected&#39;</span><span class="p">)</span>

            <span class="c1"># if no marker hide axis showing markers</span>
            <span class="n">ax1_marker</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
            <span class="n">ax2_marker</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
            <span class="n">ax3_marker</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
            <span class="n">ax4_marker</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
            <span class="n">ax5_marker</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
            <span class="n">ax6_marker</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
            <span class="n">ax7_marker</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
            <span class="n">ax8_marker</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
            <span class="c1"># use the second group of Gridspec and rearrange plots</span>
            <span class="n">ax1</span><span class="o">.</span><span class="n">set_position</span><span class="p">(</span><span class="n">gs2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get_position</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">widget_LID1</span><span class="o">.</span><span class="n">figure</span><span class="p">))</span>
            <span class="n">ax2</span><span class="o">.</span><span class="n">set_position</span><span class="p">(</span><span class="n">gs2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get_position</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">widget_LID2</span><span class="o">.</span><span class="n">figure</span><span class="p">))</span>
            <span class="n">ax3</span><span class="o">.</span><span class="n">set_position</span><span class="p">(</span><span class="n">gs2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get_position</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">widget_LID3</span><span class="o">.</span><span class="n">figure</span><span class="p">))</span>
            <span class="n">ax4</span><span class="o">.</span><span class="n">set_position</span><span class="p">(</span><span class="n">gs2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get_position</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">widget_LID4</span><span class="o">.</span><span class="n">figure</span><span class="p">))</span>

            <span class="n">ax5</span><span class="o">.</span><span class="n">set_position</span><span class="p">(</span><span class="n">gs21</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get_position</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">widget_LID5</span><span class="o">.</span><span class="n">figure</span><span class="p">))</span>
            <span class="n">ax51</span><span class="o">.</span><span class="n">set_position</span><span class="p">(</span><span class="n">gs21</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">get_position</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">widget_LID5</span><span class="o">.</span><span class="n">figure</span><span class="p">))</span>
            <span class="n">ax6</span><span class="o">.</span><span class="n">set_position</span><span class="p">(</span><span class="n">gs21</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get_position</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">widget_LID5</span><span class="o">.</span><span class="n">figure</span><span class="p">))</span>
            <span class="n">ax61</span><span class="o">.</span><span class="n">set_position</span><span class="p">(</span><span class="n">gs21</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">get_position</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">widget_LID5</span><span class="o">.</span><span class="n">figure</span><span class="p">))</span>
            <span class="n">ax7</span><span class="o">.</span><span class="n">set_position</span><span class="p">(</span><span class="n">gs21</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get_position</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">widget_LID5</span><span class="o">.</span><span class="n">figure</span><span class="p">))</span>
            <span class="n">ax71</span><span class="o">.</span><span class="n">set_position</span><span class="p">(</span><span class="n">gs21</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">get_position</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">widget_LID5</span><span class="o">.</span><span class="n">figure</span><span class="p">))</span>
            <span class="n">ax8</span><span class="o">.</span><span class="n">set_position</span><span class="p">(</span><span class="n">gs21</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get_position</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">widget_LID5</span><span class="o">.</span><span class="n">figure</span><span class="p">))</span>
            <span class="n">ax81</span><span class="o">.</span><span class="n">set_position</span><span class="p">(</span><span class="n">gs21</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">get_position</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">widget_LID5</span><span class="o">.</span><span class="n">figure</span><span class="p">))</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">marker</span> <span class="o">==</span> <span class="s1">&#39;ELMs&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">ELM_data</span><span class="o">.</span><span class="n">elm_times</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">chan</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">density</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                    <span class="n">ax_name</span> <span class="o">=</span> <span class="s1">&#39;ax&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">chan</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;_marker&#39;</span>
                    <span class="c1"># name = &#39;HRTS ch.&#39; + str(chan)</span>

                    <span class="nb">vars</span><span class="p">()[</span><span class="n">ax_name</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">ELM_data</span><span class="o">.</span><span class="n">elms_signal</span><span class="o">.</span><span class="n">time</span><span class="p">,</span>
                                         <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">ELM_data</span><span class="o">.</span><span class="n">elms_signal</span><span class="o">.</span><span class="n">data</span><span class="p">,</span>
                                         <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>

                    <span class="k">for</span> <span class="n">vert</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">ELM_data</span><span class="o">.</span><span class="n">elm_times</span><span class="p">:</span>
                        <span class="nb">vars</span><span class="p">()[</span><span class="n">ax_name</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">vert</span><span class="p">,</span> <span class="n">ymin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ymax</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                                                <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span>
                    <span class="c1"># if len(self.data.ELM_data.elm_times) &gt; 0:</span>
                    <span class="k">for</span> <span class="n">horz</span> <span class="ow">in</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">ELM_data</span><span class="o">.</span><span class="n">UP_THRESH</span><span class="p">,</span>
                                 <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">ELM_data</span><span class="o">.</span><span class="n">DOWN_THRESH</span><span class="p">]:</span>
                        <span class="nb">vars</span><span class="p">()[</span><span class="n">ax_name</span><span class="p">]</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">horz</span><span class="p">,</span> <span class="n">xmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">xmax</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                                                <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;cyan&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;No ELMs marker&#39;</span><span class="p">)</span>

                <span class="c1"># if chan &gt; 4:</span>
                <span class="c1">#     ax_name1 = &#39;ax&#39; + str(chan) + str(1)</span>
                <span class="c1">#     widget_name1 = &#39;widget_LID&#39; + str(chan) + str(1)</span>
                <span class="c1">#     vars()[ax_name].plot(</span>
                <span class="c1">#         self.data.HRTS_data.density[chan].time,</span>
                <span class="c1">#         self.data.HRTS_data.density[chan].data, label=name,</span>
                <span class="c1">#         marker=&#39;o&#39;, color=&#39;orange&#39;)</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">marker</span> <span class="o">==</span> <span class="s1">&#39;MAGNETICs&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">MAG_data</span><span class="o">.</span><span class="n">start_ip</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">chan</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">density</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                    <span class="n">ax_name</span> <span class="o">=</span> <span class="s1">&#39;ax&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">chan</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;_marker&#39;</span>
                    <span class="c1"># name = &#39;HRTS ch.&#39; + str(chan)</span>

                    <span class="k">for</span> <span class="n">vert</span> <span class="ow">in</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">MAG_data</span><span class="o">.</span><span class="n">start_ip</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">MAG_data</span><span class="o">.</span><span class="n">end_ip</span><span class="p">]:</span>
                        <span class="nb">vars</span><span class="p">()[</span><span class="n">ax_name</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">vert</span><span class="p">,</span> <span class="n">ymin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ymax</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                                                <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">vert</span> <span class="ow">in</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">MAG_data</span><span class="o">.</span><span class="n">start_flattop</span><span class="p">,</span>
                                 <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">MAG_data</span><span class="o">.</span><span class="n">end_flattop</span><span class="p">]:</span>
                        <span class="nb">vars</span><span class="p">()[</span><span class="n">ax_name</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">vert</span><span class="p">,</span> <span class="n">ymin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ymax</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                                                <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;green&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;No MAGNETICs marker&#39;</span><span class="p">)</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">marker</span> <span class="o">==</span> <span class="s1">&#39;NBI&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">NBI_data</span><span class="o">.</span><span class="n">start_nbi</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">chan</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">density</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                    <span class="n">ax_name</span> <span class="o">=</span> <span class="s1">&#39;ax&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">chan</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;_marker&#39;</span>
                    <span class="c1"># name = &#39;HRTS ch.&#39; + str(chan)</span>

                    <span class="k">for</span> <span class="n">vert</span> <span class="ow">in</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">NBI_data</span><span class="o">.</span><span class="n">start_nbi</span><span class="p">,</span>
                                 <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">NBI_data</span><span class="o">.</span><span class="n">end_nbi</span><span class="p">]:</span>
                        <span class="nb">vars</span><span class="p">()[</span><span class="n">ax_name</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">vert</span><span class="p">,</span> <span class="n">ymin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ymax</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                                                <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;No NBI marker&#39;</span><span class="p">)</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">marker</span> <span class="o">==</span> <span class="s1">&#39;PELLETs&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">PELLETS_data</span><span class="o">.</span><span class="n">time_pellets</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">chan</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">density</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                    <span class="n">ax_name</span> <span class="o">=</span> <span class="s1">&#39;ax&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">chan</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;_marker&#39;</span>
                    <span class="c1"># name = &#39;HRTS ch.&#39; + str(chan)</span>

                    <span class="k">for</span> <span class="n">vert</span> <span class="ow">in</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">PELLETS_data</span><span class="o">.</span><span class="n">time_pellets</span><span class="p">]:</span>
                        <span class="nb">vars</span><span class="p">()[</span><span class="n">ax_name</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">vert</span><span class="p">,</span> <span class="n">ymin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ymax</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                                                <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;No PELLET marker&#39;</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">chan</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">fj_dcn</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">ax_name</span> <span class="o">=</span> <span class="s1">&#39;ax&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">chan</span><span class="p">)</span>
            <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;LID&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">chan</span><span class="p">)</span>
            <span class="n">widget_name</span> <span class="o">=</span> <span class="s1">&#39;widget_LID&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">chan</span><span class="p">)</span>
            <span class="n">xposition</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">fj_dcn</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">time</span>
            <span class="k">for</span> <span class="n">xc</span> <span class="ow">in</span> <span class="n">xposition</span><span class="p">:</span>
                <span class="nb">vars</span><span class="p">()[</span><span class="n">ax_name</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">xc</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">chan</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">fj_met</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">ax_name</span> <span class="o">=</span> <span class="s1">&#39;ax&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">chan</span><span class="p">)</span>
            <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;LID&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">chan</span><span class="p">)</span>
            <span class="n">widget_name</span> <span class="o">=</span> <span class="s1">&#39;widget_LID&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">chan</span><span class="p">)</span>
            <span class="n">xposition</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">fjmet</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">time</span>
            <span class="k">for</span> <span class="n">xc</span> <span class="ow">in</span> <span class="n">xposition</span><span class="p">:</span>
                <span class="nb">vars</span><span class="p">()[</span><span class="n">ax_name</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">xc</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>

            <span class="c1"># pass</span>
        <span class="c1"># self.widget_LID1.figure.clear()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID1</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
        <span class="c1">#</span>
        <span class="c1"># self.widget_LID2.figure.clear()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID2</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
        <span class="c1">#</span>
        <span class="c1"># self.widget_LID3.figure.clear()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID3</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
        <span class="c1">#</span>
        <span class="c1"># self.widget_LID4.figure.clear()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID4</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
        <span class="c1">#</span>
        <span class="c1"># self.widget_LID5.figure.clear()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID5</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
        <span class="c1">#</span>
        <span class="c1"># self.widget_LID6.figure.clear()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID6</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
        <span class="c1">#</span>
        <span class="c1"># self.widget_LID7.figure.clear()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID7</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
        <span class="c1">#</span>
        <span class="c1"># self.widget_LID8.figure.clear()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID8</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span></div>


    <span class="c1"># -------------------------</span>
<div class="viewcode-block" id="CORMAT_GUI.handle_check_status"><a class="viewcode-back" href="../Cormat_main.html#Cormat_main.CORMAT_GUI.handle_check_status">[docs]</a>    <span class="k">def</span> <span class="nf">handle_check_status</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">button_newpulse</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        function used for debugging and control purposes -</span>
<span class="sd">        -</span>
<span class="sd">        checks if button &quot;newpulse&quot; is clicked</span>
<span class="sd">        :param button_newpulse:</span>
<span class="sd">        :return: disable/enable combobox</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">button_newpulse</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;{} is checked&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">button_newpulse</span><span class="o">.</span><span class="n">objectName</span><span class="p">()))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_readuid</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="s1">&#39;{} is NOT checked&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">button_newpulse</span><span class="o">.</span><span class="n">objectName</span><span class="p">()))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_readuid</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></div>

                <span class="c1"># ------------------------</span>

    <span class="nd">@QtCore.pyqtSlot</span><span class="p">()</span>
    <span class="c1"># ------------------------</span>
<div class="viewcode-block" id="CORMAT_GUI.handle_saveppfbutton"><a class="viewcode-back" href="../Cormat_main.html#Cormat_main.CORMAT_GUI.handle_saveppfbutton">[docs]</a>    <span class="k">def</span> <span class="nf">handle_saveppfbutton</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        save data</span>


<span class="sd">        user will save either Status Flags or ppf (and SF)</span>

<span class="sd">        if user selects in GUI to save ppf a new PPF sequence will be written for dda=&#39;KG1V&#39;</span>
<span class="sd">        if user selects in GUI to save SF only the SF will be written in the last sequence (no new sequence)</span>
<span class="sd">        </span>
<span class="sd">        </span>
<span class="sd">        is data is has not been modified it automatically switches to save status flags only</span>
<span class="sd">        </span>
<span class="sd">        as from May 2019 there is a bug in ppfssr so a new ppf will written in either cases.</span>
<span class="sd">        </span>


<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">write_uid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_writeuid</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span>

        <span class="c1"># -------------------------------</span>
        <span class="c1"># 13. Write data to PPF</span>
        <span class="c1"># -------------------------------</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">radioButton_storeData</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
                <span class="s1">&#39; Requesting to change ppf data</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">areyousure_window</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QMainWindow</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ui_areyousure</span> <span class="o">=</span> <span class="n">Ui_areyousure_window</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ui_areyousure</span><span class="o">.</span><span class="n">setupUi</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">areyousure_window</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">areyousure_window</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

            <span class="c1">###temporary solution</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="s1">&#39;writing a new ppf until ppf library is fixed - 20 may 2019</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ui_areyousure</span><span class="o">.</span><span class="n">pushButton_YES</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">handle_save_data_statusflag</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ui_areyousure</span><span class="o">.</span><span class="n">pushButton_NO</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle_no</span><span class="p">)</span>
            <span class="c1">###end of temporary solution</span>


            <span class="c1"># if self.data.data_changed is False:</span>
            <span class="c1">#     self.ui_areyousure.pushButton_YES.clicked.connect(</span>
            <span class="c1">#         self.handle_save_statusflag)</span>
            <span class="c1">#     self.ui_areyousure.pushButton_NO.clicked.connect(self.handle_no)</span>
            <span class="c1"># else:</span>



        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">radioButton_storeSF</span><span class="o">.</span><span class="n">isChecked</span><span class="p">():</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
                <span class="s1">&#39; Requesting to change ppf data</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">areyousure_window</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QMainWindow</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ui_areyousure</span> <span class="o">=</span> <span class="n">Ui_areyousure_window</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ui_areyousure</span><span class="o">.</span><span class="n">setupUi</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">areyousure_window</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">areyousure_window</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

            <span class="c1">###temporary solution</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="s1">&#39;writing a new ppf until ppf library is fixed - 20 may 2019</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ui_areyousure</span><span class="o">.</span><span class="n">pushButton_YES</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">handle_save_data_statusflag</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ui_areyousure</span><span class="o">.</span><span class="n">pushButton_NO</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle_no</span><span class="p">)</span>
            <span class="c1">###end of temporary solution</span>
            <span class="c1"># if self.read_uid != self.write_uid:</span>
            <span class="c1">#     logger.info(&#39;read_uid different from write_uid&#39;)</span>
            <span class="c1">#     logger.info(&#39;retrieving sequence numbers for {}&#39;.format{self.write_uid})</span>
            <span class="c1">#</span>
            <span class="c1">#     self.data.unval_seq, self.data.val_seq = get_min_max_seq(self.data.pulse, dda=&quot;KG1V&quot;,</span>
            <span class="c1">#                                            read_uid=self.write_uid)</span>
            <span class="c1">#     if self.data.val_seq &lt;0:</span>
            <span class="c1">#         logger.warning(&#39;no validated data for user {}\n&#39;.format{self.write_uid})</span>
            <span class="c1">#         logger.info(&#39;writing new PPF&#39;)</span>
            <span class="c1">#</span>
            <span class="c1">#         self.ui_areyousure.pushButton_YES.clicked.connect(</span>
            <span class="c1">#             self.handle_save_data_statusflag)</span>
            <span class="c1">#         self.ui_areyousure.pushButton_NO.clicked.connect(</span>
            <span class="c1">#             self.handle_no)</span>
            <span class="c1">#     else:</span>
            <span class="c1">#         self.ui_areyousure.pushButton_YES.clicked.connect(self.handle_save_data_statusflag)</span>
            <span class="c1">#         self.ui_areyousure.pushButton_NO.clicked.connect(self.handle_no)</span>
            <span class="c1">#</span>
            <span class="c1"># else:</span>
            <span class="c1">#     self.ui_areyousure.pushButton_YES.clicked.connect(self.handle_save_statusflag)</span>
            <span class="c1">#     self.ui_areyousure.pushButton_NO.clicked.connect(self.handle_no)</span>
        <span class="k">elif</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">radioButton_storeSF</span><span class="o">.</span><span class="n">isChecked</span><span class="p">()</span> <span class="o">&amp;</span> <span class="bp">self</span><span class="o">.</span><span class="n">radioButton_storeData</span><span class="o">.</span><span class="n">isChecked</span><span class="p">()):</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39; please select action! </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span></div>


    <span class="c1"># ------------------------</span>
    <span class="nd">@QtCore.pyqtSlot</span><span class="p">()</span>
<div class="viewcode-block" id="CORMAT_GUI.handle_save_data_statusflag"><a class="viewcode-back" href="../Cormat_main.html#Cormat_main.CORMAT_GUI.handle_save_data_statusflag">[docs]</a>    <span class="k">def</span> <span class="nf">handle_save_data_statusflag</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        function data handles the writing of a new PPF</span>

<span class="sd">        :return: 67 if there has been an error in writing status flag</span>
<span class="sd">                0 otherwise (success)</span>
<span class="sd">        &quot;&quot;&quot;</span>



        <span class="bp">self</span><span class="o">.</span><span class="n">checkStatuFlags</span><span class="p">()</span>

        <span class="n">err</span> <span class="o">=</span> <span class="n">open_ppf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">pulse</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">write_uid</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">err</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;failed to open ppf&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="mi">67</span>

        <span class="n">itref_kg1v</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="n">dda</span> <span class="o">=</span> <span class="s2">&quot;KG1V&quot;</span>
        <span class="n">return_code</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="k">for</span> <span class="n">chan</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">density</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="c1"># status = np.empty(</span>
            <span class="c1">#     len(self.data.KG1_data.density[chan].time))</span>
            <span class="c1"># status.fill(self.data.SF_list[</span>
            <span class="c1">#                 chan - 1])</span>
            <span class="n">dtype_lid</span> <span class="o">=</span> <span class="s2">&quot;LID{}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">chan</span><span class="p">)</span>
            <span class="n">comment</span> <span class="o">=</span> <span class="s2">&quot;DATA FROM KG1 CHANNEL {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">chan</span><span class="p">)</span>
            <span class="n">write_err</span><span class="p">,</span> <span class="n">itref_written</span> <span class="o">=</span> <span class="n">write_ppf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">pulse</span><span class="p">,</span> <span class="n">dda</span><span class="p">,</span> <span class="n">dtype_lid</span><span class="p">,</span>
                                                 <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">density</span><span class="p">[</span>
                                                     <span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">,</span>
                                                 <span class="n">time</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">density</span><span class="p">[</span>
                                                     <span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">time</span><span class="p">,</span>
                                                 <span class="n">comment</span><span class="o">=</span><span class="n">comment</span><span class="p">,</span>
                                                 <span class="n">unitd</span><span class="o">=</span><span class="s1">&#39;M-2&#39;</span><span class="p">,</span> <span class="n">unitt</span><span class="o">=</span><span class="s1">&#39;SEC&#39;</span><span class="p">,</span>
                                                 <span class="n">itref</span><span class="o">=</span><span class="n">itref_kg1v</span><span class="p">,</span>
                                                 <span class="n">nt</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">density</span><span class="p">[</span>
                                                            <span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">time</span><span class="p">),</span>
                                                 <span class="n">status</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">status</span><span class="p">[</span>
                                                     <span class="n">chan</span><span class="p">],</span>
                                                 <span class="n">global_status</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">SF_list</span><span class="p">[</span>
                                                     <span class="n">chan</span> <span class="o">-</span> <span class="mi">1</span><span class="p">])</span>

            <span class="k">if</span> <span class="n">write_err</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
                    <span class="s2">&quot;Failed to write {}/{}. Errorcode {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">dda</span><span class="p">,</span> <span class="n">dtype_lid</span><span class="p">,</span>
                                                                 <span class="n">write_err</span><span class="p">))</span>
                <span class="k">break</span>
            <span class="c1"># Corrected FJs for vertical channels</span>
            <span class="k">if</span> <span class="n">chan</span> <span class="o">&lt;=</span> <span class="mi">4</span> <span class="ow">and</span> <span class="n">chan</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">fj_dcn</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>

                <span class="c1"># DCN fringes</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">fj_dcn</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                    <span class="n">dtype_fc</span> <span class="o">=</span> <span class="s2">&quot;FC{}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">chan</span><span class="p">)</span>
                    <span class="n">comment</span> <span class="o">=</span> <span class="s2">&quot;DCN FRINGE CORRECTIONS CH.{}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">chan</span><span class="p">)</span>
                    <span class="n">write_err</span><span class="p">,</span> <span class="n">itref_written</span> <span class="o">=</span> <span class="n">write_ppf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">pulse</span><span class="p">,</span> <span class="n">dda</span><span class="p">,</span>
                                                         <span class="n">dtype_fc</span><span class="p">,</span>
                                                         <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">fj_dcn</span><span class="p">[</span>
                                                             <span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">,</span>
                                                         <span class="n">time</span><span class="o">=</span>
                                                         <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">fj_dcn</span><span class="p">[</span>
                                                             <span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">time</span><span class="p">,</span>
                                                         <span class="n">comment</span><span class="o">=</span><span class="n">comment</span><span class="p">,</span>
                                                         <span class="n">unitd</span><span class="o">=</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="n">unitt</span><span class="o">=</span><span class="s2">&quot;SEC&quot;</span><span class="p">,</span>
                                                         <span class="n">itref</span><span class="o">=</span><span class="n">itref_kg1v</span><span class="p">,</span>
                                                         <span class="n">nt</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span>
                                                             <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">fj_dcn</span><span class="p">[</span>
                                                                 <span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">time</span><span class="p">),</span>
                                                         <span class="n">status</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>

                    <span class="k">if</span> <span class="n">write_err</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
                            <span class="s2">&quot;Failed to write {}/{}. Errorcode {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">dda</span><span class="p">,</span>
                                                                         <span class="n">dtype_fc</span><span class="p">,</span>
                                                                         <span class="n">write_err</span><span class="p">))</span>
                        <span class="k">return</span> <span class="n">write_err</span>
                        <span class="c1"># break</span>

            <span class="c1"># Vibration data and JXB for lateral channels, and corrected FJ</span>
            <span class="k">elif</span> <span class="n">chan</span> <span class="o">&gt;</span> <span class="mi">4</span> <span class="ow">and</span> <span class="n">chan</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">vibration</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">vibration</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                    <span class="c1"># Vibration</span>
                    <span class="n">dtype_vib</span> <span class="o">=</span> <span class="s2">&quot;MIR{}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">chan</span><span class="p">)</span>
                    <span class="n">comment</span> <span class="o">=</span> <span class="s2">&quot;MOVEMENT OF MIRROR {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">chan</span><span class="p">)</span>
                    <span class="n">write_err</span><span class="p">,</span> <span class="n">itref_written</span> <span class="o">=</span> <span class="n">write_ppf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">pulse</span><span class="p">,</span> <span class="n">dda</span><span class="p">,</span>
                                                         <span class="n">dtype_vib</span><span class="p">,</span>
                                                         <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">vibration</span><span class="p">[</span>
                                                             <span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">,</span>
                                                         <span class="n">time</span><span class="o">=</span>
                                                         <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">vibration</span><span class="p">[</span>
                                                             <span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">time</span><span class="p">,</span>
                                                         <span class="n">comment</span><span class="o">=</span><span class="n">comment</span><span class="p">,</span>
                                                         <span class="n">unitd</span><span class="o">=</span><span class="s1">&#39;M&#39;</span><span class="p">,</span> <span class="n">unitt</span><span class="o">=</span><span class="s1">&#39;SEC&#39;</span><span class="p">,</span>
                                                         <span class="n">itref</span><span class="o">=</span><span class="n">itref_kg1v</span><span class="p">,</span>
                                                         <span class="n">nt</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span>
                                                             <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">vibration</span><span class="p">[</span>
                                                                 <span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">time</span><span class="p">),</span>
                                                         <span class="n">status</span><span class="o">=</span>
                                                         <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">status</span><span class="p">[</span>
                                                             <span class="n">chan</span> <span class="o">-</span><span class="mi">1</span><span class="p">])</span>
                    <span class="k">if</span> <span class="n">write_err</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
                            <span class="s2">&quot;Failed to write {}/{}. Errorcode {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">dda</span><span class="p">,</span>
                                                                         <span class="n">dtype_vib</span><span class="p">,</span>
                                                                         <span class="n">write_err</span><span class="p">))</span>
                        <span class="k">return</span> <span class="n">write_err</span>

                    <span class="c1"># JXB movement</span>
                    <span class="n">dtype_jxb</span> <span class="o">=</span> <span class="s2">&quot;JXB{}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">chan</span><span class="p">)</span>
                    <span class="n">comment</span> <span class="o">=</span> <span class="s2">&quot;JxB CALC. MOVEMENT CH.{}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">chan</span><span class="p">)</span>
                    <span class="n">write_err</span><span class="p">,</span> <span class="n">itref_written</span> <span class="o">=</span> <span class="n">write_ppf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">pulse</span><span class="p">,</span> <span class="n">dda</span><span class="p">,</span>
                                                         <span class="n">dtype_jxb</span><span class="p">,</span>
                                                         <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">jxb</span><span class="p">[</span>
                                                             <span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">,</span>
                                                         <span class="n">time</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">jxb</span><span class="p">[</span>
                                                             <span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">time</span><span class="p">,</span>
                                                         <span class="n">comment</span><span class="o">=</span><span class="n">comment</span><span class="p">,</span>
                                                         <span class="n">unitd</span><span class="o">=</span><span class="s1">&#39;M&#39;</span><span class="p">,</span> <span class="n">unitt</span><span class="o">=</span><span class="s1">&#39;SEC&#39;</span><span class="p">,</span>
                                                         <span class="n">itref</span><span class="o">=</span><span class="n">itref_kg1v</span><span class="p">,</span>
                                                         <span class="n">nt</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span>
                                                             <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">jxb</span><span class="p">[</span>
                                                                 <span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">time</span><span class="p">),</span>
                                                         <span class="n">status</span><span class="o">=</span>
                                                         <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">status</span><span class="p">[</span>
                                                             <span class="n">chan</span> <span class="o">-</span><span class="mi">1</span><span class="p">])</span>

                    <span class="k">if</span> <span class="n">write_err</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
                            <span class="s2">&quot;Failed to write {}/{}. Errorcode {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">dda</span><span class="p">,</span>
                                                                         <span class="n">dtype_jxb</span><span class="p">,</span>
                                                                         <span class="n">write_err</span><span class="p">))</span>
                        <span class="k">return</span> <span class="n">write_err</span>
            <span class="k">elif</span> <span class="n">chan</span> <span class="o">&gt;</span> <span class="mi">4</span> <span class="ow">and</span> <span class="n">chan</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">fj_met</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="c1"># MET fringes</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">fj_met</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                    <span class="n">dtype_fc</span> <span class="o">=</span> <span class="s2">&quot;MC{} &quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">chan</span><span class="p">)</span>
                    <span class="n">comment</span> <span class="o">=</span> <span class="s2">&quot;MET FRINGE CORRECTIONS CH.{}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">chan</span><span class="p">)</span>
                    <span class="n">write_err</span><span class="p">,</span> <span class="n">itref_written</span> <span class="o">=</span> <span class="n">write_ppf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">pulse</span><span class="p">,</span> <span class="n">dda</span><span class="p">,</span>
                                                         <span class="n">dtype_fc</span><span class="p">,</span>
                                                         <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">fj_met</span><span class="p">[</span>
                                                             <span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">,</span>
                                                         <span class="n">time</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fj_met</span><span class="p">[</span>
                                                             <span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">time</span><span class="p">,</span>
                                                         <span class="n">comment</span><span class="o">=</span><span class="n">comment</span><span class="p">,</span>
                                                         <span class="n">unitd</span><span class="o">=</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="n">unitt</span><span class="o">=</span><span class="s2">&quot;SEC&quot;</span><span class="p">,</span>
                                                         <span class="n">itref</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span>
                                                         <span class="n">nt</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span>
                                                             <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">fj_met</span><span class="p">[</span>
                                                                 <span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">time</span><span class="p">),</span>
                                                         <span class="n">status</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>

                    <span class="k">if</span> <span class="n">write_err</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
                            <span class="s2">&quot;Failed to write {}/{}. Errorcode {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                                <span class="n">dda</span><span class="p">,</span>
                                <span class="n">dtype_fc</span><span class="p">,</span>
                                <span class="n">write_err</span><span class="p">))</span>
                        <span class="k">return</span> <span class="n">write_err</span>

        <span class="c1"># if write_err != 0:</span>
        <span class="c1">#     logger.error(&#39;failed to write KG1 ppf&#39;)</span>
        <span class="c1">#     return 67</span>
        <span class="c1"># Write mode DDA</span>

        <span class="n">mode</span> <span class="o">=</span> <span class="s2">&quot;Correct.done by {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">owner</span><span class="p">)</span>
        <span class="n">dtype_mode</span> <span class="o">=</span> <span class="s2">&quot;MODE&quot;</span>
        <span class="n">comment</span> <span class="o">=</span> <span class="n">mode</span>
        <span class="n">write_err</span><span class="p">,</span> <span class="n">itref_written</span> <span class="o">=</span> <span class="n">write_ppf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">pulse</span><span class="p">,</span> <span class="n">dda</span><span class="p">,</span> <span class="n">dtype_mode</span><span class="p">,</span>
                                             <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">]),</span>
                                             <span class="n">time</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">]),</span>
                                             <span class="n">comment</span><span class="o">=</span><span class="n">comment</span><span class="p">,</span> <span class="n">unitd</span><span class="o">=</span><span class="s2">&quot; &quot;</span><span class="p">,</span>
                                             <span class="n">unitt</span><span class="o">=</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="n">itref</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">nt</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                                             <span class="n">status</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
        <span class="c1"># Retrieve geometry data &amp; write to PPF</span>
        <span class="n">temp</span><span class="p">,</span> <span class="n">r_ref</span><span class="p">,</span> <span class="n">z_ref</span><span class="p">,</span> <span class="n">a_ref</span><span class="p">,</span> <span class="n">r_coord</span><span class="p">,</span> <span class="n">z_coord</span><span class="p">,</span> <span class="n">a_coord</span><span class="p">,</span> <span class="n">coord_err</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">get_coord</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">pulse</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">coord_err</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;failed to write coord ppf&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">coord_err</span>

        <span class="n">dtype_temp</span> <span class="o">=</span> <span class="s2">&quot;TEMP&quot;</span>
        <span class="n">comment</span> <span class="o">=</span> <span class="s2">&quot;Vessel temperature(degC)&quot;</span>
        <span class="n">write_err</span><span class="p">,</span> <span class="n">itref_written</span> <span class="o">=</span> <span class="n">write_ppf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">pulse</span><span class="p">,</span> <span class="n">dda</span><span class="p">,</span> <span class="n">dtype_temp</span><span class="p">,</span>
                                             <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">temp</span><span class="p">]),</span>
                                             <span class="n">time</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">]),</span>
                                             <span class="n">comment</span><span class="o">=</span><span class="n">comment</span><span class="p">,</span> <span class="n">unitd</span><span class="o">=</span><span class="s2">&quot;deg&quot;</span><span class="p">,</span>
                                             <span class="n">unitt</span><span class="o">=</span><span class="s2">&quot;none&quot;</span><span class="p">,</span>
                                             <span class="n">itref</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">nt</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">status</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>

        <span class="n">geom_chan</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">a_ref</span><span class="p">))</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="n">dtype_aref</span> <span class="o">=</span> <span class="s2">&quot;AREF&quot;</span>
        <span class="n">comment</span> <span class="o">=</span> <span class="s2">&quot;CHORD(20 DEC.C): ANGLE&quot;</span>
        <span class="n">write_err</span><span class="p">,</span> <span class="n">itref_written</span> <span class="o">=</span> <span class="n">write_ppf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">pulse</span><span class="p">,</span> <span class="n">dda</span><span class="p">,</span> <span class="n">dtype_aref</span><span class="p">,</span> <span class="n">a_ref</span><span class="p">,</span>
                                             <span class="n">time</span><span class="o">=</span><span class="n">geom_chan</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="n">comment</span><span class="p">,</span>
                                             <span class="n">unitd</span><span class="o">=</span><span class="s2">&quot;RADIANS&quot;</span><span class="p">,</span> <span class="n">unitt</span><span class="o">=</span><span class="s2">&quot;CHORD NO&quot;</span><span class="p">,</span>
                                             <span class="n">itref</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">nt</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">geom_chan</span><span class="p">),</span>
                                             <span class="n">status</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>

        <span class="n">dtype_rref</span> <span class="o">=</span> <span class="s2">&quot;RREF&quot;</span>
        <span class="n">comment</span> <span class="o">=</span> <span class="s2">&quot;CHORD(20 DEC.C): RADIUS&quot;</span>
        <span class="n">write_err</span><span class="p">,</span> <span class="n">itref_written</span> <span class="o">=</span> <span class="n">write_ppf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">pulse</span><span class="p">,</span> <span class="n">dda</span><span class="p">,</span> <span class="n">dtype_rref</span><span class="p">,</span> <span class="n">r_ref</span><span class="p">,</span>
                                             <span class="n">time</span><span class="o">=</span><span class="n">geom_chan</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="n">comment</span><span class="p">,</span>
                                             <span class="n">unitd</span><span class="o">=</span><span class="s2">&quot;M&quot;</span><span class="p">,</span> <span class="n">unitt</span><span class="o">=</span><span class="s2">&quot;CHORD NO&quot;</span><span class="p">,</span>
                                             <span class="n">itref</span><span class="o">=</span><span class="n">itref_written</span><span class="p">,</span>
                                             <span class="n">nt</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">geom_chan</span><span class="p">),</span> <span class="n">status</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>

        <span class="n">dtype_zref</span> <span class="o">=</span> <span class="s2">&quot;ZREF&quot;</span>
        <span class="n">comment</span> <span class="o">=</span> <span class="s2">&quot;CHORD(20 DEC.C): HEIGHT&quot;</span>
        <span class="n">write_err</span><span class="p">,</span> <span class="n">itref_written</span> <span class="o">=</span> <span class="n">write_ppf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">pulse</span><span class="p">,</span> <span class="n">dda</span><span class="p">,</span> <span class="n">dtype_zref</span><span class="p">,</span> <span class="n">z_ref</span><span class="p">,</span>
                                             <span class="n">time</span><span class="o">=</span><span class="n">geom_chan</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="n">comment</span><span class="p">,</span>
                                             <span class="n">unitd</span><span class="o">=</span><span class="s2">&quot;M&quot;</span><span class="p">,</span> <span class="n">unitt</span><span class="o">=</span><span class="s2">&quot;CHORD NO&quot;</span><span class="p">,</span>
                                             <span class="n">itref</span><span class="o">=</span><span class="n">itref_written</span><span class="p">,</span>
                                             <span class="n">nt</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">geom_chan</span><span class="p">),</span> <span class="n">status</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>

        <span class="n">dtype_a</span> <span class="o">=</span> <span class="s2">&quot;A   &quot;</span>
        <span class="n">comment</span> <span class="o">=</span> <span class="s2">&quot;CHORD: ANGLE&quot;</span>
        <span class="n">write_err</span><span class="p">,</span> <span class="n">itref_written</span> <span class="o">=</span> <span class="n">write_ppf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">pulse</span><span class="p">,</span> <span class="n">dda</span><span class="p">,</span> <span class="n">dtype_a</span><span class="p">,</span> <span class="n">a_coord</span><span class="p">,</span>
                                             <span class="n">time</span><span class="o">=</span><span class="n">geom_chan</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="n">comment</span><span class="p">,</span>
                                             <span class="n">unitd</span><span class="o">=</span><span class="s2">&quot;RADIANS&quot;</span><span class="p">,</span> <span class="n">unitt</span><span class="o">=</span><span class="s2">&quot;CHORD NO&quot;</span><span class="p">,</span>
                                             <span class="n">itref</span><span class="o">=</span><span class="n">itref_written</span><span class="p">,</span>
                                             <span class="n">nt</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">geom_chan</span><span class="p">),</span> <span class="n">status</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>

        <span class="n">dtype_r</span> <span class="o">=</span> <span class="s2">&quot;R   &quot;</span>
        <span class="n">comment</span> <span class="o">=</span> <span class="s2">&quot;CHORD: RADIUS&quot;</span>
        <span class="n">write_err</span><span class="p">,</span> <span class="n">itref_written</span> <span class="o">=</span> <span class="n">write_ppf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">pulse</span><span class="p">,</span> <span class="n">dda</span><span class="p">,</span> <span class="n">dtype_r</span><span class="p">,</span> <span class="n">r_coord</span><span class="p">,</span>
                                             <span class="n">time</span><span class="o">=</span><span class="n">geom_chan</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="n">comment</span><span class="p">,</span>
                                             <span class="n">unitd</span><span class="o">=</span><span class="s2">&quot;M&quot;</span><span class="p">,</span> <span class="n">unitt</span><span class="o">=</span><span class="s2">&quot;CHORD NO&quot;</span><span class="p">,</span>
                                             <span class="n">itref</span><span class="o">=</span><span class="n">itref_written</span><span class="p">,</span>
                                             <span class="n">nt</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">geom_chan</span><span class="p">),</span> <span class="n">status</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>

        <span class="n">dtype_z</span> <span class="o">=</span> <span class="s2">&quot;Z   &quot;</span>
        <span class="n">comment</span> <span class="o">=</span> <span class="s2">&quot;CHORD: HEIGHT&quot;</span>
        <span class="n">write_err</span><span class="p">,</span> <span class="n">itref_written</span> <span class="o">=</span> <span class="n">write_ppf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">pulse</span><span class="p">,</span> <span class="n">dda</span><span class="p">,</span> <span class="n">dtype_z</span><span class="p">,</span> <span class="n">z_coord</span><span class="p">,</span>
                                             <span class="n">time</span><span class="o">=</span><span class="n">geom_chan</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="n">comment</span><span class="p">,</span>
                                             <span class="n">unitd</span><span class="o">=</span><span class="s2">&quot;M&quot;</span><span class="p">,</span> <span class="n">unitt</span><span class="o">=</span><span class="s2">&quot;CHORD NO&quot;</span><span class="p">,</span>
                                             <span class="n">itref</span><span class="o">=</span><span class="n">itref_written</span><span class="p">,</span>
                                             <span class="n">nt</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">geom_chan</span><span class="p">),</span> <span class="n">status</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">write_err</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;failed to write ppf&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="mi">67</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Close PPF.&quot;</span><span class="p">)</span>
        <span class="n">err</span> <span class="o">=</span> <span class="n">close_ppf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">pulse</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">write_uid</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">code_version</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">err</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;failed to close ppf&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="mi">67</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">saved</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">data_changed</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">statusflag_changed</span> <span class="o">=</span> <span class="bp">True</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">save_kg1</span><span class="p">(</span><span class="s1">&#39;saved&#39;</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="s1">&#39; deleting scratch folder&#39;</span><span class="p">)</span>
        <span class="n">delete_files_in_folder</span><span class="p">(</span><span class="s1">&#39;./scratch&#39;</span><span class="p">)</span>
        <span class="n">delete_files_in_folder</span><span class="p">(</span><span class="s1">&#39;./saved&#39;</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="s2">&quot; {} - saved is {} - data changed is {} - status flags changed is {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">myself</span><span class="p">(),</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">saved</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">data_changed</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">statusflag_changed</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui_areyousure</span><span class="o">.</span><span class="n">pushButton_YES</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">areyousure_window</span><span class="o">.</span><span class="n">hide</span><span class="p">()</span>
        <span class="c1">#</span>
        <span class="k">return</span> <span class="n">return_code</span></div>

    <span class="c1"># ------------------------</span>
    <span class="nd">@QtCore.pyqtSlot</span><span class="p">()</span>
<div class="viewcode-block" id="CORMAT_GUI.handle_save_statusflag"><a class="viewcode-back" href="../Cormat_main.html#Cormat_main.CORMAT_GUI.handle_save_statusflag">[docs]</a>    <span class="k">def</span> <span class="nf">handle_save_statusflag</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        function that uses ppfssf inside ppf library (ATTENTION this function is not listed yet in the ppf library python documentation (only C++ version)</span>
<span class="sd">        :return: 0 if success</span>
<span class="sd">                 68 if fails to write status flags</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">return_code</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">checkStatuFlags</span><span class="p">()</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="s2">&quot;saving data to PPF using this SF list {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">SF_list</span><span class="p">))</span>
        <span class="c1"># Initialise PPF system</span>
        <span class="n">ier</span> <span class="o">=</span> <span class="n">ppfgo</span><span class="p">(</span><span class="n">pulse</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">pulse</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">ier</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">68</span>

        <span class="c1"># Set UID</span>
        <span class="n">ppfuid</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">write_uid</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">chan</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">density</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">dtype_lid</span> <span class="o">=</span> <span class="s2">&quot;LID{}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">chan</span><span class="p">)</span>
            <span class="c1"># if self.data.val_seq &lt;0:</span>

            <span class="p">(</span><span class="n">write_err</span><span class="p">,)</span> <span class="o">=</span> <span class="n">ppfssf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">pulse</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">val_seq</span><span class="p">,</span> <span class="s1">&#39;KG1V&#39;</span><span class="p">,</span> <span class="n">dtype_lid</span><span class="p">,</span>
                                  <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">SF_list</span><span class="p">[</span><span class="n">chan</span> <span class="o">-</span> <span class="mi">1</span><span class="p">])</span>


            <span class="k">if</span> <span class="n">write_err</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
                    <span class="s2">&quot;Failed to write {}/{} status flag. Errorcode {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                        <span class="s1">&#39;KG1V&#39;</span><span class="p">,</span> <span class="n">dtype_lid</span><span class="p">,</span>
                        <span class="n">write_err</span><span class="p">))</span>
                <span class="k">break</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
                    <span class="s2">&quot;Status Flag {} written to {}/{} &quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">SF_list</span><span class="p">[</span><span class="n">chan</span> <span class="o">-</span> <span class="mi">1</span><span class="p">],</span>
                        <span class="s1">&#39;KG1V&#39;</span><span class="p">,</span> <span class="n">dtype_lid</span><span class="p">,</span>
                        <span class="p">))</span>
        <span class="c1"># logger.info(&quot;Close PPF.&quot;)</span>
        <span class="c1"># err = close_ppf(self.data.pulse, self.write_uid,</span>
        <span class="c1">#                 self.data.constants.code_version)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ui_areyousure</span><span class="o">.</span><span class="n">pushButton_YES</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">areyousure_window</span><span class="o">.</span><span class="n">hide</span><span class="p">()</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;     Status flags written to ppf.&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">saved</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="n">data_change</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">statusflag_changed</span> <span class="o">=</span> <span class="bp">True</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">save_kg1</span><span class="p">(</span><span class="s1">&#39;saved&#39;</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="s1">&#39; deleting scratch folder&#39;</span><span class="p">)</span>
        <span class="n">delete_files_in_folder</span><span class="p">(</span><span class="s1">&#39;./scratch&#39;</span><span class="p">)</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span>
                   <span class="s2">&quot; {} - saved is {} - data changed is {} - status flags changed is {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                       <span class="n">myself</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">saved</span><span class="p">,</span>
                       <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">data_changed</span><span class="p">,</span>
                       <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">statusflag_changed</span><span class="p">))</span>
        <span class="n">delete_files_in_folder</span><span class="p">(</span><span class="s1">&#39;./saved&#39;</span><span class="p">)</span>


        <span class="k">return</span> <span class="n">return_code</span></div>

<span class="c1"># ------------------------</span>
    <span class="nd">@QtCore.pyqtSlot</span><span class="p">()</span>
<div class="viewcode-block" id="CORMAT_GUI.handle_normalizebutton"><a class="viewcode-back" href="../Cormat_main.html#Cormat_main.CORMAT_GUI.handle_normalizebutton">[docs]</a>    <span class="k">def</span> <span class="nf">handle_normalizebutton</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        function that normalises the second trace to KG1 for comparing purposes during validation and fringe correction</span>
<span class="sd">        :return:</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">s2ndtrace</span> <span class="o">==</span> <span class="s1">&#39;None&#39;</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39; Normalizing&#39;</span><span class="p">)</span>
            <span class="n">snd</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sender</span><span class="p">()</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID1</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID1</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID2</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID2</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID3</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID3</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID4</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID4</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID5</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID5</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID6</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID6</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID7</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID7</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID8</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID8</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>

            <span class="n">heights</span> <span class="o">=</span> <span class="p">[</span><span class="mi">4</span><span class="p">]</span>
            <span class="n">gs</span> <span class="o">=</span> <span class="n">gridspec</span><span class="o">.</span><span class="n">GridSpec</span><span class="p">(</span><span class="n">ncols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">height_ratios</span><span class="o">=</span><span class="n">heights</span><span class="p">)</span>
            <span class="n">heights1</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
            <span class="n">gs1</span> <span class="o">=</span> <span class="n">gridspec</span><span class="o">.</span><span class="n">GridSpec</span><span class="p">(</span><span class="n">ncols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">nrows</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">height_ratios</span><span class="o">=</span><span class="n">heights1</span><span class="p">)</span>

            <span class="n">ax1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID1</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

            <span class="n">ax2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID2</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

            <span class="n">ax3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID3</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

            <span class="n">ax4</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID4</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

            <span class="n">ax5</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID5</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs1</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">ax51</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID5</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs1</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">sharex</span><span class="o">=</span><span class="n">ax5</span><span class="p">)</span>

            <span class="n">ax6</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID6</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs1</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">ax61</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID6</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs1</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">sharex</span><span class="o">=</span><span class="n">ax6</span><span class="p">)</span>

            <span class="n">ax7</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID7</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs1</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">ax71</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID7</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs1</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">sharex</span><span class="o">=</span><span class="n">ax7</span><span class="p">)</span>

            <span class="n">ax8</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID8</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs1</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">ax81</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID8</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs1</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">sharex</span><span class="o">=</span><span class="n">ax8</span><span class="p">)</span>

            <span class="c1"># ax_all = self.widget_LID_ALL.figure.add_subplot(gs[0])</span>
            <span class="c1"># ax_14 = self.widget_LID_14.figure.add_subplot(gs[0])</span>
            <span class="c1"># ax_58 = self.widget_LID_58.figure.add_subplot(gs[0])</span>
            <span class="c1">#</span>
            <span class="c1"># ax_mir = self.widget_MIR.figure.add_subplot(gs[0])</span>
            <span class="c1"># ax_mir = self.widget_MIR.figure.add_subplot(gs[0])</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">s2ndtrace</span> <span class="o">==</span> <span class="s1">&#39;HRTS&#39;</span><span class="p">:</span>
                <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;orange&#39;</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">s2ndtrace</span> <span class="o">==</span> <span class="s1">&#39;Lidar&#39;</span><span class="p">:</span>
                <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;green&#39;</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">s2ndtrace</span> <span class="o">==</span> <span class="s1">&#39;Far&#39;</span><span class="p">:</span>
                <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;red&#39;</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">s2ndtrace</span> <span class="o">==</span> <span class="s1">&#39;CM&#39;</span><span class="p">:</span>
                <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;purple&#39;</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">s2ndtrace</span> <span class="o">==</span> <span class="s1">&#39;KG1_RT&#39;</span><span class="p">:</span>
                <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;brown&#39;</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">s2ndtrace</span> <span class="o">==</span> <span class="s1">&#39;BremS&#39;</span><span class="p">:</span>
                <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;grey&#39;</span>

            <span class="c1"># for every channel in KG1 (8 channels)</span>

            <span class="k">for</span> <span class="n">chan</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">density</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="n">ax_name</span> <span class="o">=</span> <span class="s1">&#39;ax&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">chan</span><span class="p">)</span>
                <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;LID&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">chan</span><span class="p">)</span>
                <span class="nb">vars</span><span class="p">()[</span><span class="n">ax_name</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">density</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">time</span><span class="p">,</span>
                                     <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">density</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">,</span>
                                     <span class="c1"># kg1_norm</span>
                                     <span class="n">label</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span>
                                     <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;None&#39;</span><span class="p">)</span>
                <span class="nb">vars</span><span class="p">()[</span><span class="n">ax_name</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

                <span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">s2ndtrace</span> <span class="o">+</span> <span class="s1">&#39; ch.&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">chan</span><span class="p">)</span>
                <span class="nb">vars</span><span class="p">()[</span><span class="n">ax_name</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">secondtrace_original</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">time</span><span class="p">,</span>
                                     <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">secondtrace_norm</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">,</span>
                                     <span class="n">label</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span>
                                     <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
                <span class="nb">vars</span><span class="p">()[</span><span class="n">ax_name</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
                <span class="c1"># self.widget_LID1.draw()</span>

                <span class="k">if</span> <span class="n">chan</span> <span class="o">&gt;</span> <span class="mi">4</span><span class="p">:</span>
                    <span class="c1"># channels 5-8 have mirror movement</span>
                    <span class="n">name1</span> <span class="o">=</span> <span class="s1">&#39;MIR&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">chan</span><span class="p">)</span>
                    <span class="n">ax_name1</span> <span class="o">=</span> <span class="s1">&#39;ax&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">chan</span><span class="p">)</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
                    <span class="nb">vars</span><span class="p">()[</span><span class="n">ax_name1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">vibration</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">time</span><span class="p">,</span>
                                          <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">vibration</span><span class="p">[</span>
                                              <span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">data</span> <span class="o">*</span> <span class="mf">1e6</span><span class="p">,</span>
                                          <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">name1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span>
                                          <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;None&#39;</span><span class="p">)</span>
                    <span class="nb">vars</span><span class="p">()[</span><span class="n">ax_name1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

            <span class="c1"># update canvas</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID1</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID2</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID3</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID4</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID5</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID6</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID7</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID8</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
            <span class="c1"># self.widget_LID_14.draw()</span>
            <span class="c1"># self.widget_LID_ALL.draw()</span>
            <span class="c1"># self.widget_LID_58.draw()</span>
            <span class="c1"># self.widget_MIR.draw()</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39; signals have been normalized&#39;</span><span class="p">)</span></div>

    <span class="c1"># ------------------------</span>
<div class="viewcode-block" id="CORMAT_GUI.handle_button_restore"><a class="viewcode-back" href="../Cormat_main.html#Cormat_main.CORMAT_GUI.handle_button_restore">[docs]</a>    <span class="k">def</span> <span class="nf">handle_button_restore</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        function that restores signals to original amplitude</span>
<span class="sd">        :return:</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">s2ndtrace</span> <span class="o">==</span> <span class="s1">&#39;None&#39;</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;restoring signals to original amplitude&#39;</span><span class="p">)</span>
            <span class="n">snd</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sender</span><span class="p">()</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID1</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID1</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID2</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID2</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID3</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID3</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID4</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID4</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID5</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID5</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID6</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID6</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID7</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID7</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID8</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID8</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>

            <span class="n">heights</span> <span class="o">=</span> <span class="p">[</span><span class="mi">4</span><span class="p">]</span>
            <span class="n">gs</span> <span class="o">=</span> <span class="n">gridspec</span><span class="o">.</span><span class="n">GridSpec</span><span class="p">(</span><span class="n">ncols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">height_ratios</span><span class="o">=</span><span class="n">heights</span><span class="p">)</span>
            <span class="n">heights1</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
            <span class="n">gs1</span> <span class="o">=</span> <span class="n">gridspec</span><span class="o">.</span><span class="n">GridSpec</span><span class="p">(</span><span class="n">ncols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">nrows</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">height_ratios</span><span class="o">=</span><span class="n">heights1</span><span class="p">)</span>

            <span class="n">ax1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID1</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

            <span class="n">ax2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID2</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

            <span class="n">ax3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID3</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

            <span class="n">ax4</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID4</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

            <span class="n">ax5</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID5</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs1</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">ax51</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID5</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs1</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">sharex</span><span class="o">=</span><span class="n">ax5</span><span class="p">)</span>

            <span class="n">ax6</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID6</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs1</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">ax61</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID6</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs1</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">sharex</span><span class="o">=</span><span class="n">ax6</span><span class="p">)</span>

            <span class="n">ax7</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID7</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs1</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">ax71</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID7</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs1</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">sharex</span><span class="o">=</span><span class="n">ax7</span><span class="p">)</span>

            <span class="n">ax8</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID8</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs1</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">ax81</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID8</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs1</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">sharex</span><span class="o">=</span><span class="n">ax8</span><span class="p">)</span>

            <span class="c1"># ax_all = self.widget_LID_ALL.figure.add_subplot(gs[0])</span>
            <span class="c1"># ax_14 = self.widget_LID_14.figure.add_subplot(gs[0])</span>
            <span class="c1"># ax_58 = self.widget_LID_58.figure.add_subplot(gs[0])</span>
            <span class="c1">#</span>
            <span class="c1"># ax_mir = self.widget_MIR.figure.add_subplot(gs[0])</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">s2ndtrace</span> <span class="o">==</span> <span class="s1">&#39;HRTS&#39;</span><span class="p">:</span>
                <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;orange&#39;</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">s2ndtrace</span> <span class="o">==</span> <span class="s1">&#39;Lidar&#39;</span><span class="p">:</span>
                <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;green&#39;</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">s2ndtrace</span> <span class="o">==</span> <span class="s1">&#39;Far&#39;</span><span class="p">:</span>
                <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;red&#39;</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">s2ndtrace</span> <span class="o">==</span> <span class="s1">&#39;CM&#39;</span><span class="p">:</span>
                <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;purple&#39;</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">s2ndtrace</span> <span class="o">==</span> <span class="s1">&#39;KG1_RT&#39;</span><span class="p">:</span>
                <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;brown&#39;</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">s2ndtrace</span> <span class="o">==</span> <span class="s1">&#39;BremS&#39;</span><span class="p">:</span>
                <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;grey&#39;</span>
            <span class="c1"># for every channel in KG1 (8 channels)</span>

            <span class="k">for</span> <span class="n">chan</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">density</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="n">ax_name</span> <span class="o">=</span> <span class="s1">&#39;ax&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">chan</span><span class="p">)</span>
                <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;LID&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">chan</span><span class="p">)</span>
                <span class="nb">vars</span><span class="p">()[</span><span class="n">ax_name</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">density</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">time</span><span class="p">,</span>
                                     <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">density</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">,</span>
                                     <span class="n">label</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span>
                                     <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;None&#39;</span><span class="p">)</span>
                <span class="nb">vars</span><span class="p">()[</span><span class="n">ax_name</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

                <span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">s2ndtrace</span> <span class="o">+</span> <span class="s1">&#39; ch.&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">chan</span><span class="p">)</span>
                <span class="nb">vars</span><span class="p">()[</span><span class="n">ax_name</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">secondtrace_original</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">time</span><span class="p">,</span>
                                     <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">secondtrace_original</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">,</span>
                                     <span class="n">label</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span>
                                     <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
                <span class="nb">vars</span><span class="p">()[</span><span class="n">ax_name</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
                <span class="c1"># self.widget_LID1.draw()</span>

                <span class="k">if</span> <span class="n">chan</span> <span class="o">&gt;</span> <span class="mi">4</span><span class="p">:</span>
                    <span class="c1"># channels 5-8 have mirror movement</span>
                    <span class="n">name1</span> <span class="o">=</span> <span class="s1">&#39;MIR&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">chan</span><span class="p">)</span>
                    <span class="n">ax_name1</span> <span class="o">=</span> <span class="s1">&#39;ax&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">chan</span><span class="p">)</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
                    <span class="nb">vars</span><span class="p">()[</span><span class="n">ax_name1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">vibration</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">time</span><span class="p">,</span>
                                          <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">vibration</span><span class="p">[</span>
                                              <span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">data</span> <span class="o">*</span> <span class="mf">1e6</span><span class="p">,</span>
                                          <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">name1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span>
                                          <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;None&#39;</span><span class="p">)</span>
                    <span class="nb">vars</span><span class="p">()[</span><span class="n">ax_name1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

            <span class="c1"># update canvas</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID1</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID2</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID3</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID4</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID5</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID6</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID7</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID8</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
            <span class="c1"># self.widget_LID_14.draw()</span>
            <span class="c1"># self.widget_LID_ALL.draw()</span>
            <span class="c1"># self.widget_LID_58.draw()</span>
            <span class="c1"># self.widget_MIR.draw()</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;signals have been restored&#39;</span><span class="p">)</span></div>





<span class="c1"># # ------------------------</span>
<div class="viewcode-block" id="CORMAT_GUI.handle_makepermbutton"><a class="viewcode-back" href="../Cormat_main.html#Cormat_main.CORMAT_GUI.handle_makepermbutton">[docs]</a>    <span class="k">def</span> <span class="nf">handle_makepermbutton</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        function that makes permanent last correction</span>
<span class="sd">        store data into FC dtype only</span>


<span class="sd">        :return:</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">chan</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">chan</span>
        <span class="c1">#if correction is not empty than proceed</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">density</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">corrections</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="c1">#check if the corrections applied are already stored, if so overwrite</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">density</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">corrections</span><span class="o">.</span><span class="n">time</span><span class="p">):</span>
                <span class="n">found</span><span class="p">,</span> <span class="n">index</span> <span class="o">=</span> <span class="n">find_in_list_array</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">fj_dcn</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">time</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">found</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">fj_dcn</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">density</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">corrections</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">fj_dcn</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">time</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">fj_dcn</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">time</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">density</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">corrections</span><span class="o">.</span><span class="n">time</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">fj_dcn</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">fj_dcn</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">density</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">corrections</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
            <span class="c1">#emptying corrections</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">density</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">corrections</span> <span class="o">=</span> <span class="n">SignalBase</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">constants</span><span class="p">)</span>


            <span class="n">index</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">fj_dcn</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">time</span><span class="p">)),</span><span class="n">key</span><span class="o">=</span> <span class="k">lambda</span> <span class="n">k</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">fj_dcn</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">time</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">fj_dcn</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> \
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">fj_dcn</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">fj_dcn</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">time</span> <span class="o">=</span> \
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">fj_dcn</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">time</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">setcoord</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chan</span><span class="p">,</span> <span class="n">reset</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">chan</span> <span class="o">&gt;</span><span class="mi">4</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">chan</span> <span class="o">+</span> <span class="mi">4</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">fj_dcn</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">density</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">corrections</span><span class="o">.</span><span class="n">time</span><span class="p">):</span>
                    <span class="n">found</span><span class="p">,</span> <span class="n">index</span> <span class="o">=</span> <span class="n">find_in_list_array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">fj_dcn</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">time</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">found</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">fj_dcn</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> \
                        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">density</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">corrections</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">fj_dcn</span><span class="p">[</span><span class="n">chan</span><span class="o">+</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">time</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">fj_dcn</span><span class="p">[</span><span class="n">chan</span><span class="o">+</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">time</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">density</span><span class="p">[</span><span class="n">chan</span><span class="o">+</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">corrections</span><span class="o">.</span><span class="n">time</span><span class="p">)</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">fj_dcn</span><span class="p">[</span><span class="n">chan</span><span class="o">+</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">fj_dcn</span><span class="p">[</span><span class="n">chan</span><span class="o">+</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">density</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">corrections</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">density</span><span class="p">[</span><span class="n">chan</span><span class="o">+</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">corrections</span> <span class="o">=</span> <span class="n">SignalBase</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">constants</span><span class="p">)</span>
                <span class="c1"># self.data.KG1_data.density[chan + 4].corrections.time = []</span>
                <span class="c1"># self.data.KG1_data.density[chan + 4].corrections.data = []</span>

                <span class="n">index</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">fj_dcn</span><span class="p">[</span><span class="n">chan</span><span class="o">+</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">time</span><span class="p">)),</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">k</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">fj_dcn</span><span class="p">[</span><span class="n">chan</span><span class="o">+</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">time</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">fj_dcn</span><span class="p">[</span><span class="n">chan</span><span class="o">+</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">fj_dcn</span><span class="p">[</span><span class="n">chan</span><span class="o">+</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>

            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;marking correction as permanent&#39;</span><span class="p">)</span></div>
    <span class="c1"># --------------------------</span>
<div class="viewcode-block" id="CORMAT_GUI.check_current_tab"><a class="viewcode-back" href="../Cormat_main.html#Cormat_main.CORMAT_GUI.check_current_tab">[docs]</a>    <span class="k">def</span> <span class="nf">check_current_tab</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        returns current tab</span>
<span class="sd">        :return: current tab</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">QTabWidget</span><span class="o">.</span><span class="n">currentWidget</span><span class="p">()</span></div>


<div class="viewcode-block" id="CORMAT_GUI.keyPressEvent"><a class="viewcode-back" href="../Cormat_main.html#Cormat_main.CORMAT_GUI.keyPressEvent">[docs]</a>    <span class="k">def</span> <span class="nf">keyPressEvent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        keyboard events that enable actions are:</span>

<span class="sd">        . starts single correction mode</span>
<span class="sd">        m stats multiple correction mode</span>
<span class="sd">        \ starts zeroing</span>
<span class="sd">        n starts neutralisation mode</span>


<span class="sd">        :param event: keyboard event</span>
<span class="sd">        :return:</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">ax</span><span class="p">,</span> <span class="n">widget</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">which_tab</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">key</span><span class="p">()</span> <span class="o">==</span> <span class="n">Qt</span><span class="o">.</span><span class="n">Key_Period</span><span class="p">:</span>
            <span class="n">widget</span><span class="o">.</span><span class="n">blockSignals</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="s2">&quot;{} has been pressed&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">text</span><span class="p">()))</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;single correction mode&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_mancorr</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">getcorrectionpointwidget</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">kb</span><span class="o">.</span><span class="n">apply_pressed_signal</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">singlecorrection</span><span class="p">)</span>

        <span class="k">elif</span> <span class="n">event</span><span class="o">.</span><span class="n">key</span><span class="p">()</span> <span class="o">==</span> <span class="n">Qt</span><span class="o">.</span><span class="n">Key_M</span><span class="p">:</span>
            <span class="n">widget</span><span class="o">.</span><span class="n">blockSignals</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="s2">&quot;{} has been pressed&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">text</span><span class="p">()))</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;multi correction mode&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_mancorr</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">getmultiplecorrectionpointswidget</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">kb</span><span class="o">.</span><span class="n">apply_pressed_signal</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">multiplecorrections</span><span class="p">)</span>

        <span class="k">elif</span> <span class="n">event</span><span class="o">.</span><span class="n">key</span><span class="p">()</span> <span class="o">==</span> <span class="n">Qt</span><span class="o">.</span><span class="n">Key_N</span><span class="p">:</span>
            <span class="n">widget</span><span class="o">.</span><span class="n">blockSignals</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="s2">&quot; {} has been pressed&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">text</span><span class="p">()))</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;neutralise corrections mode&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_mancorr</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">getmultiplecorrectionpointswidget</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">kb</span><span class="o">.</span><span class="n">apply_pressed_signal</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">neutralisatecorrections</span><span class="p">)</span>

        <span class="k">elif</span> <span class="n">event</span><span class="o">.</span><span class="n">key</span><span class="p">()</span> <span class="o">==</span> <span class="n">Qt</span><span class="o">.</span><span class="n">Key_Backslash</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;zeroing mode&#39;</span><span class="p">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="s2">&quot; {} has been pressed&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">text</span><span class="p">()))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">getcorrectionpointwidget</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">kb</span><span class="o">.</span><span class="n">apply_pressed_signal</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zeroingcorrection</span><span class="p">)</span>


        <span class="k">elif</span> <span class="n">event</span><span class="o">.</span><span class="n">key</span><span class="p">()</span> <span class="o">==</span> <span class="n">Qt</span><span class="o">.</span><span class="n">Key_Slash</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="s2">&quot; {} has been pressed&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">text</span><span class="p">()))</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;unzeroing mode&#39;</span><span class="p">)</span>


        <span class="k">else</span><span class="p">:</span>
            <span class="nb">super</span><span class="p">(</span><span class="n">CORMAT_GUI</span><span class="p">,</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">keyPressEvent</span><span class="p">(</span><span class="n">event</span><span class="p">)</span></div>



    <span class="c1"># ----------------------------</span>
    <span class="nd">@QtCore.pyqtSlot</span><span class="p">()</span>
<div class="viewcode-block" id="CORMAT_GUI.handle_help_menu"><a class="viewcode-back" href="../Cormat_main.html#Cormat_main.CORMAT_GUI.handle_help_menu">[docs]</a>    <span class="k">def</span> <span class="nf">handle_help_menu</span><span class="p">():</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        opens Chrome browser to read HTML documentation</span>
<span class="sd">        :return:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">import</span> <span class="nn">webbrowser</span>
        <span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;file://&#39;</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">realpath</span><span class="p">(</span><span class="s1">&#39;../docs/_build/html/index.html&#39;</span><span class="p">)</span>
        <span class="n">webbrowser</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">using</span><span class="o">=</span><span class="s1">&#39;google-chrome&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">new</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span></div>

        <span class="c1"># ----------------------------</span>

    <span class="nd">@QtCore.pyqtSlot</span><span class="p">()</span>
<div class="viewcode-block" id="CORMAT_GUI.handle_pdf_open"><a class="viewcode-back" href="../Cormat_main.html#Cormat_main.CORMAT_GUI.handle_pdf_open">[docs]</a>    <span class="k">def</span> <span class="nf">handle_pdf_open</span><span class="p">():</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        :return: opens pdf file of the guide</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">realpath</span><span class="p">(</span><span class="s1">&#39;../docs/CORMATpy_GUI_Documentation.pdf&#39;</span><span class="p">)</span>
        <span class="kn">import</span> <span class="nn">subprocess</span>

        <span class="n">subprocess</span><span class="o">.</span><span class="n">Popen</span><span class="p">([</span><span class="s1">&#39;okular&#39;</span><span class="p">,</span> <span class="nb">file</span><span class="p">])</span></div>




<span class="c1"># -------------------------------</span>
    <span class="nd">@pyqtSlot</span><span class="p">()</span>
<div class="viewcode-block" id="CORMAT_GUI.multiplecorrections"><a class="viewcode-back" href="../Cormat_main.html#Cormat_main.CORMAT_GUI.multiplecorrections">[docs]</a>    <span class="k">def</span> <span class="nf">multiplecorrections</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        this module applies multiple corrections (same fringe correction) to selected channel</span>

<span class="sd">        :return:</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">blockSignals</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ax1</span>
        <span class="n">ax2</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ax2</span>
        <span class="n">ax3</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ax3</span>
        <span class="n">ax4</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ax4</span>
        <span class="n">ax5</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ax5</span>
        <span class="n">ax6</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ax6</span>
        <span class="n">ax7</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ax7</span>
        <span class="n">ax8</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ax8</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">correction_to_be_applied</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_mancorr</span><span class="o">.</span><span class="n">text</span><span class="p">()</span> <span class="c1"># reads correction from gui</span>
        <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chan</span><span class="p">)</span><span class="o">.</span><span class="n">isdigit</span><span class="p">()</span> <span class="o">==</span> <span class="bp">True</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">chan</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chan</span><span class="p">)</span>
            <span class="n">time</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">density</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">time</span>
            <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">density</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
            <span class="n">coord</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">setcoord</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chan</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">update_channel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chan</span><span class="p">)</span>
            <span class="c1"># self.lineEdit_mancorr.setText(&quot;&quot;)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">gettotalcorrections</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pushButton_undo</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">discard_multiple_points</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">kb</span><span class="o">.</span><span class="n">apply_pressed_signal</span><span class="o">.</span><span class="n">disconnect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">multiplecorrections</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">disconnnet_multiplecorrectionpointswidget</span><span class="p">()</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">blockSignals</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chan</span><span class="p">)</span> <span class="o">&lt;</span><span class="mi">5</span><span class="p">:</span>
            <span class="n">suggested_den</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">suggestcorrection</span><span class="p">()</span> <span class="c1"># computes suggested correction</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">corr_den</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_mancorr</span><span class="o">.</span><span class="n">text</span><span class="p">())</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">DFR_DCN</span>
            <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;use numerical values&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_mancorr</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">update_channel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chan</span><span class="p">)</span>
                <span class="c1"># self.lineEdit_mancorr.setText(&quot;&quot;)</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">gettotalcorrections</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">pushButton_undo</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">discard_multiple_points</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">kb</span><span class="o">.</span><span class="n">apply_pressed_signal</span><span class="o">.</span><span class="n">disconnect</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">multiplecorrections</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">disconnnet_multiplecorrectionpointswidget</span><span class="p">()</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">blockSignals</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
                <span class="k">return</span>
            <span class="k">if</span> <span class="n">suggested_den</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">corr_den</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s1">&#39;suggested correction is different, do you wish to use it?&#39;</span><span class="p">)</span>
                <span class="n">qm</span><span class="o">.</span><span class="n">setDetailedText</span><span class="p">(</span><span class="s2">&quot;suggested correction is &quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">suggested_den</span><span class="p">))</span>
                <span class="n">ret</span> <span class="o">=</span> <span class="n">qm</span><span class="o">.</span><span class="n">question</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
                                  <span class="s2">&quot;suggested correction is different: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span>
                                      <span class="n">suggested_den</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">  Do you wish to use it?&quot;</span><span class="p">,</span>
                                  <span class="n">qm</span><span class="o">.</span><span class="n">Yes</span> <span class="o">|</span> <span class="n">qm</span><span class="o">.</span><span class="n">No</span><span class="p">)</span>
                <span class="c1"># x  = input(&#39;y/n?&#39;)</span>
                <span class="k">if</span> <span class="n">ret</span><span class="o">==</span><span class="n">qm</span><span class="o">.</span><span class="n">Yes</span><span class="p">:</span>

                <span class="c1"># x  = input(&#39;y/n?&#39;)</span>
                <span class="c1"># if x.lower() == &quot;y&quot;:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">corr_den</span> <span class="o">=</span> <span class="n">suggested_den</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">pass</span>
        <span class="k">elif</span>  <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chan</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">4</span><span class="p">:</span>
            <span class="n">suggested_den</span><span class="p">,</span> <span class="n">suggested_vib</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">suggestcorrection</span><span class="p">()</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">corr_den</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_mancorr</span><span class="o">.</span><span class="n">text</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">corr_vib</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_mancorr</span><span class="o">.</span><span class="n">text</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span>

                <span class="n">corrections</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">matrix_lat_channels</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span>
                    <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">corr_den</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">corr_vib</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">corr_den</span> <span class="o">=</span> <span class="n">corrections</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">corr_vib</span> <span class="o">=</span> <span class="n">corrections</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

            <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s1">&#39;no vibration correction&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_mancorr</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">update_channel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chan</span><span class="p">)</span>
                <span class="c1"># self.lineEdit_mancorr.setText(&quot;&quot;)</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">gettotalcorrections</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">pushButton_undo</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">discard_multiple_points</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">kb</span><span class="o">.</span><span class="n">apply_pressed_signal</span><span class="o">.</span><span class="n">disconnect</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">multiplecorrections</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">disconnnet_multiplecorrectionpointswidget</span><span class="p">()</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">blockSignals</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
                <span class="k">return</span>
            <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;use numerical values&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_mancorr</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">update_channel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chan</span><span class="p">)</span>
                <span class="c1"># self.lineEdit_mancorr.setText(&quot;&quot;)</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">gettotalcorrections</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">pushButton_undo</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">discard_multiple_points</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">kb</span><span class="o">.</span><span class="n">apply_pressed_signal</span><span class="o">.</span><span class="n">disconnect</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">multiplecorrections</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">disconnnet_multiplecorrectionpointswidget</span><span class="p">()</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">blockSignals</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
                <span class="k">return</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">suggested_den</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">corr_den</span><span class="p">)</span> <span class="o">&amp;</span> <span class="n">suggested_vib</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">corr_vib</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s1">&#39;suggested correction is different, do you wish to use it?&#39;</span><span class="p">)</span>
                <span class="n">ret</span> <span class="o">=</span> <span class="n">qm</span><span class="o">.</span><span class="n">question</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
                                  <span class="s2">&quot;suggested correction is different: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span>
                                      <span class="n">suggested_den</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;, &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span>
                                      <span class="n">suggested_vib</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">  Do you wish to use it?&quot;</span><span class="p">,</span>
                                  <span class="n">qm</span><span class="o">.</span><span class="n">Yes</span> <span class="o">|</span> <span class="n">qm</span><span class="o">.</span><span class="n">No</span><span class="p">)</span>
                <span class="c1"># x  = input(&#39;y/n?&#39;)</span>
                <span class="k">if</span> <span class="n">ret</span><span class="o">==</span><span class="n">qm</span><span class="o">.</span><span class="n">Yes</span><span class="p">:</span>
                <span class="c1"># x  = input(&#39;y/n?&#39;)</span>
                <span class="c1"># if x.lower() == &quot;y&quot;:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">corr_den</span> <span class="o">=</span> <span class="n">suggested_den</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">corr_vib</span> <span class="o">=</span> <span class="n">suggested_vib</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">pass</span>
        <span class="c1">###</span>

        <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chan</span><span class="p">)</span><span class="o">.</span><span class="n">isdigit</span><span class="p">()</span> <span class="o">==</span> <span class="bp">True</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">chan</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chan</span><span class="p">)</span>
            <span class="n">time</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">density</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">time</span>
            <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">density</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
            <span class="n">coord</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">setcoord</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chan</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">update_channel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chan</span><span class="p">)</span>
            <span class="c1"># self.lineEdit_mancorr.setText(&quot;&quot;)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">gettotalcorrections</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pushButton_undo</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">discard_multiple_points</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">kb</span><span class="o">.</span><span class="n">apply_pressed_signal</span><span class="o">.</span><span class="n">disconnect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">multiplecorrections</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">disconnnet_multiplecorrectionpointswidget</span><span class="p">()</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">blockSignals</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="c1"># try:</span>
        <span class="c1"># pyqt_set_trace()</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">coord</span><span class="p">):</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="s2">&quot;applying correction @t= {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">[</span><span class="mi">0</span><span class="p">])))</span>
            <span class="n">index</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="n">find_nearest</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">value</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span>
                       <span class="s2">&quot; found point where to apply correction at {} with index {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">index</span><span class="p">,</span>
                                                                         <span class="n">value</span><span class="p">))</span>



            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">density</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">correct_fj</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">corr_den</span> <span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">index</span>
                <span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">density</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">corrections</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                <span class="n">ax_name</span> <span class="o">=</span> <span class="s1">&#39;ax&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chan</span><span class="p">)</span>

                <span class="c1"># xposition = self.data.KG1_data.density[self.chan].corrections.time</span>
                <span class="c1"># for xc in xposition:</span>
                <span class="nb">vars</span><span class="p">()[</span><span class="n">ax_name</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">time</span><span class="p">[</span><span class="n">index</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
                <span class="nb">vars</span><span class="p">()[</span><span class="n">ax_name</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time</span><span class="p">[</span><span class="n">index</span><span class="p">],</span><span class="n">data</span><span class="p">[</span><span class="n">index</span><span class="p">],</span> <span class="s1">&#39;mo&#39;</span><span class="p">)</span>

            <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chan</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">4</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">vibration</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">correct_fj</span><span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">corr_vib</span> <span class="p">,</span>
                        <span class="n">time</span><span class="o">=</span><span class="n">value</span><span class="p">)</span>


                <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;insert a correction for the mirror&#39;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">update_channel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chan</span><span class="p">)</span>

                    <span class="bp">self</span><span class="o">.</span><span class="n">gettotalcorrections</span><span class="p">()</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">pushButton_undo</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">discard_multiple_points</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">kb</span><span class="o">.</span><span class="n">apply_pressed_signal</span><span class="o">.</span><span class="n">disconnect</span><span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">multiplecorrections</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">disconnnet_multiplecorrectionpointswidget</span><span class="p">()</span>

                    <span class="bp">self</span><span class="o">.</span><span class="n">blockSignals</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
                    <span class="k">return</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_channel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chan</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gettotalcorrections</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pushButton_undo</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">discard_multiple_points</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">kb</span><span class="o">.</span><span class="n">apply_pressed_signal</span><span class="o">.</span><span class="n">disconnect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">multiplecorrections</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">disconnnet_multiplecorrectionpointswidget</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">blockSignals</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
            <span class="s1">&#39;remember to mark corrections as permanent before proceeding!&#39;</span><span class="p">)</span>

        <span class="n">ret</span> <span class="o">=</span> <span class="n">qm_permanent</span><span class="o">.</span><span class="n">question</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
                          <span class="s2">&quot;Mark correction/s as permanent?&quot;</span><span class="p">,</span>
                                    <span class="n">qm_permanent</span><span class="o">.</span><span class="n">Yes</span> <span class="o">|</span> <span class="n">qm_permanent</span><span class="o">.</span><span class="n">No</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">ret</span> <span class="o">==</span> <span class="n">qm_permanent</span><span class="o">.</span><span class="n">Yes</span><span class="p">:</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">handle_makepermbutton</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">pass</span></div>


<span class="c1"># -------------------------------</span>
    <span class="nd">@QtCore.pyqtSlot</span><span class="p">()</span>
<div class="viewcode-block" id="CORMAT_GUI.zeroingcorrection"><a class="viewcode-back" href="../Cormat_main.html#Cormat_main.CORMAT_GUI.zeroingcorrection">[docs]</a>    <span class="k">def</span> <span class="nf">zeroingcorrection</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        this module zeroes correction on selected channel</span>

<span class="sd">        :return:</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># pyqt_set_trace()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">blockSignals</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span> <span class="c1"># signals emitted by this object are blocked</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gettotalcorrections</span><span class="p">()</span>



        <span class="n">total_den</span><span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_totcorr</span><span class="o">.</span><span class="n">text</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;applying this correction {} to zero total corrections&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="p">(</span><span class="n">total_den</span><span class="p">)))</span>
        <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chan</span><span class="p">)</span><span class="o">.</span><span class="n">isdigit</span><span class="p">()</span> <span class="o">==</span> <span class="bp">True</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">chan</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chan</span><span class="p">)</span>
            <span class="n">time</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">density</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">time</span>
            <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">density</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
            <span class="n">coord</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">setcoord</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chan</span><span class="p">)</span> <span class="c1"># get point selected from canvas</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">update_channel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chan</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pushButton_undo</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">unzerocorrection</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">kb</span><span class="o">.</span><span class="n">apply_pressed_signal</span><span class="o">.</span><span class="n">disconnect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zeroingcorrection</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">blockSignals</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chan</span><span class="p">)</span> <span class="o">&lt;</span><span class="mi">5</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">corr_den</span> <span class="o">=</span> <span class="o">-</span><span class="nb">int</span><span class="p">(</span><span class="n">total_den</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">DFR_DCN</span> <span class="c1"># convert fringe jump into density</span>
            <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span> <span class="c1">#check if self.coor_den is a number</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;use numerical values&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_totcorr</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">update_channel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chan</span><span class="p">)</span> <span class="c1">#update data and canvas</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;applying this correction {} &#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="p">(</span><span class="n">total_den</span><span class="p">)))</span>

                <span class="c1"># self.pushButton_undo.disconnect()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">gettotalcorrections</span><span class="p">()</span> <span class="c1"># compute total correction</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">pushButton_undo</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">unzerocorrection</span><span class="p">)</span> <span class="c1"># connect undo button to slot to undo single correction</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">kb</span><span class="o">.</span><span class="n">apply_pressed_signal</span><span class="o">.</span><span class="n">disconnect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zeroingcorrection</span><span class="p">)</span> <span class="c1"># disconnect slot</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">blockSignals</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
                <span class="k">return</span>
        <span class="k">elif</span>  <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chan</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">4</span><span class="p">:</span>

            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">corr_den</span> <span class="o">=</span> <span class="o">-</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_mancorr</span><span class="o">.</span><span class="n">text</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">corr_vib</span> <span class="o">=</span> <span class="o">-</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_mancorr</span><span class="o">.</span><span class="n">text</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span>

                <span class="n">corrections</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">matrix_lat_channels</span><span class="o">.</span><span class="n">dot</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">corr_den</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">corr_vib</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">corr_den</span> <span class="o">=</span> <span class="n">corrections</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">corr_vib</span> <span class="o">=</span> <span class="n">corrections</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

            <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s1">&#39;no vibration correction&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_totcorr</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">update_channel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chan</span><span class="p">)</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;applying this correction {} &#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_totcorr</span><span class="o">.</span><span class="n">text</span><span class="p">())))</span>

                <span class="c1"># self.pushButton_undo.disconnect()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">gettotalcorrections</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">pushButton_undo</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">unzerocorrection</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">kb</span><span class="o">.</span><span class="n">apply_pressed_signal</span><span class="o">.</span><span class="n">disconnect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zeroingcorrection</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">blockSignals</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
                <span class="k">return</span>
            <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;use numerical values&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_totcorr</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">update_channel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chan</span><span class="p">)</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;applying this correction {} &#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_totcorr</span><span class="o">.</span><span class="n">text</span><span class="p">())))</span>

                <span class="c1"># self.pushButton_undo.disconnect()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">gettotalcorrections</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">pushButton_undo</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">unzerocorrection</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">kb</span><span class="o">.</span><span class="n">apply_pressed_signal</span><span class="o">.</span><span class="n">disconnect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zeroingcorrection</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">blockSignals</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
                <span class="k">return</span>



        <span class="n">index</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="n">find_nearest</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">coord</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="c1"># finds nearest data point to selected point on canvas</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">density</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">correct_fj</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">corr_den</span> <span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">)</span> <span class="c1"># correct data</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">density</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">corrections</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>


            <span class="n">xc</span> <span class="o">=</span> <span class="n">coord</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
            <span class="c1"># for xc in xposition:</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">ax1</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">xc</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xc</span><span class="p">,</span><span class="n">coord</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;ro&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ax2</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">xc</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xc</span><span class="p">,</span><span class="n">coord</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;ro&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ax3</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">xc</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ax3</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xc</span><span class="p">,</span><span class="n">coord</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;ro&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ax4</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">xc</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ax4</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xc</span><span class="p">,</span><span class="n">coord</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;ro&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ax5</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">xc</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ax5</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xc</span><span class="p">,</span><span class="n">coord</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;ro&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ax6</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">xc</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ax6</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xc</span><span class="p">,</span><span class="n">coord</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;ro&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ax7</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">xc</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ax7</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xc</span><span class="p">,</span><span class="n">coord</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;ro&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ax8</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">xc</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ax8</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xc</span><span class="p">,</span><span class="n">coord</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;ro&#39;</span><span class="p">)</span>


        <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chan</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">4</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">vibration</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">correct_fj</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">corr_vib</span> <span class="p">,</span>
                    <span class="n">time</span><span class="o">=</span><span class="n">value</span><span class="p">)</span>


            <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;insert a correction for the mirror&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">update_channel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chan</span><span class="p">)</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;applying this correction {} &#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_totcorr</span><span class="o">.</span><span class="n">text</span><span class="p">())))</span>

                <span class="c1"># self.pushButton_undo.disconnect()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">gettotalcorrections</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">pushButton_undo</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">unzerocorrection</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">kb</span><span class="o">.</span><span class="n">apply_pressed_signal</span><span class="o">.</span><span class="n">disconnect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zeroingcorrection</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">blockSignals</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
                <span class="k">return</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_channel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chan</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;applied this correction {} &#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_totcorr</span><span class="o">.</span><span class="n">text</span><span class="p">())))</span>

        <span class="c1"># self.pushButton_undo.disconnect()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gettotalcorrections</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pushButton_undo</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">unzerocorrection</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">kb</span><span class="o">.</span><span class="n">apply_pressed_signal</span><span class="o">.</span><span class="n">disconnect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zeroingcorrection</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">blockSignals</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
            <span class="s1">&#39;remember to mark corrections as permanent before proceeding!&#39;</span><span class="p">)</span>
        <span class="n">ret</span> <span class="o">=</span> <span class="n">qm_permanent</span><span class="o">.</span><span class="n">question</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
                          <span class="s2">&quot;Mark correction/s as permanent?&quot;</span><span class="p">,</span>
                                    <span class="n">qm_permanent</span><span class="o">.</span><span class="n">Yes</span> <span class="o">|</span> <span class="n">qm_permanent</span><span class="o">.</span><span class="n">No</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">ret</span> <span class="o">==</span> <span class="n">qm_permanent</span><span class="o">.</span><span class="n">Yes</span><span class="p">:</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">handle_makepermbutton</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">pass</span></div>


    <span class="c1"># -------------------------------</span>
    <span class="nd">@QtCore.pyqtSlot</span><span class="p">()</span>
<div class="viewcode-block" id="CORMAT_GUI.neutralisatecorrections"><a class="viewcode-back" href="../Cormat_main.html#Cormat_main.CORMAT_GUI.neutralisatecorrections">[docs]</a>    <span class="k">def</span> <span class="nf">neutralisatecorrections</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        module that neutralises permanent corretions</span>

<span class="sd">        first the code will process manual corrections not made permanent yet</span>

<span class="sd">        then the code will process automatic corrections produced by hardware and stored inside KG1V/FCx</span>

<span class="sd">        :return:</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">blockSignals</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
        <span class="n">ax1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax1</span>
        <span class="n">ax2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax2</span>
        <span class="n">ax3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax3</span>
        <span class="n">ax4</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax4</span>
        <span class="n">ax5</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax5</span>
        <span class="n">ax6</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax6</span>
        <span class="n">ax7</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax7</span>
        <span class="n">ax8</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax8</span>
        <span class="n">ax_name</span> <span class="o">=</span> <span class="s1">&#39;ax&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chan</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chan</span><span class="p">)</span><span class="o">.</span><span class="n">isdigit</span><span class="p">()</span> <span class="o">==</span> <span class="bp">True</span><span class="p">:</span> <span class="c1"># if chan is 1-8 then</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">chan</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chan</span><span class="p">)</span>
            <span class="n">time</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">density</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">time</span> <span class="c1"># get time data</span>
            <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">density</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">data</span> <span class="c1"># get density data</span>
            <span class="n">coord</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">setcoord</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chan</span><span class="p">)</span> <span class="c1"># get points selected by user</span>
        <span class="k">else</span><span class="p">:</span><span class="c1">#the user has run the Neutralise event not on a 1-8 tab</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">update_channel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chan</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">gettotalcorrections</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pushButton_undo</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">discard_neutralise_corrections</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">kb</span><span class="o">.</span><span class="n">apply_pressed_signal</span><span class="o">.</span><span class="n">disconnect</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">neutralisatecorrections</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">disconnnet_neutralisepointswidget</span><span class="p">()</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">blockSignals</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="c1"># get coordinates seletecte by user</span>
        <span class="n">min_coord</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">coord</span><span class="p">)</span>
        <span class="n">max_coord</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">coord</span><span class="p">)</span>


        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">density</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">corrections</span><span class="o">.</span><span class="n">data</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span> <span class="c1"># if there are no manual corrections (yet) - skip</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">update_channel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chan</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gettotalcorrections</span><span class="p">()</span>


        <span class="k">else</span><span class="p">:</span>
            <span class="c1">#find time values and indexes of corrections within selected range</span>
            <span class="n">indexes_manual</span><span class="p">,</span> <span class="n">values_manual</span> <span class="o">=</span> <span class="n">find_within_range</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">density</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">corrections</span><span class="o">.</span><span class="n">time</span><span class="p">,</span>
                <span class="n">min_coord</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">max_coord</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="c1"># get time data and indexes of manual corrections</span>
            <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">indexes_manual</span><span class="p">):</span><span class="c1"># if there are no manual correction in the selected interval skip</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">update_channel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chan</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">gettotalcorrections</span><span class="p">()</span>

            <span class="k">else</span><span class="p">:</span>

                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">density</span><span class="p">[</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">corrections</span><span class="o">.</span><span class="n">time</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span> <span class="c1"># if there are corrections in that range</span>

                    <span class="n">corrections_manual</span> <span class="o">=</span> \
                    <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">density</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">corrections</span><span class="o">.</span><span class="n">data</span><span class="p">[</span>
                        <span class="n">indexes_manual</span><span class="p">]</span>
                    <span class="c1">#change sign</span>
                    <span class="n">corrections_manual_inverted</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span>
                                                   <span class="n">corrections_manual</span><span class="p">]</span>

                    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;applying this neutralaisation at {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                        <span class="n">corrections_manual_inverted</span><span class="p">))</span>

                    <span class="c1">#iterate corrections</span>
                    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">values_manual</span><span class="p">):</span>
                        <span class="c1">#find times of correction and index inside time vector</span>
                        <span class="n">index</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="n">find_nearest</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

                        <span class="bp">self</span><span class="o">.</span><span class="n">corr_den</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">corrections_manual_inverted</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>

                        <span class="n">time_corr</span> <span class="o">=</span> <span class="n">values_manual</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>



                        <span class="n">logger</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span>
                                   <span class="s2">&quot; found point where to neutralise correction @t= {} with index {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                                       <span class="n">value</span><span class="p">,</span>
                                       <span class="n">index</span><span class="p">))</span>
                        <span class="c1">#apply correction</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">density</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">correct_fj</span><span class="p">(</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">corr_den</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">DFR_DCN</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">index</span>
                        <span class="p">)</span>

                        <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chan</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">4</span><span class="p">:</span> <span class="c1">#if is a lateral channel</span>
                            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">chan</span><span class="o">+</span><span class="mi">4</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">fj_dcn</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span> <span class="c1"># if there are automatic corrections in the vibration signal</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">corr_vib</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">density</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">chan</span><span class="o">+</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">corrections</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
                            <span class="k">else</span><span class="p">:</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">corr_vib</span> <span class="o">=</span> <span class="mi">0</span>

                            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">vibration</span><span class="p">[</span>
                                    <span class="bp">self</span><span class="o">.</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">correct_fj</span><span class="p">(</span>
                                    <span class="bp">self</span><span class="o">.</span><span class="n">corr_vib</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">DFR_DCN</span><span class="p">,</span>
                                    <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">)</span>

                        <span class="nb">vars</span><span class="p">()[</span><span class="n">ax_name</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">value</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">,</span>
                                                <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>



                    <span class="n">indexes_manual</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">indexes_manual</span><span class="p">]</span> <span class="c1"># first line is kg1 data!</span>
                    <span class="k">for</span> <span class="n">jj</span><span class="p">,</span> <span class="n">ind</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">reversed</span><span class="p">(</span><span class="n">indexes_manual</span><span class="p">)):</span>
                        <span class="c1"># print(jj,ind)</span>
                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">chan</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                            <span class="c1"># del self.ax1.lines[-(len(self.ax1.lines)):-1]</span>
                            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax1</span><span class="o">.</span><span class="n">lines</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span>
                            <span class="c1"># del self.ax1.lines[1:]</span>
                        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">chan</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax2</span><span class="o">.</span><span class="n">lines</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span>
                        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">chan</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
                            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax3</span><span class="o">.</span><span class="n">lines</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span>
                        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">chan</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
                            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax4</span><span class="o">.</span><span class="n">lines</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span>
                        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">chan</span> <span class="o">==</span> <span class="mi">5</span><span class="p">:</span>
                            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax5</span><span class="o">.</span><span class="n">lines</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span>
                        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">chan</span> <span class="o">==</span> <span class="mi">6</span><span class="p">:</span>
                            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax6</span><span class="o">.</span><span class="n">lines</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span>
                        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">chan</span> <span class="o">==</span> <span class="mi">7</span><span class="p">:</span>
                            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax7</span><span class="o">.</span><span class="n">lines</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span>
                        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">chan</span> <span class="o">==</span> <span class="mi">8</span><span class="p">:</span>
                            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax8</span><span class="o">.</span><span class="n">lines</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span>




                <span class="bp">self</span><span class="o">.</span><span class="n">update_channel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chan</span><span class="p">)</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">gettotalcorrections</span><span class="p">()</span>





<span class="c1">#automatic correction (made by hardware)</span>





        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">fj_dcn</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">data</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="c1"># if there are not automatic correction updated channel and close event</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">update_channel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chan</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gettotalcorrections</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pushButton_undo</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">discard_neutralise_corrections</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">kb</span><span class="o">.</span><span class="n">apply_pressed_signal</span><span class="o">.</span><span class="n">disconnect</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">neutralisatecorrections</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">disconnnet_multiplecorrectionpointswidget</span><span class="p">()</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">blockSignals</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="c1">#find corrections</span>
            <span class="n">indexes_automatic</span><span class="p">,</span> <span class="n">values_automatic</span> <span class="o">=</span> <span class="n">find_within_range</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">fj_dcn</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">time</span><span class="p">,</span> <span class="n">min_coord</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                <span class="n">max_coord</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">indexes_automatic</span><span class="p">)</span>  <span class="p">:</span>
                <span class="c1">#if no correction in selected range update and close event</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">update_channel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chan</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">gettotalcorrections</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;automatic correction times {} </span><span class="se">\n</span><span class="s2"> &quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">fj_dcn</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">time</span><span class="p">[</span><span class="n">indexes_automatic</span><span class="p">]))</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">chan</span> <span class="o">&lt;</span><span class="mi">5</span><span class="p">:</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;automatic correction data {}</span><span class="se">\n</span><span class="s2"> &quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">fj_dcn</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">indexes_automatic</span><span class="p">]))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="c1">#if chan+4 is in fj_dcn means there are automatic corrections for vibration channel</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">chan</span><span class="o">+</span><span class="mi">4</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">fj_dcn</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                        <span class="c1">#find values in range</span>
                        <span class="n">indexes_automatic_vib</span><span class="p">,</span> <span class="n">values_automatic_vib</span> <span class="o">=</span> <span class="n">find_within_range</span><span class="p">(</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">fj_dcn</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">chan</span><span class="o">+</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">time</span><span class="p">,</span>
                            <span class="n">min_coord</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                            <span class="n">max_coord</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;automatic correction data {}, {}</span><span class="se">\n</span><span class="s2"> &quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">fj_dcn</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">indexes_automatic</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">fj_dcn</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">chan</span><span class="o">+</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">indexes_automatic_vib</span><span class="p">]))</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;automatic correction data {}</span><span class="se">\n</span><span class="s2"> &quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">fj_dcn</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">[</span>
                                <span class="n">indexes_automatic</span><span class="p">]))</span>

                <span class="c1">#create lists of corrections</span>
                <span class="n">corrections</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">fj_dcn</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">[</span>
                    <span class="n">indexes_automatic</span><span class="p">]</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">chan</span> <span class="o">+</span> <span class="mi">4</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">fj_dcn</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                    <span class="n">corrections_vib</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">fj_dcn</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">chan</span><span class="o">+</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">[</span>
                        <span class="n">indexes_automatic_vib</span><span class="p">]</span>

                <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">value</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">corrections</span><span class="p">):</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="s2">&quot; correction found  @ {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">values_automatic</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>


                <span class="n">corrections_inverted</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">corrections</span><span class="p">]</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;applying this {} neutralisation/s &quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="n">corrections_inverted</span><span class="p">))</span>
                <span class="c1"># iterate corrections</span>
                <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">values_automatic</span><span class="p">):</span>
                    <span class="c1">#look inside time array to find index of the correction</span>
                    <span class="n">index</span><span class="p">,</span> <span class="n">value_found</span> <span class="o">=</span> <span class="n">find_nearest</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>


                    <span class="bp">self</span><span class="o">.</span><span class="n">corr_den</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">corrections_inverted</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>

                    <span class="n">time_corr</span> <span class="o">=</span>  <span class="n">values_automatic</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>




                    <span class="n">logger</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span>
                               <span class="s2">&quot; found point where to neutralise correction @t= {} with index {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">value</span><span class="p">,</span><span class="n">index</span><span class="p">))</span>


                    <span class="c1">#for lateral channels</span>
                    <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chan</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">4</span><span class="p">:</span>
                        <span class="c1">#if there is a vibration automatic correction</span>
                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">chan</span> <span class="o">+</span> <span class="mi">4</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">fj_dcn</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                            <span class="c1">#iterate vibration correction</span>
                            <span class="k">for</span> <span class="n">j</span><span class="p">,</span><span class="n">value_vib</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">fj_dcn</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">chan</span> <span class="o">+</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">time</span><span class="p">[</span><span class="n">indexes_automatic_vib</span><span class="p">]):</span>
                                <span class="c1">#if time vibration correction is the same</span>
                                <span class="k">if</span> <span class="n">value</span> <span class="o">==</span> <span class="n">value_vib</span><span class="p">:</span>

                                    <span class="bp">self</span><span class="o">.</span><span class="n">corr_vib</span> <span class="o">=</span> <span class="o">-</span><span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">fj_dcn</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">chan</span> <span class="o">+</span> <span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">j</span><span class="p">]))</span>
                                <span class="k">else</span><span class="p">:</span>
                                    <span class="bp">self</span><span class="o">.</span><span class="n">corr_vib</span> <span class="o">=</span> <span class="mi">0</span>
                        <span class="k">else</span><span class="p">:</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">corr_vib</span> <span class="o">=</span> <span class="mi">0</span>

                        <span class="n">M</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">matrix_lat_channels</span>
                        <span class="n">neutralised_correction</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">corr_den</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">corr_vib</span><span class="p">]))</span>

                        <span class="bp">self</span><span class="o">.</span><span class="n">lid</span> <span class="o">=</span> <span class="n">neutralised_correction</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">mir</span> <span class="o">=</span> <span class="n">neutralised_correction</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

                        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">density</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">correct_fj</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lid</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">,</span><span class="n">lid</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">corr_den</span><span class="p">)</span>

                        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">vibration</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">correct_fj</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mir</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">,</span><span class="n">lid</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">corr_vib</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">density</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">correct_fj</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">corr_den</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">DFR_DCN</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">)</span>

                    <span class="nb">vars</span><span class="p">()[</span><span class="n">ax_name</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">value</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">,</span>
                                            <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>

                <span class="n">indexes_automatic</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span>
                                     <span class="n">indexes_automatic</span><span class="p">]</span>  <span class="c1"># first line is kg1 data!</span>
                <span class="k">for</span> <span class="n">jj</span><span class="p">,</span> <span class="n">ind</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">reversed</span><span class="p">(</span><span class="n">indexes_automatic</span><span class="p">)):</span>

                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">chan</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>

                        <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax1</span><span class="o">.</span><span class="n">lines</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span>

                    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">chan</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                        <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax2</span><span class="o">.</span><span class="n">lines</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span>
                    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">chan</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
                        <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax3</span><span class="o">.</span><span class="n">lines</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span>
                    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">chan</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
                        <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax4</span><span class="o">.</span><span class="n">lines</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span>
                    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">chan</span> <span class="o">==</span> <span class="mi">5</span><span class="p">:</span>
                        <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax5</span><span class="o">.</span><span class="n">lines</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span>
                    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">chan</span> <span class="o">==</span> <span class="mi">6</span><span class="p">:</span>
                        <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax6</span><span class="o">.</span><span class="n">lines</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span>
                    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">chan</span> <span class="o">==</span> <span class="mi">7</span><span class="p">:</span>
                        <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax7</span><span class="o">.</span><span class="n">lines</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span>
                    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">chan</span> <span class="o">==</span> <span class="mi">8</span><span class="p">:</span>
                        <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax8</span><span class="o">.</span><span class="n">lines</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">update_channel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chan</span><span class="p">)</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">gettotalcorrections</span><span class="p">()</span>



        <span class="bp">self</span><span class="o">.</span><span class="n">pushButton_undo</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">discard_neutralise_corrections</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">kb</span><span class="o">.</span><span class="n">apply_pressed_signal</span><span class="o">.</span><span class="n">disconnect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">neutralisatecorrections</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">disconnnet_multiplecorrectionpointswidget</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">blockSignals</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s1">&#39;remember to mark corrections as permanent before proceeding!&#39;</span><span class="p">)</span>
        <span class="n">ret</span> <span class="o">=</span> <span class="n">qm_permanent</span><span class="o">.</span><span class="n">question</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
                          <span class="s2">&quot;Mark correction/s as permanent?&quot;</span><span class="p">,</span>
                                    <span class="n">qm_permanent</span><span class="o">.</span><span class="n">Yes</span> <span class="o">|</span> <span class="n">qm_permanent</span><span class="o">.</span><span class="n">No</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">ret</span> <span class="o">==</span> <span class="n">qm_permanent</span><span class="o">.</span><span class="n">Yes</span><span class="p">:</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">handle_makepermbutton</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">pass</span></div>

    <span class="c1"># -------------------------------</span>
    <span class="nd">@QtCore.pyqtSlot</span><span class="p">()</span>
<div class="viewcode-block" id="CORMAT_GUI.suggestcorrection"><a class="viewcode-back" href="../Cormat_main.html#Cormat_main.CORMAT_GUI.suggestcorrection">[docs]</a>    <span class="k">def</span> <span class="nf">suggestcorrection</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        module that suggests correction to apply on selected point</span>
<span class="sd">        :return:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chan</span><span class="p">)</span><span class="o">.</span><span class="n">isdigit</span><span class="p">()</span> <span class="o">==</span> <span class="bp">True</span><span class="p">:</span>
            <span class="c1"># if current channel is a number (1-8 allowed values)</span>
            <span class="c1">#then we assign to time and data the values of density for the current channel</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">chan</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chan</span><span class="p">)</span>
                <span class="n">time</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">density</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">time</span>
                <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">density</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
                <span class="n">coord</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">setcoord</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chan</span><span class="p">)</span> <span class="c1"># get the points selected by the user</span>
                <span class="n">index</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="n">find_nearest</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">coord</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="c1">#get nearest point close to selected point in the time array</span>

                <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chan</span><span class="p">)</span> <span class="o">&lt;</span><span class="mi">5</span><span class="p">:</span> <span class="c1"># vertical channels</span>
                    <span class="n">diff</span> <span class="o">=</span>  <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">density</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">index</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">density</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="c1"># difference between two consecutive points</span>
                    <span class="n">suggest_correction</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">((</span><span class="n">diff</span> <span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">DFR_DCN</span><span class="p">)))</span> <span class="c1"># check if diff is a fringe jump</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;suggested correction is {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">suggest_correction</span><span class="p">))</span>
                    <span class="k">return</span> <span class="n">suggest_correction</span>

                <span class="k">elif</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chan</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">4</span><span class="p">:</span> <span class="c1"># lateral channels</span>
                    <span class="n">diff_den</span> <span class="o">=</span>  <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">density</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">index</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">density</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
                    <span class="n">diff_vib</span> <span class="o">=</span>  <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">vibration</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">index</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">vibration</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>



                    <span class="n">Minv</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">matrix_lat_channels</span><span class="p">)</span> <span class="c1"># invert correction matrix for lateral channels</span>

                    <span class="n">suggest_correction</span> <span class="o">=</span> <span class="n">Minv</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">diff_den</span><span class="p">,</span> <span class="n">diff_vib</span><span class="p">]))</span> <span class="c1"># get suggested correction by solving linear problem Ax=b</span>
                    <span class="n">suggest_correction</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">around</span><span class="p">(</span><span class="n">suggest_correction</span><span class="p">)</span>
                    <span class="n">suggested_den</span> <span class="o">=</span> <span class="nb">int</span><span class="p">((</span><span class="n">suggest_correction</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
                    <span class="n">suggested_vib</span> <span class="o">=</span> <span class="nb">int</span><span class="p">((</span><span class="n">suggest_correction</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>

                    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;suggested correction is {} , {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">suggested_den</span><span class="p">,</span><span class="n">suggested_vib</span><span class="p">))</span>
                    <span class="k">return</span> <span class="n">suggested_den</span><span class="p">,</span>  <span class="n">suggested_vib</span></div>
    <span class="c1"># -------------------------------</span>
    <span class="c1"># @QtCore.pyqtSlot()</span>
    <span class="c1"># def stopaction(self):</span>
    <span class="c1">#     &quot;&quot;&quot;</span>
    <span class="c1">#     manages events after pressing ESC key</span>
    <span class="c1">#     STILL NOT WORKING</span>
    <span class="c1">#     :return:</span>
    <span class="c1">#     &quot;&quot;&quot;</span>
    <span class="c1">#     # print(&#39;stop&#39;)</span>
    <span class="c1">#     logger.log(5, &quot;stopping action&quot;)</span>
    <span class="c1">#     self.single_correction.disconnect(self.getcorrectionpointwidget)</span>
    <span class="c1">#     self.multiple_correction.disconnect(self.getcorrectionpointwidget)</span>
    <span class="c1">#     self.zeroing.disconnect(self.zeroingcorrection)</span>
    <span class="c1">#     self.unzeroing.disconnect(self.unzeroingcorrection)</span>
    <span class="c1">#     # self.stop.disconnect(self.stopactionn)</span>
    <span class="c1">#     self.neutralisation_mode.disconnect(self.neutralisatecorrections)</span>
    <span class="c1">#     self.suggested_correction.disconnect(self.suggestcorrection)</span>
    <span class="c1">#     logger.log(5, &quot;re-establishing connections&quot;)</span>
    <span class="c1">#     self.create_connections()</span>
    <span class="c1">#     QApplication.processEvents()</span>


    <span class="c1"># -------------------------------</span>
    <span class="nd">@QtCore.pyqtSlot</span><span class="p">()</span>
<div class="viewcode-block" id="CORMAT_GUI.getcorrectionpointwidget"><a class="viewcode-back" href="../Cormat_main.html#Cormat_main.CORMAT_GUI.getcorrectionpointwidget">[docs]</a>    <span class="k">def</span> <span class="nf">getcorrectionpointwidget</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        action to perform when the single correction signal is emitted:</span>
<span class="sd">        each widget (canvas) is connected to the function that gets data point from canvas</span>

<span class="sd">        and shows widget to apply correction</span>
<span class="sd">        :return:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_tab</span>  <span class="o">==</span> <span class="s1">&#39;LID_1&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID1</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_point</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_tab</span>  <span class="o">==</span> <span class="s1">&#39;LID_2&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID2</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_point</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_tab</span>  <span class="o">==</span> <span class="s1">&#39;LID_3&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID3</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_point</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_tab</span>  <span class="o">==</span> <span class="s1">&#39;LID_4&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID4</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_point</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_tab</span>  <span class="o">==</span> <span class="s1">&#39;LID_5&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID5</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_point</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_tab</span>  <span class="o">==</span> <span class="s1">&#39;LID_6&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID6</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_point</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_tab</span>  <span class="o">==</span> <span class="s1">&#39;LID_7&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID7</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_point</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_tab</span>  <span class="o">==</span> <span class="s1">&#39;LID_8&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID8</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_point</span><span class="p">)</span>

        <span class="c1"># #</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">kb</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>


    <span class="c1"># -------------------------------</span>
    <span class="nd">@QtCore.pyqtSlot</span><span class="p">()</span>
<div class="viewcode-block" id="CORMAT_GUI.getmultiplecorrectionpointswidget"><a class="viewcode-back" href="../Cormat_main.html#Cormat_main.CORMAT_GUI.getmultiplecorrectionpointswidget">[docs]</a>    <span class="k">def</span> <span class="nf">getmultiplecorrectionpointswidget</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        action to perform when the single correction signal is emitted:</span>
<span class="sd">        each widget (canvas) is connected to the function that gets data point from canvas</span>

<span class="sd">        and shows widget to apply correction</span>
<span class="sd">        :return:</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_tab</span>  <span class="o">==</span> <span class="s1">&#39;LID_1&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID1</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_multiple_points</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">setcoord</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">reset</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_tab</span>  <span class="o">==</span> <span class="s1">&#39;LID_2&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID2</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_multiple_points</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">setcoord</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">reset</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_tab</span>  <span class="o">==</span> <span class="s1">&#39;LID_3&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID3</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_multiple_points</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">setcoord</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">reset</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_tab</span>  <span class="o">==</span> <span class="s1">&#39;LID_4&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID4</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_multiple_points</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">setcoord</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">reset</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_tab</span>  <span class="o">==</span> <span class="s1">&#39;LID_5&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID5</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_multiple_points</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">setcoord</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">reset</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_tab</span>  <span class="o">==</span> <span class="s1">&#39;LID_6&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID6</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_multiple_points</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">setcoord</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="n">reset</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_tab</span>  <span class="o">==</span> <span class="s1">&#39;LID_7&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID7</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_multiple_points</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">setcoord</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="n">reset</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_tab</span>  <span class="o">==</span> <span class="s1">&#39;LID_8&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID8</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_multiple_points</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">setcoord</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="n">reset</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

        <span class="c1"># #</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">kb</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>


<div class="viewcode-block" id="CORMAT_GUI.disconnnet_multiplecorrectionpointswidget"><a class="viewcode-back" href="../Cormat_main.html#Cormat_main.CORMAT_GUI.disconnnet_multiplecorrectionpointswidget">[docs]</a>    <span class="k">def</span> <span class="nf">disconnnet_multiplecorrectionpointswidget</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        action to perform when the single correction signal is emitted:</span>
<span class="sd">        each widget (canvas) is connected to the function that gets data point from canvas</span>

<span class="sd">        and shows widget to apply correction</span>
<span class="sd">        :return:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_tab</span>  <span class="o">==</span> <span class="s1">&#39;LID_1&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID1</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">disconnect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_multiple_points</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_tab</span>  <span class="o">==</span> <span class="s1">&#39;LID_2&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID2</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">disconnect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_multiple_points</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_tab</span>  <span class="o">==</span> <span class="s1">&#39;LID_3&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID3</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">disconnect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_multiple_points</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_tab</span>  <span class="o">==</span> <span class="s1">&#39;LID_4&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID4</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">disconnect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_multiple_points</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_tab</span>  <span class="o">==</span> <span class="s1">&#39;LID_5&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID5</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">disconnect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_multiple_points</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_tab</span>  <span class="o">==</span> <span class="s1">&#39;LID_6&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID6</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">disconnect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_multiple_points</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_tab</span>  <span class="o">==</span> <span class="s1">&#39;LID_7&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID7</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">disconnect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_multiple_points</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_tab</span>  <span class="o">==</span> <span class="s1">&#39;LID_8&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID8</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">disconnect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_multiple_points</span><span class="p">)</span></div>

    <span class="c1"># def eventFilter(self, obj, event):</span>
    <span class="c1">#     logger.log(5, &#39;EVENT RECEIVED&#39;)</span>
    <span class="c1">#     logger.log(5, obj, event)</span>
    <span class="c1">#     if (obj is self or obj is self.new_action) and event.type() == QtCore.QEvent.Close:</span>
    <span class="c1">#         return True</span>
    <span class="c1">#     else:</span>
    <span class="c1">#         return False</span>
<span class="c1"># -------------------------</span>

    <span class="nd">@QtCore.pyqtSlot</span><span class="p">()</span>
<div class="viewcode-block" id="CORMAT_GUI.gettotalcorrections"><a class="viewcode-back" href="../Cormat_main.html#Cormat_main.CORMAT_GUI.gettotalcorrections">[docs]</a>    <span class="k">def</span> <span class="nf">gettotalcorrections</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chan</span><span class="p">)</span><span class="o">.</span><span class="n">isdigit</span><span class="p">()</span> <span class="o">==</span> <span class="bp">True</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_totcorr</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">chan</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chan</span><span class="p">)</span>
            <span class="n">chan</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chan</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">chan</span> <span class="o">&lt;</span> <span class="mi">5</span><span class="p">:</span>
                <span class="c1">#temporary (not marked as permanent) corrections set by user during validation</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">density</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">corrections</span><span class="o">.</span><span class="n">data</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                    <span class="n">total</span> <span class="o">=</span> <span class="mi">0</span>
                    <span class="c1"># self.totalcorrections_den[chan]= total</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">total</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">density</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">corrections</span><span class="o">.</span><span class="n">data</span><span class="p">)))</span>
                    <span class="c1"># self.totalcorrections_den[chan] = total</span>

                <span class="k">if</span> <span class="n">chan</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">fj_dcn</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">fj_dcn</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">data</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                        <span class="n">total_dcn</span> <span class="o">=</span> <span class="mi">0</span>
                        <span class="c1"># self.totalcorrections_den_dcn[chan]= total_dcn</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">total_dcn</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">fj_dcn</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">)))</span>
                        <span class="c1"># self.totalcorrections_den_dcn[chan] = total_dcn</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">total_dcn</span> <span class="o">=</span> <span class="mi">0</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_totcorr</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">total</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; /DCN= &#39;</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">total_dcn</span><span class="p">))</span>






            <span class="k">if</span> <span class="n">chan</span> <span class="o">&gt;</span> <span class="mi">4</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">density</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">corrections</span><span class="o">.</span><span class="n">data</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                    <span class="n">total1</span> <span class="o">=</span> <span class="mi">0</span>
                    <span class="c1"># self.totalcorrections_den_dcn[chan] = total1</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">total1</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">density</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">corrections</span><span class="o">.</span><span class="n">data</span><span class="p">)))</span>
                    <span class="c1"># self.totalcorrections_den_dcn[chan] = total1</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">vibration</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">corrections</span><span class="o">.</span><span class="n">data</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                    <span class="n">total2</span> <span class="o">=</span> <span class="mi">0</span>
                    <span class="c1"># self.totalcorrections_vib_dcn[chan] = total2</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">total2</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">vibration</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">corrections</span><span class="o">.</span><span class="n">data</span><span class="p">)))</span>
                    <span class="c1"># self.totalcorrections_vib_dcn[chan] = total2</span>


                <span class="k">if</span> <span class="n">chan</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">fj_dcn</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">fj_dcn</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">data</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                        <span class="n">total1_dcn</span> <span class="o">=</span> <span class="mi">0</span>
                        <span class="c1"># self.totalcorrections_den_dcn[chan] = total1_dcn</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">total1_dcn</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">fj_dcn</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">)))</span>
                        <span class="c1"># self.totalcorrections_den_dcn[chan] = total1_dcn</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">total1_dcn</span> <span class="o">=</span> <span class="mi">0</span>

                <span class="k">if</span> <span class="n">chan</span> <span class="o">+</span> <span class="mi">4</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">fj_dcn</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">fj_dcn</span><span class="p">[</span><span class="n">chan</span><span class="o">+</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">data</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                        <span class="n">total2_dcn</span> <span class="o">=</span> <span class="mi">0</span>
                        <span class="c1"># self.totalcorrections_vib_dcn[chan] = total2_dcn</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">total2_dcn</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">fj_dcn</span><span class="p">[</span><span class="n">chan</span><span class="o">+</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">)))</span>
                        <span class="c1"># self.totalcorrections_vib_dcn[chan+4] = total2_dcn</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">total2_dcn</span> <span class="o">=</span> <span class="mi">0</span>





                <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_totcorr</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span>
                        <span class="nb">str</span><span class="p">(</span><span class="n">total1</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;,&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">total2</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; /DCN= &#39;</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">total1_dcn</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;,&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">total2_dcn</span><span class="p">))</span>
                <span class="c1">#</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_totcorr</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span></div>

    <span class="nd">@QtCore.pyqtSlot</span><span class="p">()</span>
<div class="viewcode-block" id="CORMAT_GUI.singlecorrection"><a class="viewcode-back" href="../Cormat_main.html#Cormat_main.CORMAT_GUI.singlecorrection">[docs]</a>    <span class="k">def</span> <span class="nf">singlecorrection</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        this module applies single correction to selected channel</span>

<span class="sd">        :return:</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># pyqt_set_trace()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">blockSignals</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span> <span class="c1"># signals emitted by this object are blocked</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">correction_to_be_applied</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_mancorr</span><span class="o">.</span><span class="n">text</span><span class="p">()</span> <span class="c1"># reads correction from gui</span>
        <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chan</span><span class="p">)</span><span class="o">.</span><span class="n">isdigit</span><span class="p">()</span> <span class="o">==</span> <span class="bp">True</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">chan</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chan</span><span class="p">)</span>
            <span class="n">time</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">density</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">time</span>
            <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">density</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
            <span class="n">coord</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">setcoord</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chan</span><span class="p">)</span> <span class="c1"># get point selected from canvas</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">update_channel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chan</span><span class="p">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;applying this correction {} &#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">correction_to_be_applied</span><span class="p">)))</span>

            <span class="c1"># self.pushButton_undo.disconnect()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gettotalcorrections</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pushButton_undo</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">discard_single_point</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">kb</span><span class="o">.</span><span class="n">apply_pressed_signal</span><span class="o">.</span><span class="n">disconnect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">singlecorrection</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">blockSignals</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chan</span><span class="p">)</span> <span class="o">&lt;</span><span class="mi">5</span><span class="p">:</span>
            <span class="n">suggested_den</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">suggestcorrection</span><span class="p">()</span> <span class="c1"># compute correction based on fringe jump on selected point</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">corr_den</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_mancorr</span><span class="o">.</span><span class="n">text</span><span class="p">())</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">DFR_DCN</span> <span class="c1"># convert fringe jump into density</span>
            <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span> <span class="c1">#check if self.coor_den is a number</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;use numerical values&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_mancorr</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">update_channel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chan</span><span class="p">)</span> <span class="c1">#update data and canvas</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;applying this correction {} &#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">correction_to_be_applied</span><span class="p">)))</span>

                <span class="c1"># self.pushButton_undo.disconnect()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">gettotalcorrections</span><span class="p">()</span> <span class="c1"># compute total correction</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">pushButton_undo</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">discard_single_point</span><span class="p">)</span> <span class="c1"># connect undo button to slot to undo single correction</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">kb</span><span class="o">.</span><span class="n">apply_pressed_signal</span><span class="o">.</span><span class="n">disconnect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">singlecorrection</span><span class="p">)</span> <span class="c1"># disconnect slot</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">blockSignals</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
                <span class="k">return</span>
            <span class="k">if</span> <span class="n">suggested_den</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">corr_den</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s1">&#39;suggested correction is different, do you wish to use it?&#39;</span><span class="p">)</span>
                <span class="n">ret</span> <span class="o">=</span> <span class="n">qm</span><span class="o">.</span><span class="n">question</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s2">&quot;suggested correction is different: &quot;</span> <span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">suggested_den</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">  Do you wish to use it?&quot;</span><span class="p">,</span> <span class="n">qm</span><span class="o">.</span><span class="n">Yes</span> <span class="o">|</span> <span class="n">qm</span><span class="o">.</span><span class="n">No</span><span class="p">)</span>
                <span class="c1"># x  = input(&#39;y/n?&#39;)</span>
                <span class="k">if</span> <span class="n">ret</span><span class="o">==</span><span class="n">qm</span><span class="o">.</span><span class="n">Yes</span><span class="p">:</span>
                <span class="c1"># if x.lower() == &quot;y&quot;:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">corr_den</span> <span class="o">=</span> <span class="n">suggested_den</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">pass</span>
        <span class="k">elif</span>  <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chan</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">4</span><span class="p">:</span>
            <span class="n">suggested_den</span><span class="p">,</span> <span class="n">suggested_vib</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">suggestcorrection</span><span class="p">()</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">corr_den</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_mancorr</span><span class="o">.</span><span class="n">text</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">corr_vib</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_mancorr</span><span class="o">.</span><span class="n">text</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span>

                <span class="n">corrections</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">matrix_lat_channels</span><span class="o">.</span><span class="n">dot</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">corr_den</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">corr_vib</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">corr_den</span> <span class="o">=</span> <span class="n">corrections</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">corr_vib</span> <span class="o">=</span> <span class="n">corrections</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

            <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s1">&#39;no vibration correction&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_mancorr</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">update_channel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chan</span><span class="p">)</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;applying this correction {} &#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">correction_to_be_applied</span><span class="p">)))</span>

                <span class="c1"># self.pushButton_undo.disconnect()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">gettotalcorrections</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">pushButton_undo</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">discard_single_point</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">kb</span><span class="o">.</span><span class="n">apply_pressed_signal</span><span class="o">.</span><span class="n">disconnect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">singlecorrection</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">blockSignals</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
                <span class="k">return</span>
            <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;use numerical values&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">lineEdit_mancorr</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">update_channel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chan</span><span class="p">)</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;applying this correction {} &#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">correction_to_be_applied</span><span class="p">)))</span>

                <span class="c1"># self.pushButton_undo.disconnect()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">gettotalcorrections</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">pushButton_undo</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">discard_single_point</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">kb</span><span class="o">.</span><span class="n">apply_pressed_signal</span><span class="o">.</span><span class="n">disconnect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">singlecorrection</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">blockSignals</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
                <span class="k">return</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">suggested_den</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">corr_den</span><span class="p">)</span> <span class="o">&amp;</span> <span class="n">suggested_vib</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">corr_vib</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s1">&#39;suggested correction is different, do you wish to use it?&#39;</span><span class="p">)</span>
                <span class="n">ret</span> <span class="o">=</span> <span class="n">qm</span><span class="o">.</span><span class="n">question</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s2">&quot;suggested correction is different: &quot;</span> <span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">suggested_den</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;, &#39;</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">suggested_vib</span><span class="p">)</span> <span class="o">+</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">  Do you wish to use it?&quot;</span><span class="p">,</span> <span class="n">qm</span><span class="o">.</span><span class="n">Yes</span> <span class="o">|</span> <span class="n">qm</span><span class="o">.</span><span class="n">No</span><span class="p">)</span>

                <span class="c1"># x  = input(&#39;y/n?&#39;)</span>
                <span class="k">if</span> <span class="n">ret</span><span class="o">==</span><span class="n">qm</span><span class="o">.</span><span class="n">Yes</span><span class="p">:</span>
                <span class="c1"># x  = input(&#39;y/n?&#39;)</span>
                <span class="c1"># if x.lower() == &quot;y&quot;:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">corr_den</span> <span class="o">=</span> <span class="n">suggested_den</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">corr_vib</span> <span class="o">=</span> <span class="n">suggested_vib</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">pass</span>


        <span class="n">index</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="n">find_nearest</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">coord</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="c1"># finds nearest data point to selected point on canvas</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">density</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">correct_fj</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">corr_den</span> <span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">)</span> <span class="c1"># correct data</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">density</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">corrections</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>


            <span class="n">xc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">density</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">corrections</span><span class="o">.</span><span class="n">time</span>
            <span class="c1"># for xc in xposition:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">chan</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ax1</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">coord</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">coord</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;mo&#39;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">chan</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ax2</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">coord</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">coord</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;mo&#39;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">chan</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ax3</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">coord</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ax3</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">coord</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;mo&#39;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">chan</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ax4</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">coord</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ax4</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">coord</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;mo&#39;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">chan</span> <span class="o">==</span> <span class="mi">5</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ax5</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">coord</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ax5</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">coord</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;mo&#39;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">chan</span> <span class="o">==</span> <span class="mi">6</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ax6</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">coord</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ax6</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">coord</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;mo&#39;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">chan</span> <span class="o">==</span> <span class="mi">7</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ax7</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">coord</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ax7</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">coord</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;mo&#39;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">chan</span> <span class="o">==</span> <span class="mi">8</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ax8</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">coord</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ax8</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">coord</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;mo&#39;</span><span class="p">)</span>


        <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chan</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">4</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">vibration</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">correct_fj</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">corr_vib</span> <span class="p">,</span>
                    <span class="n">time</span><span class="o">=</span><span class="n">value</span><span class="p">)</span>


            <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;insert a correction for the mirror&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">update_channel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chan</span><span class="p">)</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;applying this correction {} &#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">correction_to_be_applied</span><span class="p">)))</span>

                <span class="c1"># self.pushButton_undo.disconnect()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">gettotalcorrections</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">pushButton_undo</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">discard_single_point</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">kb</span><span class="o">.</span><span class="n">apply_pressed_signal</span><span class="o">.</span><span class="n">disconnect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">singlecorrection</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">blockSignals</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
                <span class="k">return</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_channel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chan</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;applying this correction {} &#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">correction_to_be_applied</span><span class="p">)))</span>

        <span class="c1"># self.pushButton_undo.disconnect()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gettotalcorrections</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pushButton_undo</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">discard_single_point</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">kb</span><span class="o">.</span><span class="n">apply_pressed_signal</span><span class="o">.</span><span class="n">disconnect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">singlecorrection</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">blockSignals</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
            <span class="s1">&#39;remember to mark corrections as permanent before proceeding!&#39;</span><span class="p">)</span>

        <span class="n">ret</span> <span class="o">=</span> <span class="n">qm_permanent</span><span class="o">.</span><span class="n">question</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
                          <span class="s2">&quot;Mark correction/s as permanent?&quot;</span><span class="p">,</span>
                                    <span class="n">qm_permanent</span><span class="o">.</span><span class="n">Yes</span> <span class="o">|</span> <span class="n">qm_permanent</span><span class="o">.</span><span class="n">No</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">ret</span> <span class="o">==</span> <span class="n">qm_permanent</span><span class="o">.</span><span class="n">Yes</span><span class="p">:</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">handle_makepermbutton</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">pass</span></div>


    <span class="c1"># -------------------------------.</span>

    <span class="nd">@QtCore.pyqtSlot</span><span class="p">()</span>
<div class="viewcode-block" id="CORMAT_GUI.get_point"><a class="viewcode-back" href="../Cormat_main.html#Cormat_main.CORMAT_GUI.get_point">[docs]</a>    <span class="k">def</span> <span class="nf">get_point</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        each tab as its own vector where input data points are stored in a list</span>
<span class="sd">        user later by correction modules to get where to apply corrections</span>
<span class="sd">        :return:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># gotcorrectionpoint = pyqtSignal()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_tab</span> <span class="o">==</span> <span class="s1">&#39;LID_1&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">coord_ch1</span> <span class="o">=</span> <span class="p">[[</span><span class="bp">self</span><span class="o">.</span><span class="n">widget_LID1</span><span class="o">.</span><span class="n">xs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID1</span><span class="o">.</span><span class="n">ys</span><span class="p">]]</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="s2">&quot;Tab selected is {} - data is {} {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">current_tab</span><span class="p">,</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">widget_LID1</span><span class="o">.</span><span class="n">xs</span><span class="p">),</span>
                <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">widget_LID1</span><span class="o">.</span><span class="n">ys</span><span class="p">)))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID1</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">disconnect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_point</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_tab</span> <span class="o">==</span> <span class="s1">&#39;LID_2&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">coord_ch2</span> <span class="o">=</span> <span class="p">[[</span><span class="bp">self</span><span class="o">.</span><span class="n">widget_LID2</span><span class="o">.</span><span class="n">xs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID2</span><span class="o">.</span><span class="n">ys</span><span class="p">]]</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="s2">&quot;Tab selected is {} - data is {} {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">current_tab</span><span class="p">,</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">widget_LID2</span><span class="o">.</span><span class="n">xs</span><span class="p">),</span>
                <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">widget_LID2</span><span class="o">.</span><span class="n">ys</span><span class="p">)))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID2</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">disconnect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_point</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_tab</span> <span class="o">==</span> <span class="s1">&#39;LID_3&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">coord_ch3</span> <span class="o">=</span> <span class="p">[[</span><span class="bp">self</span><span class="o">.</span><span class="n">widget_LID3</span><span class="o">.</span><span class="n">xs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID3</span><span class="o">.</span><span class="n">ys</span><span class="p">]]</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="s2">&quot;Tab selected is {} - data is {} {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">current_tab</span><span class="p">,</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">widget_LID3</span><span class="o">.</span><span class="n">xs</span><span class="p">),</span>
                <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">widget_LID3</span><span class="o">.</span><span class="n">ys</span><span class="p">)))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID3</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">disconnect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_point</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_tab</span> <span class="o">==</span> <span class="s1">&#39;LID_4&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">coord_ch4</span> <span class="o">=</span> <span class="p">[[</span><span class="bp">self</span><span class="o">.</span><span class="n">widget_LID4</span><span class="o">.</span><span class="n">xs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID4</span><span class="o">.</span><span class="n">ys</span><span class="p">]]</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="s2">&quot;Tab selected is {} - data is {} {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">current_tab</span><span class="p">,</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">widget_LID4</span><span class="o">.</span><span class="n">xs</span><span class="p">),</span>
                <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">widget_LID4</span><span class="o">.</span><span class="n">ys</span><span class="p">)))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID4</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">disconnect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_point</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_tab</span> <span class="o">==</span> <span class="s1">&#39;LID_5&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">coord_ch5</span> <span class="o">=</span> <span class="p">[[</span><span class="bp">self</span><span class="o">.</span><span class="n">widget_LID5</span><span class="o">.</span><span class="n">xs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID5</span><span class="o">.</span><span class="n">ys</span><span class="p">]]</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="s2">&quot;Tab selected is {} - data is {} {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">current_tab</span><span class="p">,</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">widget_LID5</span><span class="o">.</span><span class="n">xs</span><span class="p">),</span>
                <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">widget_LID5</span><span class="o">.</span><span class="n">ys</span><span class="p">)))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID5</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">disconnect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_point</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_tab</span> <span class="o">==</span> <span class="s1">&#39;LID_6&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">coord_ch6</span> <span class="o">=</span> <span class="p">[[</span><span class="bp">self</span><span class="o">.</span><span class="n">widget_LID6</span><span class="o">.</span><span class="n">xs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID6</span><span class="o">.</span><span class="n">ys</span><span class="p">]]</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="s2">&quot;Tab selected is {} - data is {} {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">current_tab</span><span class="p">,</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">widget_LID6</span><span class="o">.</span><span class="n">xs</span><span class="p">),</span>
                <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">widget_LID6</span><span class="o">.</span><span class="n">ys</span><span class="p">)))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID6</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">disconnect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_point</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_tab</span> <span class="o">==</span> <span class="s1">&#39;LID_7&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">coord_ch7</span> <span class="o">=</span> <span class="p">[[</span><span class="bp">self</span><span class="o">.</span><span class="n">widget_LID7</span><span class="o">.</span><span class="n">xs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID7</span><span class="o">.</span><span class="n">ys</span><span class="p">]]</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="s2">&quot;Tab selected is {} - data is {} {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">current_tab</span><span class="p">,</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">widget_LID7</span><span class="o">.</span><span class="n">xs</span><span class="p">),</span>
                <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">widget_LID7</span><span class="o">.</span><span class="n">ys</span><span class="p">)))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID7</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">disconnect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_point</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_tab</span> <span class="o">==</span> <span class="s1">&#39;LID_8&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">coord_ch8</span> <span class="o">=</span> <span class="p">[[</span><span class="bp">self</span><span class="o">.</span><span class="n">widget_LID8</span><span class="o">.</span><span class="n">xs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID8</span><span class="o">.</span><span class="n">ys</span><span class="p">]]</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="s2">&quot;Tab selected is {} - data is {} {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">current_tab</span><span class="p">,</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">widget_LID8</span><span class="o">.</span><span class="n">xs</span><span class="p">),</span>
                <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">widget_LID8</span><span class="o">.</span><span class="n">ys</span><span class="p">)))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID8</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">disconnect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_point</span><span class="p">)</span></div>


<span class="c1">#----------------------------------</span>
    <span class="nd">@QtCore.pyqtSlot</span><span class="p">()</span>
<div class="viewcode-block" id="CORMAT_GUI.get_multiple_points"><a class="viewcode-back" href="../Cormat_main.html#Cormat_main.CORMAT_GUI.get_multiple_points">[docs]</a>    <span class="k">def</span> <span class="nf">get_multiple_points</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        each tab as its own vector where input data points are stored in a list</span>
<span class="sd">        user later by correction modules to get where to apply corrections</span>
<span class="sd">        :return:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># gotcorrectionpoint = pyqtSignal()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_tab</span> <span class="o">==</span> <span class="s1">&#39;LID_1&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">coord_ch1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">widget_LID1</span><span class="o">.</span><span class="n">xs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID1</span><span class="o">.</span><span class="n">ys</span><span class="p">))</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="s2">&quot;Tab selected is {} - data is {} {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">current_tab</span><span class="p">,</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">widget_LID1</span><span class="o">.</span><span class="n">xs</span><span class="p">),</span>
                <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">widget_LID1</span><span class="o">.</span><span class="n">ys</span><span class="p">)))</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_tab</span> <span class="o">==</span> <span class="s1">&#39;LID_2&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">coord_ch2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">widget_LID2</span><span class="o">.</span><span class="n">xs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID2</span><span class="o">.</span><span class="n">ys</span><span class="p">))</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="s2">&quot;Tab selected is {} - data is {} {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">current_tab</span><span class="p">,</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">widget_LID2</span><span class="o">.</span><span class="n">xs</span><span class="p">),</span>
                <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">widget_LID2</span><span class="o">.</span><span class="n">ys</span><span class="p">)))</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_tab</span> <span class="o">==</span> <span class="s1">&#39;LID_3&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">coord_ch3</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">widget_LID3</span><span class="o">.</span><span class="n">xs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID3</span><span class="o">.</span><span class="n">ys</span><span class="p">))</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="s2">&quot;Tab selected is {} - data is {} {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">current_tab</span><span class="p">,</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">widget_LID3</span><span class="o">.</span><span class="n">xs</span><span class="p">),</span>
                <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">widget_LID3</span><span class="o">.</span><span class="n">ys</span><span class="p">)))</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_tab</span> <span class="o">==</span> <span class="s1">&#39;LID_4&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">coord_ch4</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">widget_LID4</span><span class="o">.</span><span class="n">xs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID4</span><span class="o">.</span><span class="n">ys</span><span class="p">))</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="s2">&quot;Tab selected is {} - data is {} {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">current_tab</span><span class="p">,</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">widget_LID4</span><span class="o">.</span><span class="n">xs</span><span class="p">),</span>
                <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">widget_LID4</span><span class="o">.</span><span class="n">ys</span><span class="p">)))</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_tab</span> <span class="o">==</span> <span class="s1">&#39;LID_5&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">coord_ch5</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">widget_LID5</span><span class="o">.</span><span class="n">xs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID5</span><span class="o">.</span><span class="n">ys</span><span class="p">))</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="s2">&quot;Tab selected is {} - data is {} {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">current_tab</span><span class="p">,</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">widget_LID5</span><span class="o">.</span><span class="n">xs</span><span class="p">),</span>
                <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">widget_LID5</span><span class="o">.</span><span class="n">ys</span><span class="p">)))</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_tab</span> <span class="o">==</span> <span class="s1">&#39;LID_6&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">coord_ch6</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">widget_LID6</span><span class="o">.</span><span class="n">xs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID6</span><span class="o">.</span><span class="n">ys</span><span class="p">))</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="s2">&quot;Tab selected is {} - data is {} {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">current_tab</span><span class="p">,</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">widget_LID6</span><span class="o">.</span><span class="n">xs</span><span class="p">),</span>
                <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">widget_LID6</span><span class="o">.</span><span class="n">ys</span><span class="p">)))</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_tab</span> <span class="o">==</span> <span class="s1">&#39;LID_7&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">coord_ch7</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">widget_LID7</span><span class="o">.</span><span class="n">xs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID7</span><span class="o">.</span><span class="n">ys</span><span class="p">))</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="s2">&quot;Tab selected is {} - data is {} {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">current_tab</span><span class="p">,</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">widget_LID7</span><span class="o">.</span><span class="n">xs</span><span class="p">),</span>
                <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">widget_LID7</span><span class="o">.</span><span class="n">ys</span><span class="p">)))</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_tab</span> <span class="o">==</span> <span class="s1">&#39;LID_8&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">coord_ch8</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">widget_LID8</span><span class="o">.</span><span class="n">xs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID8</span><span class="o">.</span><span class="n">ys</span><span class="p">))</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="s2">&quot;Tab selected is {} - data is {} {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">current_tab</span><span class="p">,</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">widget_LID8</span><span class="o">.</span><span class="n">xs</span><span class="p">),</span>
                <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">widget_LID8</span><span class="o">.</span><span class="n">ys</span><span class="p">)))</span></div>




    <span class="c1"># ----------------------------------</span>
    <span class="nd">@QtCore.pyqtSlot</span><span class="p">()</span>
<div class="viewcode-block" id="CORMAT_GUI.discard_single_point"><a class="viewcode-back" href="../Cormat_main.html#Cormat_main.CORMAT_GUI.discard_single_point">[docs]</a>    <span class="k">def</span> <span class="nf">discard_single_point</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        after a single correction is applied</span>
<span class="sd">        this function allows the user to undo it</span>

<span class="sd">        before it is permanently applied</span>
<span class="sd">        :return:</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chan</span><span class="p">)</span><span class="o">.</span><span class="n">isdigit</span><span class="p">()</span> <span class="o">==</span> <span class="bp">True</span><span class="p">:</span>
            <span class="n">chan</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chan</span><span class="p">)</span>
            <span class="n">time</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">density</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">time</span>
            <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">density</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>

            <span class="n">coord</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">setcoord</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chan</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">is_empty</span><span class="p">(</span><span class="n">coord</span><span class="p">):</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
                    <span class="s1">&#39;nothing to undo&#39;</span><span class="p">)</span>
                <span class="k">return</span>
            <span class="k">else</span><span class="p">:</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">setcoord</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chan</span><span class="p">,</span><span class="n">reset</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="s2">&quot;looking for correction at {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">:][</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]))</span>
        <span class="n">index</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="n">find_nearest</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">coord</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">:][</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;undoing correction at {} with index {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">value</span><span class="p">))</span>


        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">density</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">uncorrect_fj</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">corr_den</span> <span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chan</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">4</span><span class="p">:</span>
            <span class="n">vibration</span> <span class="o">=</span> <span class="n">SignalBase</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">constants</span><span class="p">)</span>
            <span class="n">vibration</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">vibration</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span>

            <span class="n">vibration</span><span class="o">.</span><span class="n">uncorrect_fj</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">corr_vib</span> <span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">)</span>
        <span class="n">num_of_correction</span> <span class="o">=</span> <span class="mi">2</span> <span class="c1"># this number is always 2 for single correction mode!</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">chan</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax1</span><span class="o">.</span><span class="n">lines</span><span class="p">[</span><span class="o">-</span><span class="n">num_of_correction</span><span class="p">:]</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">chan</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax2</span><span class="o">.</span><span class="n">lines</span><span class="p">[</span><span class="o">-</span><span class="n">num_of_correction</span><span class="p">:]</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">chan</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax3</span><span class="o">.</span><span class="n">lines</span><span class="p">[</span><span class="o">-</span><span class="n">num_of_correction</span><span class="p">:]</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">chan</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax4</span><span class="o">.</span><span class="n">lines</span><span class="p">[</span><span class="o">-</span><span class="n">num_of_correction</span><span class="p">:]</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">chan</span> <span class="o">==</span> <span class="mi">5</span><span class="p">:</span>
            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax5</span><span class="o">.</span><span class="n">lines</span><span class="p">[</span><span class="o">-</span><span class="n">num_of_correction</span><span class="p">:]</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">chan</span> <span class="o">==</span> <span class="mi">6</span><span class="p">:</span>
            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax6</span><span class="o">.</span><span class="n">lines</span><span class="p">[</span><span class="o">-</span><span class="n">num_of_correction</span><span class="p">:]</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">chan</span> <span class="o">==</span> <span class="mi">7</span><span class="p">:</span>
            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax7</span><span class="o">.</span><span class="n">lines</span><span class="p">[</span><span class="o">-</span><span class="n">num_of_correction</span><span class="p">:]</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">chan</span> <span class="o">==</span> <span class="mi">8</span><span class="p">:</span>
            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax8</span><span class="o">.</span><span class="n">lines</span><span class="p">[</span><span class="o">-</span><span class="n">num_of_correction</span><span class="p">:]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">update_channel</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chan</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gettotalcorrections</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pushButton_undo</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">disconnect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">discard_single_point</span><span class="p">)</span></div>

        <span class="c1"># -----------------------------------------------</span>
    <span class="nd">@QtCore.pyqtSlot</span><span class="p">()</span>
<div class="viewcode-block" id="CORMAT_GUI.discard_neutralise_corrections"><a class="viewcode-back" href="../Cormat_main.html#Cormat_main.CORMAT_GUI.discard_neutralise_corrections">[docs]</a>    <span class="k">def</span> <span class="nf">discard_neutralise_corrections</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            after correction are neutralised</span>
<span class="sd">            this function allows the user to undo it</span>

<span class="sd">            before it is permanently applied</span>

<span class="sd">            :return:</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="n">ax1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax1</span>
            <span class="n">ax2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax2</span>
            <span class="n">ax3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax3</span>
            <span class="n">ax4</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax4</span>
            <span class="n">ax5</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax5</span>
            <span class="n">ax6</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax6</span>
            <span class="n">ax7</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax7</span>
            <span class="n">ax8</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax8</span>
            
            <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chan</span><span class="p">)</span><span class="o">.</span><span class="n">isdigit</span><span class="p">()</span> <span class="o">==</span> <span class="bp">True</span><span class="p">:</span>
                <span class="n">chan</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chan</span><span class="p">)</span>
                <span class="n">time</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">density</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">time</span>
                <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">density</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>

                <span class="n">coord</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">setcoord</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chan</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">is_empty</span><span class="p">(</span><span class="n">coord</span><span class="p">):</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
                        <span class="s2">&quot;no data points collected from canvas, nothing to undo&quot;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">update_channel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chan</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">gettotalcorrections</span><span class="p">()</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">pushButton_undo</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">discard_neutralise_corrections</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">kb</span><span class="o">.</span><span class="n">apply_pressed_signal</span><span class="o">.</span><span class="n">disconnect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">neutralisatecorrections</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">disconnnet_neutralisepointswidget</span><span class="p">()</span>

                    <span class="bp">self</span><span class="o">.</span><span class="n">blockSignals</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
                    <span class="k">return</span>
                <span class="k">else</span><span class="p">:</span>

                    <span class="bp">self</span><span class="o">.</span><span class="n">setcoord</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chan</span><span class="p">,</span> <span class="n">reset</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">update_channel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chan</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">gettotalcorrections</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">pushButton_undo</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">discard_neutralise_corrections</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">kb</span><span class="o">.</span><span class="n">apply_pressed_signal</span><span class="o">.</span><span class="n">disconnect</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">neutralisatecorrections</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">disconnnet_neutralisepointswidget</span><span class="p">()</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">blockSignals</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>

                <span class="k">return</span>
            <span class="c1"># try:</span>
            <span class="n">min_coord</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">coord</span><span class="p">)</span>
            <span class="n">max_coord</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">coord</span><span class="p">)</span>
            <span class="n">indexes</span><span class="p">,</span> <span class="n">values</span> <span class="o">=</span> <span class="n">find_within_range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">density</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">corrections</span><span class="o">.</span><span class="n">time</span><span class="p">,</span><span class="n">min_coord</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">max_coord</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">indexes_automatic</span><span class="p">,</span> <span class="n">values_automatic</span> <span class="o">=</span> <span class="n">find_within_range</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">fj_dcn</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">time</span><span class="p">,</span> <span class="n">min_coord</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                <span class="n">max_coord</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="c1">#unique values</span>
            <span class="c1"># values = list(set(values)) # using this insctruction creates an error</span>
            <span class="c1"># as creates a mismatch between times of correction and value of the correction</span>
            <span class="c1"># even thought it is the best way to avoid duplicates</span>
            <span class="n">corrections</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">density</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">corrections</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">indexes</span><span class="p">]</span>
            <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chan</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">4</span><span class="p">:</span>
                <span class="n">corrections_vib</span> <span class="o">=</span> \
                <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">vibration</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">corrections</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">indexes</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">values</span><span class="p">):</span>

                <span class="n">index</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="n">find_nearest</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">corr_den</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">corrections</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
                <span class="n">time_corr</span> <span class="o">=</span>  <span class="n">values</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>


                <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;undoing correction @t= {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">time_corr</span><span class="p">)))</span>


                <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chan</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">4</span><span class="p">:</span>
                    <span class="c1"># logging.warning(&#39;assuming mirror correction = 0 !&#39;)</span>

                    <span class="bp">self</span><span class="o">.</span><span class="n">corr_vib</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">corrections_vib</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>

                    <span class="n">M</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">matrix_lat_channels</span>

                    <span class="n">correction_to_be_restored</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">corr_den</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">corr_vib</span><span class="p">]))</span>  <span class="c1"># get suggested correction by solving linear problem Ax=b</span>

                    <span class="n">restored_den</span> <span class="o">=</span> <span class="n">correction_to_be_restored</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="n">restored_vib</span> <span class="o">=</span> <span class="n">correction_to_be_restored</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

                    <span class="c1"># lid = neutralised_correction[0]</span>
                    <span class="c1"># mir = neutralised_correction[1]</span>

                    <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">density</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">uncorrect_fj</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">corr_den</span><span class="p">,</span>
                        <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">,</span><span class="n">fringe_vib</span> <span class="o">=</span> <span class="n">restored_den</span><span class="p">)</span>


                    <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">vibration</span><span class="p">[</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">uncorrect_fj</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">corr_vib</span><span class="p">,</span>
                            <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">,</span><span class="n">fringe_vib</span><span class="o">=</span><span class="n">restored_vib</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>

                    <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">density</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">uncorrect_fj</span><span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">corr_den</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">DFR_DCN</span><span class="p">,</span>
                        <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">)</span>

                    <span class="c1"># if self.data.KG1_data.density[self.chan].corrections is not None:</span>
                <span class="n">ax_name</span> <span class="o">=</span> <span class="s1">&#39;ax&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chan</span><span class="p">)</span>

                <span class="nb">vars</span><span class="p">()[</span><span class="n">ax_name</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">time_corr</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span>
                                            <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">update_channel</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chan</span><span class="p">))</span>



            <span class="bp">self</span><span class="o">.</span><span class="n">gettotalcorrections</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pushButton_undo</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">disconnect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">discard_neutralise_corrections</span><span class="p">)</span></div>

    <span class="c1"># -----------------------------------------------</span>
    <span class="nd">@QtCore.pyqtSlot</span><span class="p">()</span>
<div class="viewcode-block" id="CORMAT_GUI.discard_multiple_points"><a class="viewcode-back" href="../Cormat_main.html#Cormat_main.CORMAT_GUI.discard_multiple_points">[docs]</a>    <span class="k">def</span> <span class="nf">discard_multiple_points</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        after multiple corrections are applied</span>
<span class="sd">        this function allows the user to undo it</span>

<span class="sd">        before it are permanently applied</span>

<span class="sd">        :return:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chan</span><span class="p">)</span><span class="o">.</span><span class="n">isdigit</span><span class="p">()</span> <span class="o">==</span> <span class="bp">True</span><span class="p">:</span>
            <span class="n">chan</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chan</span><span class="p">)</span>
            <span class="n">time</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">density</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">time</span>
            <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">density</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>

            <span class="n">coord</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">setcoord</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chan</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">is_empty</span><span class="p">(</span><span class="n">coord</span><span class="p">):</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
                    <span class="s2">&quot;nothing to undo&quot;</span><span class="p">)</span>
                <span class="k">return</span>
            <span class="k">else</span><span class="p">:</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">setcoord</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chan</span><span class="p">,</span><span class="n">reset</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="c1"># try:</span>

        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">coord</span><span class="p">):</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;undoing correction @t= {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">[</span><span class="mi">0</span><span class="p">])))</span>
            <span class="n">index</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="n">find_nearest</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">value</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="s2">&quot; found point to undo at {} with index {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">value</span><span class="p">))</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">density</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span><span class="o">.</span><span class="n">uncorrect_fj</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">corr_den</span> <span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">)</span>

            <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chan</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">4</span><span class="p">:</span>
                <span class="n">vibration</span> <span class="o">=</span> <span class="n">SignalBase</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">constants</span><span class="p">)</span>
                <span class="n">vibration</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">KG1_data</span><span class="o">.</span><span class="n">vibration</span><span class="p">[</span><span class="n">chan</span><span class="p">]</span>

                <span class="n">vibration</span><span class="o">.</span><span class="n">uncorrect_fj</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">corr_vib</span> <span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">)</span>
        <span class="n">num_of_correction</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">coord</span><span class="p">)</span>  <span class="c1"># this number is always 2 for single correction mode!</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">chan</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax1</span><span class="o">.</span><span class="n">lines</span><span class="p">[</span><span class="o">-</span><span class="n">num_of_correction</span><span class="p">:]</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">chan</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax2</span><span class="o">.</span><span class="n">lines</span><span class="p">[</span><span class="o">-</span><span class="n">num_of_correction</span><span class="p">:]</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">chan</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax3</span><span class="o">.</span><span class="n">lines</span><span class="p">[</span><span class="o">-</span><span class="n">num_of_correction</span><span class="p">:]</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">chan</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax4</span><span class="o">.</span><span class="n">lines</span><span class="p">[</span><span class="o">-</span><span class="n">num_of_correction</span><span class="p">:]</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">chan</span> <span class="o">==</span> <span class="mi">5</span><span class="p">:</span>
            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax5</span><span class="o">.</span><span class="n">lines</span><span class="p">[</span><span class="o">-</span><span class="n">num_of_correction</span><span class="p">:]</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">chan</span> <span class="o">==</span> <span class="mi">6</span><span class="p">:</span>
            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax6</span><span class="o">.</span><span class="n">lines</span><span class="p">[</span><span class="o">-</span><span class="n">num_of_correction</span><span class="p">:]</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">chan</span> <span class="o">==</span> <span class="mi">7</span><span class="p">:</span>
            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax7</span><span class="o">.</span><span class="n">lines</span><span class="p">[</span><span class="o">-</span><span class="n">num_of_correction</span><span class="p">:]</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">chan</span> <span class="o">==</span> <span class="mi">8</span><span class="p">:</span>
            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax8</span><span class="o">.</span><span class="n">lines</span><span class="p">[</span><span class="o">-</span><span class="n">num_of_correction</span><span class="p">:]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">update_channel</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chan</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gettotalcorrections</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pushButton_undo</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">disconnect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">discard_multiple_points</span><span class="p">)</span></div>

<span class="c1">#--------------------------</span>
<div class="viewcode-block" id="CORMAT_GUI.which_tab"><a class="viewcode-back" href="../Cormat_main.html#Cormat_main.CORMAT_GUI.which_tab">[docs]</a>    <span class="k">def</span> <span class="nf">which_tab</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        function used to detect which tab is currently active and set ax and widget</span>

<span class="sd">        :return: ax and widget name of current tab</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chan</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">ax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax1</span>
            <span class="n">widget</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID1</span>
        <span class="k">elif</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chan</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">ax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax2</span>
            <span class="n">widget</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID2</span>
        <span class="k">elif</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chan</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
            <span class="n">ax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax3</span>
            <span class="n">widget</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID3</span>
        <span class="k">elif</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chan</span><span class="p">)</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
            <span class="n">ax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax4</span>
            <span class="n">widget</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID4</span>
        <span class="k">elif</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chan</span><span class="p">)</span> <span class="o">==</span> <span class="mi">5</span><span class="p">:</span>
            <span class="n">ax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax5</span>
            <span class="n">widget</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID5</span>
        <span class="k">elif</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chan</span><span class="p">)</span> <span class="o">==</span> <span class="mi">6</span><span class="p">:</span>
            <span class="n">ax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax6</span>
            <span class="n">widget</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID6</span>
        <span class="k">elif</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chan</span><span class="p">)</span> <span class="o">==</span> <span class="mi">7</span><span class="p">:</span>
            <span class="n">ax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax7</span>
            <span class="n">widget</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID7</span>
        <span class="k">elif</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chan</span><span class="p">)</span> <span class="o">==</span> <span class="mi">8</span><span class="p">:</span>
            <span class="n">ax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax8</span>
            <span class="n">widget</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">widget_LID8</span>
        <span class="k">return</span> <span class="n">ax</span><span class="p">,</span> <span class="n">widget</span></div>

    <span class="c1"># -------------------------------</span>
<div class="viewcode-block" id="CORMAT_GUI.show_kb"><a class="viewcode-back" href="../Cormat_main.html#Cormat_main.CORMAT_GUI.show_kb">[docs]</a>    <span class="k">def</span> <span class="nf">show_kb</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        function that shows or hide the widget used to select corrections</span>
<span class="sd">        so far max/min correction are +/- 5 fringes</span>
<span class="sd">        :return:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kb</span><span class="o">.</span><span class="n">isHidden</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">kb</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">kb</span><span class="o">.</span><span class="n">hide</span><span class="p">()</span></div>

    <span class="c1"># ----------------------------</span>
    <span class="nd">@QtCore.pyqtSlot</span><span class="p">()</span>
<div class="viewcode-block" id="CORMAT_GUI.handle_exit_button"><a class="viewcode-back" href="../Cormat_main.html#Cormat_main.CORMAT_GUI.handle_exit_button">[docs]</a>    <span class="k">def</span> <span class="nf">handle_exit_button</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Exit the application</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="s1">&#39;pulse&#39;</span><span class="p">)</span> <span class="ow">is</span> <span class="bp">False</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;data has been loaded, nothing has been modified, it is save to exit&#39;</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">areyousure_window</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QMainWindow</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ui_areyousure</span> <span class="o">=</span> <span class="n">Ui_areyousure_window</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ui_areyousure</span><span class="o">.</span><span class="n">setupUi</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">areyousure_window</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">areyousure_window</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">ui_areyousure</span><span class="o">.</span><span class="n">pushButton_YES</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">handle_yes_exit</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ui_areyousure</span><span class="o">.</span><span class="n">pushButton_NO</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">handle_no</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">pulse</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="s1">&#39;no data has been loaded, it is save to exit&#39;</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">areyousure_window</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QMainWindow</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ui_areyousure</span> <span class="o">=</span> <span class="n">Ui_areyousure_window</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ui_areyousure</span><span class="o">.</span><span class="n">setupUi</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">areyousure_window</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">areyousure_window</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">ui_areyousure</span><span class="o">.</span><span class="n">pushButton_YES</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">handle_yes_exit</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ui_areyousure</span><span class="o">.</span><span class="n">pushButton_NO</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">handle_no</span><span class="p">)</span>

            <span class="c1">#logger.info(&#39; Exit now&#39;)</span>
            <span class="c1">#sys.exit()</span>
        <span class="k">elif</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="s1">&#39;KG1_data&#39;</span><span class="p">)</span> <span class="ow">is</span> <span class="bp">False</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="s1">&#39;no data has been loaded, it is save to exit&#39;</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">areyousure_window</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QMainWindow</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ui_areyousure</span> <span class="o">=</span> <span class="n">Ui_areyousure_window</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ui_areyousure</span><span class="o">.</span><span class="n">setupUi</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">areyousure_window</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">areyousure_window</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">ui_areyousure</span><span class="o">.</span><span class="n">pushButton_YES</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">handle_yes_exit</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ui_areyousure</span><span class="o">.</span><span class="n">pushButton_NO</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">handle_no</span><span class="p">)</span>

        <span class="k">elif</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">data_changed</span> <span class="o">|</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">statusflag_changed</span><span class="p">)</span> <span class="ow">is</span> <span class="bp">True</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="s2">&quot;data changed? {} status flags changed? {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">data_changed</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">statusflag_changed</span><span class="p">))</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">saved</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="s2">&quot;data has been saved&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">handle_yes_exit</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39; data has not been saved do you want to exit? &#39;</span><span class="p">)</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">areyousure_window</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QMainWindow</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ui_areyousure</span> <span class="o">=</span> <span class="n">Ui_areyousure_window</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ui_areyousure</span><span class="o">.</span><span class="n">setupUi</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">areyousure_window</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">areyousure_window</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">ui_areyousure</span><span class="o">.</span><span class="n">pushButton_YES</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">handle_yes_exit</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ui_areyousure</span><span class="o">.</span><span class="n">pushButton_NO</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">handle_no</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;data and status flags have not changed, it is save to exit&#39;</span><span class="p">)</span>


            <span class="bp">self</span><span class="o">.</span><span class="n">areyousure_window</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QMainWindow</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ui_areyousure</span> <span class="o">=</span> <span class="n">Ui_areyousure_window</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ui_areyousure</span><span class="o">.</span><span class="n">setupUi</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">areyousure_window</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">areyousure_window</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">ui_areyousure</span><span class="o">.</span><span class="n">pushButton_YES</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">handle_yes_exit</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ui_areyousure</span><span class="o">.</span><span class="n">pushButton_NO</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">handle_no</span><span class="p">)</span></div>
    <span class="c1">#except AttributeError:</span>
        <span class="c1">#logger.info(&#39;&#39;)</span>
        <span class="c1">#logger.info(&#39;Exit now&#39;)</span>
        <span class="c1">#sys.exit()</span>

    <span class="nd">@staticmethod</span>
<div class="viewcode-block" id="CORMAT_GUI.handle_yes_exit"><a class="viewcode-back" href="../Cormat_main.html#Cormat_main.CORMAT_GUI.handle_yes_exit">[docs]</a>    <span class="k">def</span> <span class="nf">handle_yes_exit</span><span class="p">():</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        close application</span>
<span class="sd">        ::todo: check why using this function doens&#39;t allow to use profiling (what exit values does it need?)</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1">#logger.info(&#39;&#39;)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39; Exit now&#39;</span><span class="p">)</span>
        <span class="n">QtCore</span><span class="o">.</span><span class="n">QCoreApplication</span><span class="o">.</span><span class="n">instance</span><span class="p">()</span><span class="o">.</span><span class="n">quit</span><span class="p">()</span></div></div>
        <span class="c1"># sys.exit()</span>







<div class="viewcode-block" id="main"><a class="viewcode-back" href="../Cormat_main.html#Cormat_main.main">[docs]</a><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Main function</span>

<span class="sd">    the only input to the GUI is the debug</span>

<span class="sd">    by default is set to INFO</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span> <span class="nn">PyQt4.QtCore</span> <span class="kn">import</span> <span class="n">pyqtRemoveInputHook</span>
    <span class="n">pyqtRemoveInputHook</span><span class="p">()</span>
    <span class="n">pr</span> <span class="o">=</span> <span class="n">cProfile</span><span class="o">.</span><span class="n">Profile</span><span class="p">()</span>
    <span class="n">pr</span><span class="o">.</span><span class="n">enable</span><span class="p">()</span>

    <span class="c1"># with PyCallGraph(output=GraphvizOutput()):</span>
        <span class="c1"># code_to_profile()</span>

    <span class="n">app</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QApplication</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span>
    <span class="c1"># screen_resolution = app.desktop().screenGeometry()</span>
    <span class="c1"># width, height = screen_resolution.width(), screen_resolution.height()</span>
    <span class="n">width</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="p">[</span><span class="mi">640</span><span class="p">,</span><span class="mi">480</span><span class="p">]</span>
    <span class="n">width</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="p">[</span><span class="mi">480</span><span class="p">,</span><span class="mi">360</span><span class="p">]</span>
    <span class="n">MainWindow</span> <span class="o">=</span> <span class="n">CORMAT_GUI</span><span class="p">()</span>
    <span class="n">screenShape</span> <span class="o">=</span> <span class="n">QtGui</span><span class="o">.</span><span class="n">QDesktopWidget</span><span class="p">()</span><span class="o">.</span><span class="n">screenGeometry</span><span class="p">()</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;screen resolution is {} x {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">screenShape</span><span class="o">.</span><span class="n">width</span><span class="p">(),</span> <span class="n">screenShape</span><span class="o">.</span><span class="n">height</span><span class="p">()))</span>
    <span class="c1"># 1366x768 vnc viewer size</span>
    <span class="c1"># time.sleep(3.0)</span>
    <span class="n">MainWindow</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="n">MainWindow</span><span class="o">.</span><span class="n">resize</span><span class="p">(</span><span class="n">screenShape</span><span class="o">.</span><span class="n">width</span><span class="p">(),</span> <span class="n">screenShape</span><span class="o">.</span><span class="n">height</span><span class="p">())</span>
    <span class="c1"># MainWindow.resize(width, height)</span>
    <span class="c1"># MainWindow.showMaximized()</span>
    <span class="n">app</span><span class="o">.</span><span class="n">exec_</span><span class="p">()</span>
    <span class="n">pr</span><span class="o">.</span><span class="n">disable</span><span class="p">()</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">StringIO</span><span class="p">()</span>
    <span class="n">sortby</span> <span class="o">=</span> <span class="s1">&#39;cumulative&#39;</span>
    <span class="n">ps</span> <span class="o">=</span> <span class="n">pstats</span><span class="o">.</span><span class="n">Stats</span><span class="p">(</span><span class="n">pr</span><span class="p">,</span> <span class="n">stream</span><span class="o">=</span><span class="n">s</span><span class="p">)</span><span class="o">.</span><span class="n">sort_stats</span><span class="p">(</span><span class="n">sortby</span><span class="p">)</span>

    <span class="n">ps</span><span class="o">.</span><span class="n">dump_stats</span><span class="p">(</span><span class="s1">&#39;stats.dmp&#39;</span><span class="p">)</span>  <span class="c1"># dump the stats to a file named stats.dmp</span>
    <span class="c1"># ps.print_stats(sort=&#39;time&#39;)</span>
    <span class="k">return</span></div>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>


    <span class="c1"># Ensure we are running on 64bit</span>
    <span class="k">assert</span> <span class="p">(</span><span class="n">platform</span><span class="o">.</span><span class="n">architecture</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;64bit&#39;</span><span class="p">),</span> <span class="s2">&quot;Please log on Freja&quot;</span>

    <span class="c1"># Ensure we are running python 3</span>
    <span class="k">assert</span> <span class="n">sys</span><span class="o">.</span><span class="n">version_info</span> <span class="o">&gt;=</span> <span class="p">(</span>
        <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="s2">&quot;Python version too old. Please use &gt;= 3.5.X.&quot;</span>

    <span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s1">&#39;Run CORMAT_py&#39;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;-d&quot;</span><span class="p">,</span> <span class="s2">&quot;--debug&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span>
                        <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Debug level. 0: Info, 1: Warning, 2: Debug,&quot;</span>
                             <span class="s2">&quot; 3: Error, 4: Debug Plus; </span><span class="se">\n</span><span class="s2"> default level is INFO&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;-doc&quot;</span><span class="p">,</span> <span class="s2">&quot;--documentation&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span>
                        <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Make documentation. yes/no&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s1">&#39;no&#39;</span><span class="p">)</span>

    <span class="n">args</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>


    <span class="n">debug_map</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">,</span>
                 <span class="mi">1</span><span class="p">:</span> <span class="n">logging</span><span class="o">.</span><span class="n">WARNING</span><span class="p">,</span>
                 <span class="mi">2</span><span class="p">:</span> <span class="n">logging</span><span class="o">.</span><span class="n">DEBUG</span><span class="p">,</span>
                 <span class="mi">3</span><span class="p">:</span> <span class="n">logging</span><span class="o">.</span><span class="n">ERROR</span><span class="p">,</span>
                 <span class="mi">4</span><span class="p">:</span> <span class="mi">5</span><span class="p">}</span>
    <span class="c1">#this plots logger twice (black plus coloured)</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">addLevelName</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="s2">&quot;DEBUG_PLUS&quot;</span><span class="p">)</span>
    <span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="n">__name__</span><span class="p">)</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="n">debug_map</span><span class="p">[</span><span class="n">args</span><span class="o">.</span><span class="n">debug</span><span class="p">])</span>
    <span class="c1"># logger.setLevel(debug_map[args.debug])</span>

    <span class="n">fmt</span> <span class="o">=</span> <span class="n">MyFormatter</span><span class="p">()</span>
    <span class="c1"># hdlr = logging.StreamHandler(sys.stdout)</span>


    <span class="c1"># hdlr.setFormatter(fmt)</span>
    <span class="c1"># logging.root.addHandler(hdlr)</span>
    <span class="n">fh</span> <span class="o">=</span> <span class="n">handlers</span><span class="o">.</span><span class="n">RotatingFileHandler</span><span class="p">(</span><span class="s1">&#39;./LOGFILE.DAT&#39;</span><span class="p">,</span> <span class="n">mode</span> <span class="o">=</span> <span class="s1">&#39;w&#39;</span><span class="p">,</span><span class="n">maxBytes</span><span class="o">=</span><span class="p">(</span><span class="mi">1048576</span><span class="o">*</span><span class="mi">5</span><span class="p">),</span> <span class="n">backupCount</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
    <span class="n">fh</span><span class="o">.</span><span class="n">setFormatter</span><span class="p">(</span><span class="n">fmt</span><span class="p">)</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">addHandler</span><span class="p">(</span><span class="n">fh</span><span class="p">)</span>





    <span class="n">main</span><span class="p">()</span>


    

    
</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="index.html">Module code</a><ul>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2019, Bruno Viola.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.4.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.7</a>
      
    </div>

    

    
  </body>
</html>